<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Maria Tackett">

<title>11&nbsp; Logistic regression – Introduction to Regression Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./12-logistic-prediction.html" rel="next">
<link href="./10-model-eval.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-31c3c5ec0f84e3846e28bd1517aa8340.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script defer="" data-domain="https://matackett.github.io/regression-book/" src="https://plausible.io/js/script.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11-logistic.html">Part 4: Beyond linear regression</a></li><li class="breadcrumb-item"><a href="./11-logistic.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Logistic regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Regression Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/matackett/regression-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 1: Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Regression in the data science workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-review-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data analysis in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 2: Simple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-slr-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-slr-conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model conditions and diagnostics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 3: Multiple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mlr-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-mlr-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Variable transformations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-model-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 4: Beyond linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-logistic.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-logistic-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Logistic regression: Prediction and evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-special-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Special topics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Mathematics of linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Mathematics of logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data sets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">Learning goals</a></li>
  <li><a href="#sec-logistic-intro-gss" id="toc-sec-logistic-intro-gss" class="nav-link" data-scroll-target="#sec-logistic-intro-gss"><span class="header-section-number">11.1</span> Introduction: Comfort with driverless cars</a>
  <ul class="collapse">
  <li><a href="#exploratory-data-analysis" id="toc-exploratory-data-analysis" class="nav-link" data-scroll-target="#exploratory-data-analysis"><span class="header-section-number">11.1.1</span> Exploratory data analysis</a></li>
  </ul></li>
  <li><a href="#sec-prob-odds" id="toc-sec-prob-odds" class="nav-link" data-scroll-target="#sec-prob-odds"><span class="header-section-number">11.2</span> Probability / odds/ odds ratio</a>
  <ul class="collapse">
  <li><a href="#probability-and-odds" id="toc-probability-and-odds" class="nav-link" data-scroll-target="#probability-and-odds"><span class="header-section-number">11.2.1</span> Probability and odds</a></li>
  <li><a href="#odds-ratio" id="toc-odds-ratio" class="nav-link" data-scroll-target="#odds-ratio"><span class="header-section-number">11.2.2</span> Odds ratio</a></li>
  </ul></li>
  <li><a href="#sec-logistic-model" id="toc-sec-logistic-model" class="nav-link" data-scroll-target="#sec-logistic-model"><span class="header-section-number">11.3</span> From linear to logistic regression</a></li>
  <li><a href="#sec-logistic-interpret-coef" id="toc-sec-logistic-interpret-coef" class="nav-link" data-scroll-target="#sec-logistic-interpret-coef"><span class="header-section-number">11.4</span> Interpreting model coefficients</a>
  <ul class="collapse">
  <li><a href="#predictor-in-simple-logistic-regression" id="toc-predictor-in-simple-logistic-regression" class="nav-link" data-scroll-target="#predictor-in-simple-logistic-regression"><span class="header-section-number">11.4.1</span> Predictor in simple logistic regression</a></li>
  <li><a href="#categorical-predictors" id="toc-categorical-predictors" class="nav-link" data-scroll-target="#categorical-predictors"><span class="header-section-number">11.4.2</span> Categorical predictors</a></li>
  <li><a href="#quantitative-predictors" id="toc-quantitative-predictors" class="nav-link" data-scroll-target="#quantitative-predictors"><span class="header-section-number">11.4.3</span> Quantitative predictors</a></li>
  </ul></li>
  <li><a href="#sec-logistic-inf" id="toc-sec-logistic-inf" class="nav-link" data-scroll-target="#sec-logistic-inf"><span class="header-section-number">11.5</span> Inference for a coefficient <span class="math inline">\(\beta_j\)</span></a>
  <ul class="collapse">
  <li><a href="#sec-logistic-sim-inf" id="toc-sec-logistic-sim-inf" class="nav-link" data-scroll-target="#sec-logistic-sim-inf"><span class="header-section-number">11.5.1</span> Simulation-based inference</a></li>
  <li><a href="#sec-logistic-inf-theory" id="toc-sec-logistic-inf-theory" class="nav-link" data-scroll-target="#sec-logistic-inf-theory"><span class="header-section-number">11.5.2</span> Theory-based inference</a></li>
  </ul></li>
  <li><a href="#sec-logistic-conditions" id="toc-sec-logistic-conditions" class="nav-link" data-scroll-target="#sec-logistic-conditions"><span class="header-section-number">11.6</span> Model conditions</a>
  <ul class="collapse">
  <li><a href="#linearity" id="toc-linearity" class="nav-link" data-scroll-target="#linearity"><span class="header-section-number">11.6.1</span> Linearity</a></li>
  <li><a href="#independence" id="toc-independence" class="nav-link" data-scroll-target="#independence"><span class="header-section-number">11.6.2</span> Independence</a></li>
  </ul></li>
  <li><a href="#sec-logistic-r" id="toc-sec-logistic-r" class="nav-link" data-scroll-target="#sec-logistic-r"><span class="header-section-number">11.7</span> Logistic regression in R</a>
  <ul class="collapse">
  <li><a href="#fitting-a-logistic-model" id="toc-fitting-a-logistic-model" class="nav-link" data-scroll-target="#fitting-a-logistic-model"><span class="header-section-number">11.7.1</span> Fitting a logistic model</a></li>
  <li><a href="#simulation-based-inference" id="toc-simulation-based-inference" class="nav-link" data-scroll-target="#simulation-based-inference"><span class="header-section-number">11.7.2</span> Simulation-based inference</a></li>
  <li><a href="#empirical-logit-plots" id="toc-empirical-logit-plots" class="nav-link" data-scroll-target="#empirical-logit-plots"><span class="header-section-number">11.7.3</span> Empirical logit plots</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">11.8</span> Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/matackett/regression-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./11-logistic.html">Part 4: Beyond linear regression</a></li><li class="breadcrumb-item"><a href="./11-logistic.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Logistic regression</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch-logistic" class="quarto-section-identifier"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-goals" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-goals">Learning goals</h2>
<ul>
<li>Identify whether linear or logistic regression is appropriate for a given analysis</li>
<li>Calculate and interpret probabilities, odds, and odds ratios</li>
<li>Interpret the coefficients of a logistic regression model</li>
<li>Conduct simulation-based and theory-based inference for the coefficients of a logistic regression model</li>
<li>Evaluate model conditions for logistic regression</li>
<li>Conduct logistic regression using R</li>
</ul>
<!-- ## R packages {.unnumbered} -->
<!--# 
-   `ggridges` [@ggridges]
-   `Hmisc` [@Hmisc-2]
-   `knitr` [@knitr-2]
-   `Stat2Data` [@Stat2Data-2]
-   `tidymodels` [@tidymodels-5]
-   `tidyverse` [@tidyverse-2]
-->
</section>
<section id="sec-logistic-intro-gss" class="level2" data-number="11.1">
<h2 data-number="11.1" class="anchored" data-anchor-id="sec-logistic-intro-gss"><span class="header-section-number">11.1</span> Introduction: Comfort with driverless cars</h2>
<p>Artificial Intelligence (AI) has quickly become ubiquitous, with generative AI tools such as ChatGPT being widely adopted in the workplace, school, and throughout every day life. One area in particular where AI is continuing to grow is in self-driving cars. The notion of riding in car that drives around as an individual reads a book has increasingly become a reality, with some cities already having self-driving taxis on the road. Waymo, a company that deploys a fleet self-driving taxis (called “robotaxis”), describes its robotaxi as “the world’s most experienced driver.” and is operating in five United States cities with plans to expand to two more at the time of this writing. (<a href="https://waymo.com">waymo.com</a>). Additionally, Amazon has launched a robotaxi service in Las Vegas called Zoox <span class="citation" data-cites="Liedtke2025Zoox">(<a href="references.html#ref-Liedtke2025Zoox" role="doc-biblioref">Liedtke 2025</a>)</span>.</p>
<p>Despite the growth of self-driving cars, there are still complex moral questions <span class="citation" data-cites="Maxmen2018SelfDrivingCarEthics">Vemoori (<a href="references.html#ref-Vemoori2024EthicalDilemmasForbes" role="doc-biblioref">2024</a>)</span> and the general readiness individuals have with this new technology and driving experience. David LI, co-founder of Hesai, a remote-sensing technology company, said that the adoption of self-driving cars are not just a question about technology development, but “it is a social question, it is a regulatory question, it is a political question” <span class="citation" data-cites="White2025HesaiSensors">(<a href="references.html#ref-White2025HesaiSensors" role="doc-biblioref">White 2025</a>)</span>. Therefore, it is important to understand how people, some of who may already will one day purchase a self-driving car, view this technological phenomenon.</p>
<div class="objective">
<p>The goal of the analysis in this chapter is to use data from the 2024 General Social Survey (GSS) to explore individual characteristics associated with one’s comfort with self-driving cars.</p>
</div>
<p>The GSS, administered by the National Science Foundation and is administered by National Opinion Research Center (NORC) at the University of Chicago, began in 1972 and is conducted about every two years to measure “trends in opinions, attitudes, and behaviors” among adults age 18 and older in the United States <span class="citation" data-cites="gss2024">(<a href="references.html#ref-gss2024" role="doc-biblioref">Davern et al. 2025</a>)</span>. Households are randomly selected using multistage cluster sample based on data from the United States Census.</p>
<p>Respondents in the 2024 survey were part of the second year of an experiment studying survey administration and randomly split into two groups. The first group had the opportunity to complete the survey through an in-person interview (format traditionally used) and non-respondents were offered the online survey. The second group had the opportunity to take the online survey first, then non-respondents were offered the in-person interview. <!--# helpful to add response rate?--></p>
<p>The data are in <code>gss24-ai.csv</code>. The data were obtained through the <strong>gssr</strong> R package <span class="citation" data-cites="gssr">(<a href="references.html#ref-gssr" role="doc-biblioref">Healy 2023</a>)</span>. Questions about opinions on special topics such as technology are not given to every respondent, so the data in this analysis includes responses from 1521 adults who were asked about comfort with self-driving cars and who provided their age and sex in the survey. We will focus on the variables below (out of the over 600 variables in the full General Social Survey). The variable definitions are based on survey prompts and variable definitions in the <em>General Social Survey Documentation and Public Use File Codebook</em> <span class="citation" data-cites="gss2024">(<a href="references.html#ref-gss2024" role="doc-biblioref">Davern et al. 2025</a>)</span>.</p>
<p><strong>For the remainder of the chapter, we will refer to self-driving cars as “driverless cars” to align with the language used in the 2024 GSS.</strong></p>
<ul>
<li><p><code>aidrive_comfort</code>: Indicator variable for respondent’s comfort with driverless (self-driving) cars. <code>0</code>: Not comfortable at all; <code>1</code>: At least some comfort.</p>
<ul>
<li>This variable was derived from responses to the original survey prompt: “Comfort with driverless cars”. Scores ranged from 0 to 10 with 0 representing “totally uncomfortable with this situation” and 10 representing “totally comfortable with this situation”. Responses of 0 on the original survey were coded as <code>aidrive_comfort = 0</code>. All other responses coded as 1.</li>
</ul></li>
<li><p><code>tech_easy</code> : Response to the question, “Does technology make our lives easier?” Categories are <code>Neutral</code>, <code>Can't choose</code> (Respondent doesn’t know / is unable to provide an answer), <code>Agree</code>, <code>Disagree</code>.</p></li>
<li><p><code>tech_harm</code>: Response to the question, “Does technology do more harm than good?”. Categories are <code>Neutral</code>, <code>Can't choose</code> (Respondent doesn’t know / is unable to provide an answer), <code>Agree</code>, <code>Disagree</code>.</p></li>
<li><p><code>age</code>: Respondent’s age in years</p></li>
<li><p><code>sex</code>: Respondent’s self-reported sex. Categories are <code>Male</code>, <code>Female</code>, the options provided on the original survey. <!--# see bayes rules for dealing with binary--></p></li>
<li><p><code>income</code>: Response to the question “In which of these groups did your total family income, from all sources, fall last year? That is, before taxes.” Categories are <code>Less than $20k</code>, <code>$20-50k</code>, <code>$50-110k</code>, <code>$110k or more</code>, <code>Not reported</code> .</p>
<ul>
<li>Note: These categories were defined based on the 27 categories in <code>income16</code> from the original survey.</li>
</ul></li>
<li><p><code>polviews</code>: Response to the question, “I’m going to show you a seven-point scale on which the political views that people might hold are arranged from extremely liberal–point 1–to extremely conservative–point 7. Where would you place yourself?” Categories are <code>Moderate</code>, <code>Liberal</code>, <code>Conservative</code>, <code>No reported</code>.</p>
<ul>
<li>Note: These categories were defined based on the original 7 point scale.</li>
</ul></li>
</ul>
<div class="analysis_in_practice">
<p>The General Social Survey includes sample weights, so that the analysis data is representative of the population of adults in the United States.</p>
<p>These sample weights are not used in the analysis in this chapter or <a href="12-logistic-prediction.html" class="quarto-xref"><span>Chapter 12</span></a> which uses the same data. Therefore, the analysis and conclusions we draw are only for educational purposes. To use the General Social Survey for research, see <span class="citation" data-cites="gss2024">(<a href="references.html#ref-gss2024" role="doc-biblioref">Davern et al. 2025</a>)</span> for more information about incorporating the sample weights.</p>
</div>
<section id="exploratory-data-analysis" class="level3" data-number="11.1.1">
<h3 data-number="11.1.1" class="anchored" data-anchor-id="exploratory-data-analysis"><span class="header-section-number">11.1.1</span> Exploratory data analysis</h3>
<div id="fig-ai-comfort" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ai-comfort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-ai-comfort" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-ai-comfort-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ai-comfort-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-ai-comfort-1.png" class="lightbox" data-gallery="fig-ai-comfort" title="Figure&nbsp;11.1&nbsp;(a): Distribution of original resposnes from 2024 GSS"><img src="11-logistic_files/figure-html/fig-ai-comfort-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-ai-comfort"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ai-comfort-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Distribution of original resposnes from 2024 GSS
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-ai-comfort" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-ai-comfort-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-ai-comfort-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-ai-comfort-2.png" class="lightbox" data-gallery="fig-ai-comfort" title="Figure&nbsp;11.1&nbsp;(b): Distribution of aidrive_comfort"><img src="11-logistic_files/figure-html/fig-ai-comfort-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-ai-comfort"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-ai-comfort-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Distribution of <code>aidrive_comfort</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ai-comfort-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.1: Distribution of original and aggregated variable on comfort with driverless cars
</figcaption>
</figure>
</div>
<p><a href="#fig-ai-comfort" class="quarto-xref">Figure&nbsp;<span>11.1</span></a> shows the distribution of the original responses to the survey question about comfort with driverless cars and <code>aidrive_comfort</code>, the binary variable we will use in the analysis. In practice, categorical variables may have many categories, so we can aggregate categories to simplify the variable based on the analysis question. We saw an example of this in <a href="03-eda.html#sec-univar-eda-cat" class="quarto-xref"><span>Section 3.4.1</span></a> when we looked at the variable <code>season</code> created from <code>month</code>. By simplifying the variable, we change the scope of the variable from a rating of the level of comfort an individual has with driverless cars to whether or not an individual has comfort with driverless cars. The latter aligns with the analysis objective and the modeling introduced in this chapter. Models for categorical response variables with three or more levels, such as the original survey responses, are introduced in <a href="13-special-topics.html#sec-multinomial" class="quarto-xref"><span>Section 13.1</span></a>.</p>
<p>In <a href="#fig-ai-comfort-2" class="quarto-xref">Figure&nbsp;<span>11.1 (b)</span></a>, we see about 45% of the respondents said they were “totally uncomfortable” with driverless cars and 55% reported some level of comfort with these cars. In the distribution of the original response variable in <a href="#fig-ai-comfort-1" class="quarto-xref">Figure&nbsp;<span>11.1 (a)</span></a>, among those who had at least some comfort, most had comfort levels of 5 or less. This detail could be important as we interpret the practical implications of the conclusions drawn from the analysis.</p>
<div id="fig-aidrive-predictor-eda" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aidrive-predictor-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aidrive-predictor-eda" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-aidrive-predictor-eda-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aidrive-predictor-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-aidrive-predictor-eda-1.png" class="lightbox" data-gallery="fig-aidrive-predictor-eda" title="Figure&nbsp;11.2&nbsp;(a): sex"><img src="11-logistic_files/figure-html/fig-aidrive-predictor-eda-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-aidrive-predictor-eda"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aidrive-predictor-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <code>sex</code>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aidrive-predictor-eda" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-aidrive-predictor-eda-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aidrive-predictor-eda-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-aidrive-predictor-eda-2.png" class="lightbox" data-gallery="fig-aidrive-predictor-eda" title="Figure&nbsp;11.2&nbsp;(b): age"><img src="11-logistic_files/figure-html/fig-aidrive-predictor-eda-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-aidrive-predictor-eda"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aidrive-predictor-eda-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) <code>age</code>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aidrive-predictor-eda" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-aidrive-predictor-eda-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aidrive-predictor-eda-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-aidrive-predictor-eda-3.png" class="lightbox" data-gallery="fig-aidrive-predictor-eda" title="Figure&nbsp;11.2&nbsp;(c): tech_easy"><img src="11-logistic_files/figure-html/fig-aidrive-predictor-eda-3.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-aidrive-predictor-eda"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aidrive-predictor-eda-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) <code>tech_easy</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aidrive-predictor-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.2: Univariate exploratory data analysis of predictor variables
</figcaption>
</figure>
</div>
<div class="cell">
<div id="tbl-age-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-age-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.1: Summary statistics for <code>age</code>
</figcaption>
<div aria-describedby="tbl-age-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Median (Q2)</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">50.4</td>
<td style="text-align: right;">17.6</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#fig-aidrive-predictor-eda" class="quarto-xref">Figure&nbsp;<span>11.2</span></a> and <a href="#tbl-age-summary" class="quarto-xref">Table&nbsp;<span>11.1</span></a> shows the univariate distributions of the predictor variables that will be used in this chapter. The exploratory data analysis for the other predictors is in <a href="12-logistic-prediction.html" class="quarto-xref"><span>Chapter 12</span></a> <!--# reference specific section--> . The mean age in the data is about 50.4 and the median is 49 years old. The youngest respondents in the data set are 18 and the oldest are 89 years old. The standard deviation is about 17.645 years, so the data spans the general age range for adults in the United States.</p>
<p>We also observe from <a href="#fig-aidrive-predictor-eda" class="quarto-xref">Figure&nbsp;<span>11.2</span></a> that the majority of the respondents (about 57 %) reported their sex as female, and a vast majority of respondents (about 79%) agree that technology is making life easier.</p>
<div id="fig-aidrive-bivariate-eda" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aidrive-bivariate-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aidrive-bivariate-eda" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-aidrive-bivariate-eda-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aidrive-bivariate-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-aidrive-bivariate-eda-1.png" class="lightbox" data-gallery="fig-aidrive-bivariate-eda" title="Figure&nbsp;11.3&nbsp;(a): aidrive_comfort vs.&nbsp;sex"><img src="11-logistic_files/figure-html/fig-aidrive-bivariate-eda-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-aidrive-bivariate-eda"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aidrive-bivariate-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <code>aidrive_comfort</code> vs.&nbsp;<code>sex</code>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aidrive-bivariate-eda" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-aidrive-bivariate-eda-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aidrive-bivariate-eda-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-aidrive-bivariate-eda-2.png" class="lightbox" data-gallery="fig-aidrive-bivariate-eda" title="Figure&nbsp;11.3&nbsp;(b): aidrive_comfort vs.&nbsp;age"><img src="11-logistic_files/figure-html/fig-aidrive-bivariate-eda-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-aidrive-bivariate-eda"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aidrive-bivariate-eda-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) <code>aidrive_comfort</code> vs.&nbsp;<code>age</code>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aidrive-bivariate-eda" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-aidrive-bivariate-eda-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aidrive-bivariate-eda-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-aidrive-bivariate-eda-3.png" class="lightbox" data-gallery="fig-aidrive-bivariate-eda" title="Figure&nbsp;11.3&nbsp;(c): aidrive_comfort vs.&nbsp;tech_easy"><img src="11-logistic_files/figure-html/fig-aidrive-bivariate-eda-3.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-aidrive-bivariate-eda"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aidrive-bivariate-eda-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) <code>aidrive_comfort</code> vs.&nbsp;<code>tech_easy</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aidrive-bivariate-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.3: Bivariate exploratory data analysis. Blue: <code>adrive_comfort = 0</code>, Red: <code>aidrive_comfort = 1</code>
</figcaption>
</figure>
</div>
<p><a href="#fig-aidrive-bivariate-eda" class="quarto-xref">Figure&nbsp;<span>11.3</span></a> shows the relationship between the response and each of the predictor variables. Here we use a segmented bar plot <!--# is there a ref to EDA section?--> to visualize the relationship between the categorical predictors, <code>sex</code> and <code>tech_easy</code> and the categorical response, <code>aidrive_comfort</code>. As we look at the segmented bar plot, we are evaluating distribution of the response variable is approximately equal for each category of the predictor (<a href="03-eda.html#sec-bivar-eda-cat-cat" class="quarto-xref"><span>Section 3.5.3</span></a>). Unequal proportions suggests some relationship between the response and predictor variable. In <a href="#fig-aidrive-bivariate-eda" class="quarto-xref">Figure&nbsp;<span>11.3</span></a>, a higher proportion of males have comfort with driverless cars compared to the proportion of females. This indicates a potential relationship between sex and comfort with driverless cars. <a href="#fig-aidrive-bivariate-eda" class="quarto-xref">Figure&nbsp;<span>11.3</span></a> shows overlap in the distribution of age among those who have comfort with driverless cars versus those who do not, but the distribution among those who have comfort with driverless cars tends to skew younger. As with linear regression, however, we will use statistical inference <a href="#sec-logistic-inf" class="quarto-xref"><span>Section 11.5</span></a> to determine if the data provide evidence that such relationships exist.</p>
<div class="yourturn">
<p>Based on <a href="#fig-aidrive-bivariate-eda" class="quarto-xref">Figure&nbsp;<span>11.3</span></a> , does there appear to be a relationship between opinions about whether technology makes life easier and comfort with driverless cars? Explain.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</div>
<p>Now we use multivariate exploratory data analysis to explore potential interaction effects. Recall from <a href="07-mlr.html#sec-mlr-interaction" class="quarto-xref"><span>Section 7.7</span></a> that an interaction effect occurs when the relationship between the response variable and a predictor differs based on values of the another predictor. We are often interested in interactions that include at least one categorical predictor, because we are interested how relationships might differ for subgroups in the sample.</p>
<!--# Use boxplots, violin plots, density plots? -->
<div id="fig-aidrive-interactions" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-aidrive-interactions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aidrive-interactions" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-aidrive-interactions-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aidrive-interactions-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-aidrive-interactions-1.png" class="lightbox" data-gallery="fig-aidrive-interactions" title="Figure&nbsp;11.4&nbsp;(a): aidrive versus age faceted by tech_easy"><img src="11-logistic_files/figure-html/fig-aidrive-interactions-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-aidrive-interactions"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aidrive-interactions-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <code>aidrive</code> versus <code>age</code> faceted by <code>tech_easy</code>
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-aidrive-interactions" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-aidrive-interactions-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-aidrive-interactions-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-aidrive-interactions-2.png" class="lightbox" data-gallery="fig-aidrive-interactions" title="Figure&nbsp;11.4&nbsp;(b): aidrive versus tech_easy faceted by sex"><img src="11-logistic_files/figure-html/fig-aidrive-interactions-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-aidrive-interactions"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-aidrive-interactions-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) <code>aidrive</code> versus <code>tech_easy</code> faceted by <code>sex</code>
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-aidrive-interactions-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.4: Mutlivariate EDA to explore potential interaction effects. Blue: <code>adrive_comfort = 0</code>, Red: <code>aidrive_comfort = 1</code>
</figcaption>
</figure>
</div>
<p><a href="#fig-aidrive-interactions-1" class="quarto-xref">Figure&nbsp;<span>11.4 (a)</span></a> is the relationship between <code>age</code> and <code>aidrive_comfort</code> faceted by the categories of <code>tech_easy</code>. As we look at the four sets of boxplots, we observe whether the relationship of the boxplots is the same for each level of <code>tech_easy</code>. If so, this indicates the relationship between <code>age</code> and <code>aidrive_comfort</code> is the same regardless of the value of <code>tech_easy</code>. In <a href="#fig-aidrive-interactions-1" class="quarto-xref">Figure&nbsp;<span>11.4 (a)</span></a>, the relationship in the distributions of <code>age</code> between those who have comfort with driverless cars versus those who don’t looks similar for the categories “Neutral”, “Agree”, and “Disagree”. The boxes largely overlap and the median age is approximately the same between the two groups of <code>aidrive_comfort</code>. The relationship does appear to be different among those in the “Can’t choose” category, as the median age among those who are not comfortable with driverless cars is higher than those who are comfortable.</p>
<p><a href="#fig-aidrive-interactions-2" class="quarto-xref">Figure&nbsp;<span>11.4 (b)</span></a> is a plot to explore the interaction between two categorical predictors <code>sex</code> and <code>tech_easy</code>. Similar as before, we are examining whether the relationship between <code>tech_easy</code> and <code>aidrive_comfort</code> differs based on <code>sex</code>. We are not looking to see whether the proportions are equal between the two groups but are instead looking to see whether the proportions are approximately equal relative to one another within each category of <code>sex</code>.</p>
<p>Using this as the criteria, the relationship between <code>tech_easy</code> and <code>aidrive_comfort</code> looks approximately equal for the categories of <code>sex</code>. Therefore, the data do not show evidence of an interaction between <code>tech_easy</code> and <code>sex</code>. We do note that in general, the proportion of males comfortable with driverless cars within each group of <code>tech_easy</code> is higher than the corresponding groups for females. This is expected, given what we observed in the bivariate EDA in <a href="#fig-aidrive-bivariate-eda" class="quarto-xref">Figure&nbsp;<span>11.3</span></a>.</p>
</section>
</section>
<section id="sec-prob-odds" class="level2" data-number="11.2">
<h2 data-number="11.2" class="anchored" data-anchor-id="sec-prob-odds"><span class="header-section-number">11.2</span> Probability / odds/ odds ratio</h2>
<section id="probability-and-odds" class="level3" data-number="11.2.1">
<h3 data-number="11.2.1" class="anchored" data-anchor-id="probability-and-odds"><span class="header-section-number">11.2.1</span> Probability and odds</h3>
<!--# The term "logistic regression" has not been introduced yet!-->
<p>Before moving to modeling, let’s take some time to focus on the response variable. The response variable <span class="math inline">\(Y\)</span> is categorical and takes values “0” or “1”. The response <span class="math inline">\(Y = 1\)</span> indicates an observation takes the outcome of interest, and <span class="math inline">\(Y = 0\)</span> indicates an observation does not take that outcome. Sometimes <span class="math inline">\(Y = 1\)</span> and <span class="math inline">\(Y = 0\)</span> are called “success” and “failure”, respectively. Note, however, that a “success” just means it is the outcome we are interested in studying, not necessarily what would be considered a “success” in practice.</p>
<p>The <strong>probability</strong> <span class="math inline">\(Y=1\)</span>, denoted <span class="math inline">\(Pr(Y=1)\)</span>, is a measure of the chance that the event <span class="math inline">\(Y = 1\)</span> occurs. Probabilities take values between 0 and 1, with 0 indicating an event is impossible and never occurs, and 1 indicating that an event always occurs. The <strong>odds</strong> <span class="math inline">\(Y = 1\)</span> are the ratio of the probability <span class="math inline">\(Y = 1\)</span> occurs versus the probability <span class="math inline">\(Y = 0\)</span> occurs. This is computed as</p>
<p><span id="eq-odds"><span class="math display">\[
\text{odds(Y = 1)} = \frac{Pr(Y = 1)}{Pr(Y = 0)} = \frac{Pr(Y = 1)}{1 - Pr(Y = 1)}
\tag{11.1}\]</span></span></p>
<p>Note that the odds that <span class="math inline">\(Y = 0\)</span> are equal to <span class="math inline">\(1/ \text{odds}(Y = 1)\)</span> .</p>
<div class="cell">
<div id="tbl-response-prob-odds" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-response-prob-odds-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.2: Frequency, probability, and odds of <code>aidrive_comfort</code>
</figcaption>
<div aria-describedby="tbl-response-prob-odds-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">aidrive_comfort</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">probability</th>
<th style="text-align: right;">odds</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: right;">692</td>
<td style="text-align: right;">0.455</td>
<td style="text-align: right;">0.835</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">829</td>
<td style="text-align: right;">0.545</td>
<td style="text-align: right;">1.198</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#tbl-response-prob-odds" class="quarto-xref">Table&nbsp;<span>11.2</span></a> shows the probabilities an odds for the response variable <code>aidrive_comfort</code>. In the data from 1521 respondents, the probability (chance) a randomly selected respondent is comfortable with driverless cars is 0.545. This may also be phrased as there is a 54.5 % chance a randomly selected respondent is comfortable with driverless cars. The odds a randomly selected respondent is comfortable with driverless cars are 1.198. This means that a randomly selected respondent is 1.198 times more likely to be comfortable with driverless cars than not be.</p>
<div class="yourturn">
<p>Show how the following values are computed:</p>
<ul>
<li><p><span class="math inline">\(Pr(\text{aidrive\_comfort} = 1) =\)</span> 0.545</p></li>
<li><p><span class="math inline">\(\text{odds}(\text{aidrive\_comfort}=1)=\)</span> 1.198 <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p></li>
</ul>
</div>
</section>
<section id="odds-ratio" class="level3" data-number="11.2.2">
<h3 data-number="11.2.2" class="anchored" data-anchor-id="odds-ratio"><span class="header-section-number">11.2.2</span> Odds ratio</h3>
<p>We are most interested in understanding the relationship between comfort with driverless cars and other factors about the respondents. <a href="#tbl-aidrive-two-way" class="quarto-xref">Table&nbsp;<span>11.3</span></a> is a <strong>two-way</strong> table of the relationship between <code>aidrive_comfort</code> and <code>tech_easy</code>. Now we can not only answer questions regarding opinions about comfort with driverless cars overall but can also see how these opinions on comfort may differ based on respondent’s opinion about whether technology makes life easier.</p>
<!--# do i move the your turn for probabilities and odds here?-->
<div class="cell">
<div id="tbl-aidrive-two-way" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-aidrive-two-way-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.3: Two-way table of <code>aidrive_comfort</code> (columns) versus <code>tech_easy</code> (rows)
</figcaption>
<div aria-describedby="tbl-aidrive-two-way-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Tech Easy</th>
<th style="text-align: right;">0</th>
<th style="text-align: right;">1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Neutral</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">90</td>
</tr>
<tr class="even">
<td style="text-align: left;">Can’t choose</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Agree</td>
<td style="text-align: right;">495</td>
<td style="text-align: right;">706</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disagree</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">21</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Each cell in the table is the number of observations that take the values indicated by the row and column. For example, there are 90 respondents in the data whose observed data are <code>tech_easy = "Neutral"</code> and <code>aidrive_comfort = "1"</code>. We can use this table to ask how the probability of being comfortable with driverless cars differs based on opinions about whether technology makes life easier. For example, we can compute the probability and the corresponding odds a randomly selected respondent is comfortable with driverless cars given they are neutral about whether technology makes life easier.</p>
<p><span id="eq-prob-odds-cond"><span class="math display">\[
\begin{aligned}
Pr(Y = 1| \text{tech\_easy = Neutral}) = \frac{90}{127 + 90}  \approx 0.415 \\[5pt]
\text{odds}(Y = 1| \text{tech\_easy = Neutral}) = \frac{90}{127} = \frac{0.415}{1 - 0.415}\approx{0.709}
\end{aligned}
\tag{11.2}\]</span></span></p>
<p><span class="math inline">\(Pr(Y=1 | \text{tech\_easy = Neutral})\)</span> is called a <strong>conditional probability</strong>, because it is the probability that a randomly selected respondent is comfortable with driverless cars conditioned on (given) they are neutral about whether technology makes life easier. Similarly, <span class="math inline">\(\text{odds}(Y=1 | \text{tech\_easy = Neutral})\)</span> are <strong>conditional odds</strong>.</p>
<div class="analysis_in_practice">
<p>It may sound awkward to communicate results where the odds are less than 1. Because the odds are reciprocal, they are typically reported in terms of the odds being greater than 1. For example, an alternative way to present the odds from <a href="#eq-prob-odds-cond" class="quarto-xref">Equation&nbsp;<span>11.2</span></a> is</p>
<blockquote class="blockquote">
<p><em>A randomly selected respondent who is neutral about technology making life easier is 1.41 times more likely to not be comfortable with driverless cars than be comfortable.</em></p>
</blockquote>
</div>
<div class="yourturn">
<p>Compute the probability and corresponding odds of being comfortable with driverless cars among those who agree with the statement that technology makes life easier.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
</div>
<p>From <a href="#tbl-aidrive-two-way" class="quarto-xref">Table&nbsp;<span>11.3</span></a>, the odds a respondent who is neutral about technology making life easier is comfortable with driverless cars are 0.709, and the odds a respondent who agrees technology makes life easier are 1.43. We quantify how the odds for these two groups compare using an odds ratio. An <strong>odds ratio</strong> is computed as the odds for one group divided the odds for another, as shown in <a href="#eq-odds-ratio" class="quarto-xref">Equation&nbsp;<span>11.3</span></a></p>
<p><span id="eq-odds-ratio"><span class="math display">\[
\text{odds ratio} = \frac{\text{odds}_{group 1}}{\text{odds}_{group 2}}
\tag{11.3}\]</span></span></p>
<p>Let’s compute the odds ratio for those who agree that technology makes life easier versus those who are neutral.</p>
<p><span class="math display">\[
\text{odds ratio} = \frac{\text{odds}_{\text{Agree}}}{\text{odds}_{\text{Neutral}}} = \frac{1.43}{0.709} = 2.02
\]</span></p>
<blockquote class="blockquote">
<p>This means that the odds a respondent who agrees technology makes life easier is comfortable with driverless cars are 2.02 times the odds a respondent who is neutral about technology is comfortable with driverless cars.</p>
</blockquote>
<div class="yourturn">
<blockquote class="blockquote">
<p>Compute the odds ratio of being comfortable with driverless cars for <code>tech_easy = Agree</code> versus <code>teach_easy = Disagree</code>. Interpret this value in the context of the data.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
</blockquote>
</div>
<!--# do i want to cover this?-->
<!--# why odds over probabilities? -->
<!--# Some explanation about why we often prefer working with the odds vs. the probabilities? -->
<!--# Why look at odds ratios instead of probability ratio? Perhaps its just because of the model?-->
<!--# Suggestion from Chat GPT: odds multiply nicely -->
</section>
</section>
<section id="sec-logistic-model" class="level2" data-number="11.3">
<h2 data-number="11.3" class="anchored" data-anchor-id="sec-logistic-model"><span class="header-section-number">11.3</span> From linear to logistic regression</h2>
<!--# This needs to be reordered to be smoother between the why not linear and introducing logistic.-->
<p>The two-way table and odds ratios from the previous section helped us being to explore the relationship between comfort with driverless cars and opinion about whether technology makes life easier. Let’s build on this by fitting a model that can (1) help us quantify the relationship between variables, (2) explore the relationship between the response and multiple predictors variables, and (3) be used to make predictors and draw rigorous conclusions. Before diving into the details of this model’s we’ll take a moment to understand why we are introducing a new model for the relationship between <code>aidrive_comfort</code> versus the predictors rather than using the linear regression model we’ve seen up to this point.</p>
<!--# your turn? - Identify the response variable in each scenario and whether it is quantitative or categorical.-->
<!--# do this using simulated data??-->
<!--# Intro of Hilbe logistic regression book has good explanation - reference that here.-->
<p>Suppose we want to fit a model of the relationship between <code>age</code> and <code>aidrive_comfort</code>. Our first thought may be to use the linear regression model from <a href="04-slr.html" class="quarto-xref"><span>Chapter 4</span></a> to model this relationship. In this case, the estimated model would be of the form</p>
<p><span id="eq-aidrive-age-linear"><span class="math display">\[
\widehat{\text{aidrive\_comfort}} = \hat{\beta}_0 + \hat{\beta}_1 \times \text{age}
\tag{11.4}\]</span></span></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-try-linear" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-try-linear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-try-linear-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;11.5: Linear regression model for aidrive_comfort versus age"><img src="11-logistic_files/figure-html/fig-try-linear-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-try-linear-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.5: Linear regression model for <code>aidrive_comfort</code> versus <code>age</code>
</figcaption>
</figure>
</div>
</div>
</div>
<!--# should I use jitter here instead?-->
<p><a href="#fig-try-linear" class="quarto-xref">Figure&nbsp;<span>11.5</span></a> is a visualization of the linear regression model for the relationship between <code>age</code> and <code>aidrive_comfort</code> shown in <a href="#eq-aidrive-age-linear" class="quarto-xref">Equation&nbsp;<span>11.4</span></a>. Here we easily see the linear regression model represented by the red line is not a good fit for the data. In fact, it (almost) never produces predictions of 0 or 1, the observed values of the response. Recall that the linear regression model is estimated by minimizing the sum of squared residuals, <span class="math inline">\(0 - \hat{y}_i\)</span> or <span class="math inline">\(1 - \hat{y}_i\)</span> in this scenario. These residuals can be minimized by finding a model that produces estimates between 0 and 1, as shown in <a href="#fig-try-linear" class="quarto-xref">Figure&nbsp;<span>11.5</span></a>, rather than trying to predict the actual observed values, 0 or 1.</p>
<p>Next, we might consider fitting a linear model such that the response variable is the <span class="math inline">\(\pi = Pr(Y = 1)\)</span>, the probability of being comfortable with driverless cars. This estimated model takes the form</p>
<p><span id="eq-aidrive-age-prob"><span class="math display">\[
\hat{\pi} = \hat{\beta}_0 + \hat{\beta}_1 \times \text{age}
\tag{11.5}\]</span></span></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-try-prob" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-try-prob-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-try-prob-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;11.6: Linear model for Pr(aidrive_comfort = 1) versus age"><img src="11-logistic_files/figure-html/fig-try-prob-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-try-prob-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.6: Linear model for Pr(<code>aidrive_comfort = 1</code>) versus <code>age</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-try-prob" class="quarto-xref">Figure&nbsp;<span>11.6</span></a> shows the relationship between age and the probability of being comfortable with driverless cars. This model seems to be a better fit for the data, as it generally captures the trend that younger respondents are more likely to be comfortable with driverless cars compared to older respondents. The primary issue with using the probability as the response variable is that probabilities are bounded between 0 and 1. Therefore, it is impossible to get values less than 0 or greater than 1 in practice, so we would want the same bounded constraints on our model particularly if we wish to use the model for prediction. We saw a similar issue in <a href="10-model-eval.html" class="quarto-xref"><span>Chapter 10</span></a> with the values of <code>valence</code> in the Spotify data. We have the same issue when using the odds as the response variable, because the odds cannot be less than 0. Therefore, we need a model that not only captures the relationship between the response and predictor but also addresses the boundary constraint.</p>
<p>When there is a binary categorical response variable, we use a <strong>logistic regression model</strong> to model the relationship between the binary response and one or more predictor variables as in <a href="appendix-logistic.html#eq-logistic-model" class="quarto-xref">Equation&nbsp;<span>B.1</span></a>.</p>
<p><span id="eq-logistic-model"><span class="math display">\[
\log\Big(\frac{\pi}{1 - \pi}\Big) = \beta_0 + \beta_1x_1 + \dots + \beta_px_p
\tag{11.6}\]</span></span></p>
<p>where <span class="math inline">\(\pi = Pr(Y = 1)\)</span> and <span class="math inline">\(\log\big(\frac{\pi}{1 - \pi}\big)\)</span> is the <strong>logit transformation</strong>, also called the “log odds”. The log odds can take any value <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span>, so it does not have the boundary constraints of the probability and odds. The log odds output from <a href="appendix-logistic.html#eq-logistic-model" class="quarto-xref">Equation&nbsp;<span>B.1</span></a> can be transformed back to the odds and probabilities, and we will the probabilities to assign each observation to a predicted class <code>aidrive_comfort = 0</code> or <code>aidrive_comfort = 1</code>. We’ll discuss this more in <a href="12-logistic-prediction.html" class="quarto-xref"><span>Chapter 12</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-try-logistic" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-try-logistic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-try-logistic-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;11.7: Output from logistic regression model of aidrive_comfort versus age"><img src="11-logistic_files/figure-html/fig-try-logistic-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-try-logistic-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.7: Output from logistic regression model of <code>aidrive_comfort</code> versus <code>age</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-try-logistic" class="quarto-xref">Figure&nbsp;<span>11.7</span></a> shows the output of the logistic regression model of <code>aidrive_comfort</code> versus <code>age</code>. Here, we see the logit is not bounded as the probability or odds.</p>
<!--# The red curve is the predicted logit from the logistic regression model. This curve is often referred to as the "S-curve", given its shape that resembles the English letter "S" as shown in the simulated data in @fig-logistic-curve-sim. From this visualization, we see the predicted probabilities are bounded between 0 and 1 as we would expect in practice, even though the logit can take any values between $-\infty$ to $\infty$.-->
<div class="math_rules">
<p><a href="appendix-logistic.html#eq-logistic-model" class="quarto-xref">Equation&nbsp;<span>B.1</span></a> is the statistical model for logistic regression. The statistical model does not have the error term <span class="math inline">\(\epsilon\)</span> as we’ve seen in the statistical model for linear regression in <a href="07-mlr.html#eq-mlr-stat-model-1" class="quarto-xref">Equation&nbsp;<span>7.3</span></a>. Recall from <a href="07-mlr.html#sec-mlr-fit-line" class="quarto-xref"><span>Section 7.2</span></a> that the error term <span class="math inline">\(\epsilon\)</span> is the difference between the observed response <span class="math inline">\(Y\)</span> and the expected value produced by the model <span class="math inline">\(\beta_0 + \beta_1x_1 + \dots + \beta_px_p\)</span>. Thus, we produce predictions for the response variable directly when doing linear regression.</p>
<p><br></p>
<p>In contrast, the output of the logistic regression model are the log odds that <span class="math inline">\(y = 1\)</span>, not the actual observed values <span class="math inline">\(y_i = 0\)</span> or <span class="math inline">\(y_i  = 1\)</span>. Thus, there is no error term in the statistical model for logistic regression, because we do not predict the value of the response directly and thus do not have the same notion of the difference between the observed and predicted response.</p>
</div>
</section>
<section id="sec-logistic-interpret-coef" class="level2" data-number="11.4">
<h2 data-number="11.4" class="anchored" data-anchor-id="sec-logistic-interpret-coef"><span class="header-section-number">11.4</span> Interpreting model coefficients</h2>
<!--# make sure I actually talk about the likelihood function as promised in the model comparison chapter-->
<p>In <a href="07-mlr.html#sec-mlr-estimate-coef" class="quarto-xref"><span>Section 7.3</span></a>, we showed that the model coefficients for linear regression are estimated by the least-squares method, finding the values of the coefficients that minimizes the sum of squared residuals. There is no error term in the logistic regression model (see <span class="quarto-unresolved-ref">?eq-logistic-model-2</span>), so we cannot use least-squares in this case. The model coefficients for logistic regression are estimated using <strong>maximum likelihood estimation</strong>. Recall from <a href="10-model-eval.html#sec-model-compare-stats" class="quarto-xref"><span>Section 10.2</span></a> that the likelihood is a function that quantifies how likely the observed data are to have occurred given a combination of coefficients. <!--# this definition is clunky.--> Thus, maximum likelihood estimation is used to find the combination of coefficients that makes the observed data the most likely to have occurred, i.e., that maximizes the value of the likelihood function. The mathematical details for estimating logistic regression coefficients using maximum likelihood estimation are available in <a href="appendix-logistic.html#sec-logistic-estimation-matrix" class="quarto-xref"><span>Section B.2</span></a>.</p>
<section id="predictor-in-simple-logistic-regression" class="level3" data-number="11.4.1">
<h3 data-number="11.4.1" class="anchored" data-anchor-id="predictor-in-simple-logistic-regression"><span class="header-section-number">11.4.1</span> Predictor in simple logistic regression</h3>
<p>In <a href="#sec-prob-odds" class="quarto-xref"><span>Section 11.2</span></a>, we computed values from a two-way table to understand the relationship between opinions about whether technology makes life easier and comfort with driverless cars. Now we will use a logistic regression model to quantify the relationship.</p>
<div class="cell">
<div id="tbl-logistic-comfort-tech" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-logistic-comfort-tech-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.4: Logistic regression model for <code>aidrive_comfort</code> versus <code>tech_easy</code>
</figcaption>
<div aria-describedby="tbl-logistic-comfort-tech-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-0.344</td>
<td style="text-align: right;">0.138</td>
<td style="text-align: right;">-2.499</td>
<td style="text-align: right;">0.012</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyCan’t choose</td>
<td style="text-align: right;">-0.061</td>
<td style="text-align: right;">0.397</td>
<td style="text-align: right;">-0.154</td>
<td style="text-align: right;">0.878</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tech_easyAgree</td>
<td style="text-align: right;">0.699</td>
<td style="text-align: right;">0.150</td>
<td style="text-align: right;">4.671</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyDisagree</td>
<td style="text-align: right;">-0.562</td>
<td style="text-align: right;">0.293</td>
<td style="text-align: right;">-1.919</td>
<td style="text-align: right;">0.055</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#eq-logistic-comfort-tech" class="quarto-xref">Equation&nbsp;<span>11.7</span></a> is the equation from the model output in <a href="#tbl-logistic-comfort-tech" class="quarto-xref">Table&nbsp;<span>11.4</span></a>.</p>
<p><span id="eq-logistic-comfort-tech"><span class="math display">\[
\begin{aligned}
\log\Big(\frac{\hat{\pi}}{1 - \hat{\pi}}\Big) = -0.344 + -0.061 \times \text{Can't choose}  + 0.699 \times \text{Agree}   - 0.562 \times \text{Disagree}
\end{aligned}
\tag{11.7}\]</span></span></p>
<p>where <span class="math inline">\(\hat{\pi}\)</span> is the predicted probability a respondent is comfortable with driverless cars.</p>
<div class="yourturn">
<p>What is the baseline level for <code>tech_easy</code>? <a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
</div>
<p>The intercept, -0.344, is the estimated log odds for respondents in the baseline group, <code>Neutral</code>. Similar to interpretations in <a href="09-mlr-transformations.html#sec-transform-logy" class="quarto-xref"><span>Section 9.2</span></a>, though we do calculations using the logit, we write interpretations in terms of the odds, so they are more clearly understood by the reader. To transform from logit to odds, we exponentiate both sides of the model equation. <a href="#eq-logistic-comfort-tech-exp" class="quarto-xref">Equation&nbsp;<span>11.8</span></a> shows the equation from <a href="#tbl-logistic-comfort-tech" class="quarto-xref">Table&nbsp;<span>11.4</span></a> in terms of the odds of being comfortable with driverless cars.</p>
<p><span id="eq-logistic-comfort-tech-exp"><span class="math display">\[
\begin{aligned}
\frac{\hat{\pi}}{1 - \hat{\pi}} = e^{-0.344} \times e^{-0.061 \times \text{Can't choose}} \times e^{0.699 \times \text{Agree}}  \times e^{-0.562 \times \text{Disagree}}
\end{aligned}
\tag{11.8}\]</span></span></p>
<p>From <a href="#eq-logistic-comfort-tech-exp" class="quarto-xref">Equation&nbsp;<span>11.8</span></a>, we see that the estimated odds a respondent who is neutral about whether technology makes life easier is comfortable with driverless cars is 0.709 ( <span class="math inline">\(e^{-0.344}\)</span>). This equals the odds that was computed from the two-way table in <a href="#eq-prob-odds-cond" class="quarto-xref">Equation&nbsp;<span>11.2</span></a>.</p>
<div class="math_rules">
<p>The following two rules were used to go from <a href="#eq-logistic-comfort-tech" class="quarto-xref">Equation&nbsp;<span>11.7</span></a> to <a href="#eq-logistic-comfort-tech-exp" class="quarto-xref">Equation&nbsp;<span>11.8</span></a></p>
<ul>
<li><p><span class="math inline">\(e^{\log(a)} = a\)</span></p></li>
<li><p><span class="math inline">\(e^{a+b}  = e^a e^b\)</span></p></li>
</ul>
</div>
<p>Now let’s look at the coefficient for <code>Agree</code>, 0.699. Putting together what know about the response variable with what we’ve learned about interpreting coefficients for categorical predictors in <a href="07-mlr.html#sec-mlr-interpret-categorical" class="quarto-xref"><span>Section 7.4.2</span></a>, this estimated coefficient means the following:</p>
<blockquote class="blockquote">
<p><em>The log odds a respondent who agrees technology makes life easier is comfortable with driverless cars are expected to be 0.699 higher than the log odds of a respondent who is neutral about whether technology makes life easier.</em></p>
</blockquote>
<p>From <a href="#eq-logistic-comfort-tech-exp" class="quarto-xref">Equation&nbsp;<span>11.8</span></a>, the coefficient for <code>Agree</code> is <span class="math inline">\(e^{0.699} \approx 2.012\)</span>. This means the following:</p>
<blockquote class="blockquote">
<p><em>The <strong>odds</strong> a respondent who agrees technology makes life easier is comfortable with driverless cars are expected to be 2.012 (</em> <span class="math inline">\(e^{0.699}\)</span><em>) <strong>times</strong> the odds of a respondent who is neutral about whether technology makes life easier.</em></p>
</blockquote>
<p>The value 2.012 is equal to the odds ratio of <code>aidrive_comfort = 1</code> for <code>tech_easy = Agree</code> versus <code>tech_easy = Neutral</code>. It is the same (give or take rounding) as the odds ratio we computed from <a href="#tbl-aidrive-two-way" class="quarto-xref">Table&nbsp;<span>11.3</span></a>. This tells us something important about the relationship between the odds ratio and model coefficients in a logistic regression model. When we fit a simple logistic regression model with one categorical predictor <span class="math inline">\(X\)</span> such that <span class="math inline">\(\beta_k\)</span> is the coefficient corresponding to the <span class="math inline">\(k^{th}\)</span> level of <span class="math inline">\(X\)</span>, then <span class="math inline">\(e^{\beta_k}\)</span> is the odds ratio between the <span class="math inline">\(k^{th}\)</span> level and the baseline level.</p>
</section>
<section id="categorical-predictors" class="level3" data-number="11.4.2">
<h3 data-number="11.4.2" class="anchored" data-anchor-id="categorical-predictors"><span class="header-section-number">11.4.2</span> Categorical predictors</h3>
<p>Now, we will fit a multiple logistic regression model and use <code>age</code> along with <code>tech_easy</code> as predictors <code>aidrive_comfort</code>.</p>
<div class="cell">
<div id="tbl-logistic-comfort-tech-age" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-logistic-comfort-tech-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.5: Logistic regression model for <code>aidrive_comfort</code> versus <code>age</code> and <code>tech_easy</code>
</figcaption>
<div aria-describedby="tbl-logistic-comfort-tech-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.420</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">2.020</td>
<td style="text-align: right;">0.043</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyCan’t choose</td>
<td style="text-align: right;">-0.118</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">-0.294</td>
<td style="text-align: right;">0.769</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tech_easyAgree</td>
<td style="text-align: right;">0.678</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">4.487</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyDisagree</td>
<td style="text-align: right;">-0.499</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">-1.690</td>
<td style="text-align: right;">0.091</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">-4.902</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Now that we have multiple predictors in <a href="#tbl-logistic-comfort-tech-age" class="quarto-xref">Table&nbsp;<span>11.5</span></a>, the intercept is the predicted log odds of being comfortable with driverless cars for those who are neutral about technology making life easier and who are 0 years old. It would be impossible for a respondent to be 0 years old, so while the intercept is necessary to obtain the best fit model, its interpretation is not meaningful in practice. As with linear regression, we could use the centered values of <code>age</code> in the model if we wish to have an interpretable intercept.</p>
<p>The coefficient for <code>Agree</code> in this model is 0.678. It is but not equal to the coefficient for <code>Agree</code> in the previous model, because now the coefficient is computed after adjusting for <code>age</code>. The interpretation is similar as before, taking into account the fact that age is also in the model.</p>
<blockquote class="blockquote">
<p><em>The log odds a respondent who agrees technology makes life easier is comfortable with driverless cars are expected to be 0.678 higher than the log odds of a respondent who is neutral about whether technology makes life easier, holding age constant.</em></p>
</blockquote>
<p>To write the interpretation in terms of the odds, we need to exponentiate both sides of the model equation as in the previous section. <a href="#eq-logistic-comfort-tech-age-exp" class="quarto-xref">Equation&nbsp;<span>11.9</span></a> shows the relationship between opinions about technology, age, and the odds of being comfortable with driverless cars.</p>
<p><span id="eq-logistic-comfort-tech-age-exp"><span class="math display">\[
\begin{aligned}
\frac{\hat{\pi}}{1 - \hat{\pi}} = e^{0.420} \times e^{-0.118 \times \text{Can't choose}} \times e^{0.678 \times \text{Agree}}  \times e^{-0.499 \times \text{Disagree}} \times e^{-0.015 \times \text{age}}
\end{aligned}
\tag{11.9}\]</span></span></p>
<p>where <span class="math inline">\(\hat{\pi}\)</span> is the predicted probability a respondent is comfortable with driverless cars.</p>
<p>Based on <a href="#eq-logistic-comfort-tech-age-exp" class="quarto-xref">Equation&nbsp;<span>11.9</span></a>, the interpretation of the <code>Agree</code> in terms of the odds is the following:</p>
<blockquote class="blockquote">
<p><em>The <strong>odds</strong> a respondent who agrees technology makes life easier is comfortable with driverless cars are expected to be 1.970 (</em> <span class="math inline">\(e^{0.678}\)</span><em>) <strong>times</strong> the odds of a respondent who is neutral about whether technology makes life easier, holding age constant.</em></p>
</blockquote>
<p>The value 1.970 (<span class="math inline">\(e^{0.678}\)</span>) is the odds ratio of comfort with driverless cars between those who agree technology makes life easier and those who are neutral, after adjusting for age. When there are multiple predictor variables in the logistic regression model, <span class="math inline">\(e^{\beta_j}\)</span> where <span class="math inline">\(\beta_j\)</span> is the coefficient for the predictor is called the <strong>adjusted odds ratio (AOR).</strong></p>
<div class="yourturn">
<p>Use the model from <a href="#tbl-logistic-comfort-tech-age" class="quarto-xref">Table&nbsp;<span>11.5</span></a>. Assume <code>age</code> is held constant.</p>
<ul>
<li>Interpret the coefficient of <code>Disagree</code> in terms of the log odds of being comfortable with driverless cars.</li>
<li>Interpret the coefficient of <code>Disagree</code> in terms of the odds of being comfortable with driverless cars.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></li>
</ul>
</div>
</section>
<section id="quantitative-predictors" class="level3" data-number="11.4.3">
<h3 data-number="11.4.3" class="anchored" data-anchor-id="quantitative-predictors"><span class="header-section-number">11.4.3</span> Quantitative predictors</h3>
<p>Similar to categorical predictors, we can use what we learned about interpreting quantitative predictors in linear regression models in <a href="07-mlr.html#sec-mlr-interpret-quantitative" class="quarto-xref"><span>Section 7.4.1</span></a> as a starting point for interpretations for logistic regression. Let’s look at the interpretation of the coefficient for <code>age</code> from the model in <a href="#tbl-logistic-comfort-tech-age" class="quarto-xref">Table&nbsp;<span>11.5</span></a>. The coefficient is the expected change in the response when the predictor increases by one unit . Given this, the interpretation for <code>age</code> in terms of the log odds is the following:</p>
<blockquote class="blockquote">
<p><em>For each additional year increase in age, the log odds a respondent is comfortable with driverless cars are expected to decrease by 0.015, holding opinions about technology constant.</em></p>
</blockquote>
<p>Let’s take a moment to show this interpretation mathematically by comparing the log odds between <code>age</code> and <code>age + 1</code>, where <code>age+1</code> represents the one unit increase in <code>age</code>. The interpretations are written holding opinions about technology constant, so we can ignore this predictor when doing these calculations. We’ll also ignore the intercept, because it is also the same regardless of the value of <code>age</code>. Let <span class="math inline">\(\text{log odds (comfort | age)}\)</span> be the log odds given some value <code>age</code> and <span class="math inline">\(\text{log odds (comfort | age + 1)}\)</span> be the log odds given the value <code>age + 1</code>.</p>
<p>Then, the change in the log odds is</p>
<p><span id="eq-age-interpret-log-odds"><span class="math display">\[
\begin{aligned}
\text{log odds (comfort | age + 1)}  - \text{log odds (comfort | age)} &amp;= -0.015 \times ( \text{age} + 1) - (-  0.015 \times \text{age}) \\
&amp; = -0.015 ( \text{age} + 1 - \text{age}) \\
&amp; = -0.015
\end{aligned}
\tag{11.10}\]</span></span></p>
<p>From <a href="#eq-age-interpret-log-odds" class="quarto-xref">Equation&nbsp;<span>11.10</span></a>, <span class="math inline">\(\text{log odds (comfort | age + 1)} = \text{log odds (comfort | age)} - 0.015\)</span>.</p>
<p>Now we’ll interpret the coefficient of <code>age</code> in terms of the odds. Based on <a href="#eq-logistic-comfort-tech-age-exp" class="quarto-xref">Equation&nbsp;<span>11.9</span></a>, the interpretation of <code>age</code> in terms of the odds of being comfortable with driverless cars is the following:</p>
<blockquote class="blockquote">
<p><em>For each additional year increase in age, the <strong>odds</strong> a respondent is comfortable with driverless cars are expected to <strong>multiply</strong> by 0.985 (</em> <span class="math inline">\(e^{-0.015}\)</span><em>), holding opinions about technology constant.</em></p>
</blockquote>
<div class="math_rules">
<ul>
<li><span class="math inline">\(\log(a) + \log(b) = \log(ab)\)</span></li>
</ul>
<!-- -->
<ul>
<li><span class="math inline">\(\log(a) - \log(b) = \log(\frac{a}{b})\)</span></li>
</ul>
</div>
<p>We can show the interpretation mathematically starting with the result from <a href="#eq-age-interpret-log-odds" class="quarto-xref">Equation&nbsp;<span>11.10</span></a>.</p>
<p><span id="eq-age-interpret-odds"><span class="math display">\[
\begin{aligned}
\text{log odds (comfort | age + 1)}  - \text{log odds (comfort | age)} &amp;= -0.015 \\[8pt]
\Rightarrow \log\Bigg(\frac{\text{odds (comfort | age + 1)}}{\text{odds (comfort | age)}}\Bigg) &amp; = -0.015 \\[8pt]
*\text{exponetiate both sides}* \\[8pt]
\Rightarrow \frac{\text{odds (comfort | age + 1)}}{\text{odds (comfort | age)}} &amp; = e^{-0.015}
\end{aligned}
\tag{11.11}\]</span></span></p>
<p>From <a href="#eq-age-interpret-odds" class="quarto-xref">Equation&nbsp;<span>11.11</span></a>, <span class="math inline">\(\text{odds (comfort | age + 1)} = e^{-0.015} \times \text{odds (comfort | age)}\)</span>. The value <span class="math inline">\(\frac{\text{odds (comfort | age + 1)}}{\text{odds (comfort | age)}}\)</span> is the odds ratio of being comfortable with driverless cars between <code>age</code> versus <code>age + 1</code>. Thus, given <span class="math inline">\(\beta_j\)</span> is the coefficient for a quantitative predictor <span class="math inline">\(X_j\)</span>, the value <span class="math inline">\(e^{\beta_j}\)</span> is the (adjusted) odds ratio between <span class="math inline">\(X_j + 1\)</span> and <span class="math inline">\(X_j\)</span>.</p>
<div class="yourturn">
<p>Use the model in <a href="#tbl-logistic-comfort-tech-age" class="quarto-xref">Table&nbsp;<span>11.5</span></a>. Assume opinions about technology are held constant.</p>
<ul>
<li><p>How are the log odds of being comfortable with driverless cars expected to change when age increases by 5 years?</p></li>
<li><p>How are the odds of being comfortable with driverless cars expected to change when age increases by 5 years? <a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p></li>
</ul>
</div>
<!--# do i discuss marginal effects and the change in probability? -->
</section>
</section>
<section id="sec-logistic-inf" class="level2" data-number="11.5">
<h2 data-number="11.5" class="anchored" data-anchor-id="sec-logistic-inf"><span class="header-section-number">11.5</span> Inference for a coefficient <span class="math inline">\(\beta_j\)</span></h2>
<p>Inference for coefficients in logistic regression is very similar to inference in linear regression, introduced in <a href="05-slr-inference.html" class="quarto-xref"><span>Chapter 5</span></a> and <a href="08-mlr-inference.html" class="quarto-xref"><span>Chapter 8</span></a>. We will use these chapters as the foundation, discuss how they apply to logistic regression, and show ways in which inference for logistic regression differs. We refer the reader to the chapters on inference for linear regression for an introduction to statistical inference more generally.</p>
<section id="sec-logistic-sim-inf" class="level3" data-number="11.5.1">
<h3 data-number="11.5.1" class="anchored" data-anchor-id="sec-logistic-sim-inf"><span class="header-section-number">11.5.1</span> Simulation-based inference</h3>
<p>We can use simulation-based inference to draw conclusions about the model coefficients in logistic regression. The process for constructing bootstrap confidence intervals and using permutation sampling for hypothesis tests are the same as in linear regression, with the difference being the type of model that is fit. Here we will show how they apply to logistic regression.</p>
<section id="permutation-tests" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="permutation-tests">Permutation tests</h4>
<p>Hypothesis tests is used to test a claim about a population parameter. In the case of logistic regression, we use hypothesis tests to evaluate whether there is evidence of a relationship between a given predictor and the log odds of the response variable. The hypotheses to test whether there is a relationship between predictor <span class="math inline">\(X_j\)</span> and the response, after adjusting for the other predictors are in <a href="#eq-logistic-hypotheses" class="quarto-xref">Equation&nbsp;<span>11.12</span></a>.</p>
<p><span id="eq-logistic-hypotheses"><span class="math display">\[
\begin{aligned}
&amp;H_0: \beta_j = 0 - \text{There is no relationship between }X_j\text{ and the response}\\
&amp;H_a: \beta_j \neq 0 - \text{There is a relationship between }X_j\text{ and the response}
\end{aligned}
\tag{11.12}\]</span></span></p>
<p>The hypothesis test is conducted assuming the null hypothesis is true. When doing simulation-based inference, we use permutation sampling to generate the null distribution under this assumption. The process for permutation sampling is the same for logistic regression as with linear regression in <a href="05-slr-inference.html#sec-slr-testing-sim" class="quarto-xref"><span>Section 5.6</span></a>. The values of the predictor of interest <span class="math inline">\(X_j\)</span> are permuted, such that the values are randomly assigned to each observation. There is no relationship between the permuted values of <span class="math inline">\(X_j\)</span> and the response variable. The logistic model is fit to each permuted sample, and the estimated coefficients <span class="math inline">\(\hat{\beta}_j\)</span> from the permuted samples make up the null distribution. The null distribution is used to compute the p-value and draw a conclusion about the hypotheses.</p>
<p>We’ll use a permutation test to evaluate whether there is evidence of a relationship between <code>age</code> and <code>aidrive_comfort</code> , after adjusting for <code>tech_easy</code>. <!--# be consistent with hypotheses in MLR inf chapter - do I include( adjusting fo rtech?)--></p>
<p><span class="math display">\[
\begin{aligned}
H_0: \beta_{\text{age}} = 0 \hspace{2mm} \text{ vs } \hspace{2mm} \beta_{\text{age}} \neq 0
\end{aligned}
\]</span></p>
<p>The original value and five permutations of <code>age</code> for the first respondent are shown <a href="#tbl-logistic-permute" class="quarto-xref">Table&nbsp;<span>11.6</span></a>.</p>
<div class="cell">
<div id="tbl-logistic-permute" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-logistic-permute-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.6: Five permutations of <code>age</code> for Respondent 1
</figcaption>
<div aria-describedby="tbl-logistic-permute-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: left;">aidrive_comfort</th>
<th style="text-align: left;">tech_easy</th>
<th style="text-align: right;">age</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Original Sample</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Agree</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">Permutation 1</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Agree</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Permutation 2</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Agree</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Permutation 3</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Agree</td>
<td style="text-align: right;">69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Permutation 4</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Agree</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: left;">Permutation 5</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">Agree</td>
<td style="text-align: right;">80</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><a href="#tbl-logistic-permute" class="quarto-xref">Table&nbsp;<span>11.6</span></a> illustrates permutation sampling for one respondent. For each permutation, the value of <code>aidrive_comfort</code> and <code>tech_easy</code> are the same, and the values of <code>age</code> are randomly shuffled. <!--# do I use shuffled or assigned in previous chapters? Shuffled makes it clearer that these are values from the data set--></p>
<p><a href="#fig-logistic-permute" class="quarto-xref">Figure&nbsp;<span>11.8</span></a> is the null distribution produced from the 1000 permutations.</p>
<!--# make sure this viz is consistent with MLR permutation-->
<div class="cell">
<div class="cell-output-display">
<div id="fig-logistic-permute" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-logistic-permute-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-logistic-permute-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;11.8: Null distribution produced by permutation sampling. The solid line is the observed value of age."><img src="11-logistic_files/figure-html/fig-logistic-permute-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logistic-permute-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.8: Null distribution produced by permutation sampling. The solid line is the observed value of <code>age</code>.
</figcaption>
</figure>
</div>
</div>
</div>
<p><a href="#fig-logistic-permute" class="quarto-xref">Figure&nbsp;<span>11.8</span></a> shows that the estimated coefficient (solid vertical line) is far away from the center of the null distribution (the null hypothesized value 0), suggesting the evidence is not consistent with the null hypothesis. The p-value quantifies the strength of evidence against the null hypothesis. Based on the hypotheses in <a href="#eq-logistic-hypotheses" class="quarto-xref">Equation&nbsp;<span>11.12</span></a>, it is computed as the number of observations in the null distribution that have magnitude greater than <span class="math inline">\(|\beta_{\text{age}}|\)</span>.</p>
<p>The p-value in this example is <span class="math inline">\(\approx\)</span> 0. The p-value is very small, suggesting sufficient evidence against the null hypothesis. We reject the null hypothesis and conclude there is evidence of a relationship between age and comfort with driverless cars, after adjusting for opinions on technology.</p>
</section>
<section id="bootstrap-confidence-intervals" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="bootstrap-confidence-intervals">Bootstrap confidence intervals</h4>
<p>A confidence interval is a range of values in which a population parameter may reasonably take. <!--# compare this def to previous chapters and make sure its not plagarized-->This range of values is computed based on the sampling distribution of the estimated statistic. When conducting simulation-based inference, we use bootstrap sampling to construct this sampling distribution.</p>
<p>The process for constructing the sampling distribution using bootstrapping is the same for logistic regression as the process for linear regression in <a href="05-slr-inference.html#sec-bootstrap-ci" class="quarto-xref"><span>Section 5.4</span></a>. Each bootstrap sample is constructed by sampling with replacement <span class="math inline">\(n\)</span> times, where <span class="math inline">\(n\)</span> is the number of observations in the sample data. The model is fit to each bootstrap sample, and the estimated coefficients make up the sampling distribution. The <span class="math inline">\(C\%\)</span> confidence interval is computed as the bounds marking the middle <span class="math inline">\(C\%\)</span> of the bootstrapped sampling distribution.</p>
<p><a href="#fig-logistic-boot-dist" class="quarto-xref">Figure&nbsp;<span>11.9</span></a> is the bootstrap sampling distribution for <span class="math inline">\(\hat{\beta}_{\text{age}}\)</span> for 1000 bootstrap samples.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-logistic-boot-dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-logistic-boot-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-logistic-boot-dist-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15" title="Figure&nbsp;11.9: Bootstrap distribution for the coefficient of age. The vertical lines are the bounds for the 95% confidence interval."><img src="11-logistic_files/figure-html/fig-logistic-boot-dist-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-logistic-boot-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.9: Bootstrap distribution for the coefficient of <code>age</code>. The vertical lines are the bounds for the 95% confidence interval.
</figcaption>
</figure>
</div>
</div>
</div>
<p>The 95% bootstrap confidence is -0.021 to -0.009. These values are marked by vertical lines in <a href="#fig-logistic-boot-dist" class="quarto-xref">Figure&nbsp;<span>11.9</span></a>. As with the model output, these are in terms of the relationship between age and the log odds of being comfortable with driverless cars. Thus, the direct interpretation of the 95% confidence interval is as follows:</p>
<blockquote class="blockquote">
<p><em>We are 95% confident that for each additional year in age, the log odds of being comfortable with driverless cars decrease between 0.009 to 0.021, holding opinions on technology constant.</em></p>
</blockquote>
<p>The interpretation in terms of the odds is the following:</p>
<blockquote class="blockquote">
<p><em>We are 95% confident that for each additional year in age, the odds of being comfortable with driverless cars multiply by a factor of 0.98 (</em> <span class="math inline">\(e^{-0.021}\)</span><em>) to 0.991 (</em> <span class="math inline">\(e^{-0.009}\)</span> <em>), holding opinions on technology constant.</em></p>
</blockquote>
</section>
</section>
<section id="sec-logistic-inf-theory" class="level3" data-number="11.5.2">
<h3 data-number="11.5.2" class="anchored" data-anchor-id="sec-logistic-inf-theory"><span class="header-section-number">11.5.2</span> Theory-based inference</h3>
<p>The general process for theory-based inference for a single coefficient in logistic regression is similar as linear regression. The primary difference is in the distribution of the estimated coefficient <span class="math inline">\(\hat{\beta}_j\)</span>.</p>
<p>When fitting a linear regression model, we have an formula for the estimated coefficients (see <a href="04-slr.html#sec-slr-estimation" class="quarto-xref"><span>Section 4.4</span></a> and <a href="07-mlr.html#sec-mlr-estimate-coef" class="quarto-xref"><span>Section 7.3</span></a>). Thus we have an exact formula for the distribution of a given coefficient <span class="math inline">\(\hat{\beta}_j\)</span> that applies for any sample size. Recall that we account for the sample size in how we define degrees of freedom of the <span class="math inline">\(t\)</span> distribution for the coefficients (see <a href="08-mlr-inference.html#sec-mlr-inf-foundation" class="quarto-xref"><span>Section 8.4.1</span></a>).</p>
<p>In logistic regression, the coefficients are estimated using maximum likelihood estimation (see <a href="#sec-logistic-interpret-coef" class="quarto-xref"><span>Section 11.4</span></a>), such that numerical optimization methods are used to find the combination of coefficients that maximize the likelihood function. There is no closed-form equation for the estimated coefficients as with linear regression. Because the estimated coefficients are approximated using optimization, the distribution of the coefficients are also approximated.</p>
<p>When the sample size is large <!--# figure out reference for what large is-->, the distribution of the individual estimated coefficient <span class="math inline">\(\hat{\beta}_j\)</span> is <span class="math inline">\(N(\beta_j, SE_{\hat{\beta}_j})\)</span>, approximately normal with an expected value of <span class="math inline">\(\beta_j\)</span>, the true value of the coefficient and standard error <span class="math inline">\(SE_{\hat{\beta}_j}\)</span>. In practice, we will get the estimated standard error from the software output. Mathematical details about computing <span class="math inline">\(SE_{\hat{\beta}_j}\)</span> are described in <a href="appendix-logistic.html#sec-logistic-inference-matrix" class="quarto-xref"><span>Section B.3</span></a>.</p>
<section id="hypothesis-test" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="hypothesis-test">Hypothesis test</h4>
<p>The steps for the hypotheses test are the same as those outlined in <a href="08-mlr-inference.html#sec-mlr-hypothesis-test" class="quarto-xref"><span>Section 8.4.2</span></a>.</p>
<ol type="1">
<li>State the null and alternative hypotheses.</li>
<li>Calculate a test statistic.</li>
<li>Calculate a p-value.</li>
<li>Draw a conclusion.</li>
</ol>
<p>The hypotheses for a single coefficient are the same as in <a href="#eq-logistic-hypotheses" class="quarto-xref">Equation&nbsp;<span>11.12</span></a>:</p>
<p><span class="math display">\[
H_0: \beta_j = 0 \hspace{2mm} \text{ vs }\hspace{2mm} H_a: \beta_j \neq 0
\]</span></p>
<p>The test statistic, in <a href="#eq-logistic-test-stat" class="quarto-xref">Equation&nbsp;<span>11.13</span></a>, is called the Wald test statistic <span class="citation" data-cites="wald1943tests">(<a href="references.html#ref-wald1943tests" role="doc-biblioref">Wald 1943</a>)</span>, <!--# make sure this is the correct reference-->because it is based on the approximation of the mean and standard error as <span class="math inline">\(n\)</span> is large.</p>
<p><span id="eq-logistic-test-stat"><span class="math display">\[
z = \frac{\hat{\beta}_j - 0}{SE_{\hat{\beta}_j}}
\tag{11.13}\]</span></span></p>
<p>The test statistic, denoted by <span class="math inline">\(z\)</span>, is the number of standard errors the estimated coefficient <span class="math inline">\(\hat{\beta}_j\)</span> is from 0, the hypothesized mean of the distribution. It follows a standard normal distribution, <span class="math inline">\(N(0, 1)\)</span>, because it is based on asymptotic results (compared to the <span class="math inline">\(t\)</span> test statistic in linear regression which applies even for small <span class="math inline">\(n\)</span>). Because the alternative hypothesis is two-sided, the p-value is computed as <span class="math inline">\(P(|Z| \geq |z|)\)</span> , where <span class="math inline">\(Z \sim N(0, 1)\)</span>. <!--# did i do > or >= in linear regression?--> The p-value is interpreted as before, with small p-values providing stronger evidence against the null hypothesis.</p>
<p>Let’s take a look at the hypothesis test for the coefficient of <code>age</code> using the theory-based methods. The components for the theory-based hypothesis test are produced in the model output. The output of the model including <code>tech_easy</code> and <code>age</code> is reproduced in <a href="#tbl-comfort-tech-age-2" class="quarto-xref">Table&nbsp;<span>11.7</span></a> along with the 95% confidence intervals for the model coefficients.</p>
<div class="cell">
<div id="tbl-comfort-tech-age-2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comfort-tech-age-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.7: Model output for <code>aidrive_comfort</code> versus <code>tech_easy</code> and <code>age</code> with 95% confidence intervals for coefficients
</figcaption>
<div aria-describedby="tbl-comfort-tech-age-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.420</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">2.020</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">0.828</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyCan’t choose</td>
<td style="text-align: right;">-0.118</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">-0.294</td>
<td style="text-align: right;">0.769</td>
<td style="text-align: right;">-0.928</td>
<td style="text-align: right;">0.661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tech_easyAgree</td>
<td style="text-align: right;">0.678</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">4.487</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.383</td>
<td style="text-align: right;">0.976</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyDisagree</td>
<td style="text-align: right;">-0.499</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">-1.690</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">-1.094</td>
<td style="text-align: right;">0.068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">-4.902</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-0.021</td>
<td style="text-align: right;">-0.009</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The hypotheses are the same as with simulation-based inference</p>
<p><span class="math display">\[
H_0:\beta_{\text{age}} = 0 \hspace{2mm} \text{ vs }\hspace{2mm} \beta_{\text{age}} \neq 0
\]</span></p>
<p>The null hypothesis is that there is no relationship between age and comfort with driverless cars after accounting for opinions about technology. The alternative hypothesis is that there is a relationship.</p>
<p>The test statistic<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a> is computed as</p>
<p><span class="math display">\[
z = \frac{-0.015 - 0}{0.003} \approx - 5
\]</span></p>
<p>The p-value is computed as <span class="math inline">\(P(|Z| \geq |-4.902|) \approx\)</span> 4.83^{-6}. This value is so small it rounds to 0 when displaying the results to 3 digits. This is consistent with the p-value we observed from the permutation test in <a href="#sec-logistic-sim-inf" class="quarto-xref"><span>Section 11.5.1</span></a>. Because the p-value is small, we reject the null hypothesis and conclude there is evidence of a relationship between age and comfort with driverless cars after adjusting for opinions about technology.</p>
<div class="analysis_in_practice">
<p>We can use a decision-making threshold <span class="math inline">\(\alpha\)</span> when using the p-value to draw conclusions from a hypothesis test. The potential for Type I and Type II errors is the same for logistic regression as in linear regression. See <a href="05-slr-inference.html#sec-slr-inf-conclusion" class="quarto-xref"><span>Section 5.6.4</span></a> for more on choosing <span class="math inline">\(\alpha\)</span> and potential errors.</p>
</div>
</section>
<section id="confidence-interval" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="confidence-interval">Confidence interval</h4>
<p>The equation to compute the confidence interval for coefficients in logistic regression is very similar to the formula in linear regression from <a href="05-slr-inference.html#sec-slr-inf-clt" class="quarto-xref"><span>Section 5.8</span></a>. The difference is the critical value <span class="math inline">\(z^*\)</span> is computed from the <span class="math inline">\(N(0, 1)\)</span> distribution</p>
<p><span id="eq-logistic-theory-ci"><span class="math display">\[
\hat{\beta}_j \pm z^* \times SE_{\hat{\beta}_j}
\tag{11.14}\]</span></span></p>
<p>In practice, the confidence interval is produced in the model output. Let’s show how the 95% confidence interval for <code>age</code> is computed in <a href="#tbl-comfort-tech-age-2" class="quarto-xref">Table&nbsp;<span>11.7</span></a>.</p>
<p>The values for <span class="math inline">\(\hat{\beta}_j\)</span> and <span class="math inline">\(SE_{\hat{\beta}_j}\)</span> can be read directly from table, as before. The critical value <span class="math inline">\(z^*\)</span> is the point on the <span class="math inline">\(N(0, 1)\)</span> distribution such that the middle 95% (or <span class="math inline">\(C\%\)</span> in general) of the distribution is between <span class="math inline">\(-z^*\)</span> and <span class="math inline">\(z^*\)</span>. We can use statistical software to get this value as shown in <a href="#sec-logistic-r" class="quarto-xref"><span>Section 11.7</span></a>. The <span class="math inline">\(z^*\)</span> for the 95% confidence interval is 1.96.</p>
<p>The 95% confidence interval for the coefficient of <code>age</code> is</p>
<p><span class="math display">\[
\begin{aligned}
&amp;-0.015 \pm 1.96 \times 0.003 \\[5pt]
\Rightarrow &amp;-0.015 \pm  0.00588 \\[5pt]
\Rightarrow &amp;\mathbf{[ -0.021 , -0.009]}  
\end{aligned}
\]</span></p>
<div class="yourturn">
<ul>
<li>Interpret this interval in the context of the data in terms of the odds of being comfortable with driverless cars.</li>
<li>How does this interval compare to the bootstrap confidence interval computed in <a href="#sec-logistic-sim-inf" class="quarto-xref"><span>Section 11.5.1</span></a>? <a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></li>
</ul>
</div>
</section>
<section id="connection-between-hypothesis-test-and-confidence-intervals" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="connection-between-hypothesis-test-and-confidence-intervals">Connection between hypothesis test and confidence intervals</h4>
<p>The same connection between two-sided hypothesis tests and confidence intervals applies in the context of logistic regression as we saw in linear regression in <a href="05-slr-inference.html#sec-slr-inf-relationship-ci-test" class="quarto-xref"><span>Section 5.7</span></a> . A two-sided hypothesis test with decision-making threshold of <span class="math inline">\(\alpha\)</span> directly corresponds to the <span class="math inline">\((1 - \alpha) \times 100 \%\)</span> confidence interval. For example, a hypothesis test with decision-making threshold of <span class="math inline">\(\alpha = 0.05\)</span> directly corresponds to the 95% (<span class="math inline">\((1 - 0.05) \times 100\)</span>) confidence interval.</p>
<p>This means we can use a confidence interval to evaluate a claim about a coefficient and get a range of values the population coefficient may take. The following are the relationship between the confidence interval and hypothesis test:</p>
<ul>
<li><p>Confidence interval for <span class="math inline">\(\beta_j\)</span> : If 0 is in the interval, fail to reject the null hypothesis. If 0 is not in the interval, reject the null hypothesis.</p></li>
<li><p>Confidence interval for <span class="math inline">\(e^{\beta_j}\)</span>: If 1 is in the interval, fail to reject the null hypothesis. If 1 is not in the interval, reject the null hypothesis.</p></li>
</ul>
<div class="yourturn">
<p>Use the output in <a href="#tbl-comfort-tech-age-2" class="quarto-xref">Table&nbsp;<span>11.7</span></a>.</p>
<ul>
<li>Show how the test statistic is computed for <code>tech_easyDisagree</code>. Interpret this value in the context of the data.</li>
<li>Do the data provide evidence that the odds are different among those who disagree technology makes life easier compared to those who are neutral (the baseline), after adjusting for age? Use <span class="math inline">\(\alpha = 0.05\)</span> Explain.</li>
<li>Show how the 95% confidence interval for <code>tech_easyDisagree</code> is computed. Is it consistent with your conclusion in the previous question?<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></li>
</ul>
</div>
<!--# Inference for a subset of coefficients  -->
<!--# Make this section brief and refer to Roback and Hilbe for more information about this.-->
</section>
</section>
</section>
<section id="sec-logistic-conditions" class="level2" data-number="11.6">
<h2 data-number="11.6" class="anchored" data-anchor-id="sec-logistic-conditions"><span class="header-section-number">11.6</span> Model conditions</h2>
<!--# model conditions or assumptions?-->
<p>We fit logistic regression model under a set of assumptions. These are similar to the assumptions for linear regression in <a href="05-slr-inference.html#sec-slr-foundation" class="quarto-xref"><span>Section 5.3</span></a>, but there is no assumption related to normality or equal variance.</p>
<ol type="1">
<li>There is a linear relationship between the predictors and logit of the response variable</li>
<li>The observations are independent of one another <!--# use same wording as linear regression--></li>
</ol>
<p>Similar to linear regression, we check model conditions to evaluate whether these assumptions hold for the data.</p>
<section id="linearity" class="level3" data-number="11.6.1">
<h3 data-number="11.6.1" class="anchored" data-anchor-id="linearity"><span class="header-section-number">11.6.1</span> Linearity</h3>
<p>The linearity assumption for logistic regression states that there is a linear relationship between the predictors and the logit of the response variable. We check this assumption by looking at plots of the quantitative predictors versus the empirical logit of the response. The <strong>empirical logit</strong> is the log-odds of a binary variable (“logit”) calculated from the data (“empirical”). For example, <a href="#eq-emp-logit" class="quarto-xref">Equation&nbsp;<span>11.15</span></a> is the empirical logit for the comfort with driverless cars in the sample data set.</p>
<p><span id="eq-emp-logit"><span class="math display">\[
\text{empirical logit} = \log\Big(\frac{\pi}{1 - \pi}\Big) = \log\Big(\frac{0.545}{1 - 0.545}\Big) = 0.180
\tag{11.15}\]</span></span></p>
<p>We can also look at the empirical logit by subgroup of a categorical variable. For example, <a href="#tbl-emp-logit-tech" class="quarto-xref">Table&nbsp;<span>11.8</span></a> shows the empirical logit by opinion on whether technology makes life easier.</p>
<div class="cell">
<div id="tbl-emp-logit-tech" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-emp-logit-tech-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.8: Probability and empirical logit of <code>aidrive_comfort</code> by <code>tech_easy</code>
</figcaption>
<div aria-describedby="tbl-emp-logit-tech-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">tech_easy</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Probability</th>
<th style="text-align: right;">Empirical Logit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Neutral</td>
<td style="text-align: right;">217</td>
<td style="text-align: right;">0.415</td>
<td style="text-align: right;">-0.344</td>
</tr>
<tr class="even">
<td style="text-align: left;">Can’t choose</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">0.400</td>
<td style="text-align: right;">-0.405</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Agree</td>
<td style="text-align: right;">1201</td>
<td style="text-align: right;">0.588</td>
<td style="text-align: right;">0.355</td>
</tr>
<tr class="even">
<td style="text-align: left;">Disagree</td>
<td style="text-align: right;">73</td>
<td style="text-align: right;">0.288</td>
<td style="text-align: right;">-0.907</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Computing the empirical logit across values of a quantitative predictor is similar as the process for categorical predictors. We divide the values of the quantitative predictor into bins and compute the empirical logit of the response for the observations within each bin. There are multiple ways to divide the quantitative predictor into bins. Some software creates the bins, such that there are an equal number of observations in each bin. Another option is to create bins by dividing by some incremental amount (e.g., dividing <code>age</code> into 5 or 10 year increments). Dividing the variable by the same incremental amount can be more easily interpreted; however, there may be large variation in the number of observations in each bin that needs to be taken into account when comparing the empirical logit across bins. The former method may be less interpretable, but we know the empirical logit is computed using the same observations for each bin.</p>
<p><a href="#tbl-emp-logit-age" class="quarto-xref">Table&nbsp;<span>11.9</span></a> shows the number of observations <span class="math inline">\(n\)</span>, probability, and empirical logit across bins of <code>age</code> using the two approaches for dividing <code>age</code> into bins. In Table (a) of <a href="#tbl-emp-logit-age" class="quarto-xref">Table&nbsp;<span>11.9</span></a>, the bins have been created such that the observations are more evenly distributed across bins. Often, the number of observations will be equal or differ by a small amount. In this case, because <code>age</code> is a discrete variable, there are many observations with the exact same value of age. For example, there are 38 observations with the age of 39 years old. Because all observations with the same age are in the same bin, the number of observations in bins that include ages that occur frequently is higher than less common ages in the data, such as those over 70 years old. Note, however, that the number of observations in each bin are still more even than when the bins are created using equal age increments.</p>
<div id="tbl-emp-logit-age" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-emp-logit-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.9: Probability and empirical logit of <code>aidrive_comfort</code> by <code>age</code>
</figcaption>
<div aria-describedby="tbl-emp-logit-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-emp-logit-age" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-emp-logit-age-1" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-emp-logit-age-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Evenly distribute observations
</figcaption>
<div aria-describedby="tbl-emp-logit-age-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-emp-logit-age-1" class="do-not-create-environment caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">age_bins</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Probability</th>
<th style="text-align: right;">Empirical Logit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">[18,27)</td>
<td style="text-align: right;">158</td>
<td style="text-align: right;">0.677</td>
<td style="text-align: right;">0.741</td>
</tr>
<tr class="even">
<td style="text-align: left;">[27,34)</td>
<td style="text-align: right;">154</td>
<td style="text-align: right;">0.636</td>
<td style="text-align: right;">0.560</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[34,40)</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">0.607</td>
<td style="text-align: right;">0.434</td>
</tr>
<tr class="even">
<td style="text-align: left;">[40,45)</td>
<td style="text-align: right;">141</td>
<td style="text-align: right;">0.582</td>
<td style="text-align: right;">0.329</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[45,50)</td>
<td style="text-align: right;">134</td>
<td style="text-align: right;">0.575</td>
<td style="text-align: right;">0.301</td>
</tr>
<tr class="even">
<td style="text-align: left;">[50,57)</td>
<td style="text-align: right;">157</td>
<td style="text-align: right;">0.490</td>
<td style="text-align: right;">-0.038</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[57,63)</td>
<td style="text-align: right;">153</td>
<td style="text-align: right;">0.438</td>
<td style="text-align: right;">-0.250</td>
</tr>
<tr class="even">
<td style="text-align: left;">[63,69)</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">0.466</td>
<td style="text-align: right;">-0.135</td>
</tr>
<tr class="odd">
<td style="text-align: left;">[69,75)</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">0.462</td>
<td style="text-align: right;">-0.154</td>
</tr>
<tr class="even">
<td style="text-align: left;">[75,89]</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">0.507</td>
<td style="text-align: right;">0.029</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="tbl-emp-logit-age" style="flex-basis: 50.0%;justify-content: center;">
<div id="tbl-emp-logit-age-2" class="do-not-create-environment quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-tbl figure">
<figcaption class="quarto-float-caption-top quarto-subfloat-caption quarto-subfloat-tbl" id="tbl-emp-logit-age-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Equal age increments
</figcaption>
<div aria-describedby="tbl-emp-logit-age-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table id="tbl-emp-logit-age-2" class="do-not-create-environment caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">age_bins</th>
<th style="text-align: right;">n</th>
<th style="text-align: right;">Probability</th>
<th style="text-align: right;">Empirical Logit</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(18,25]</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">0.667</td>
<td style="text-align: right;">0.693</td>
</tr>
<tr class="even">
<td style="text-align: left;">(25,32]</td>
<td style="text-align: right;">151</td>
<td style="text-align: right;">0.642</td>
<td style="text-align: right;">0.586</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(32,39]</td>
<td style="text-align: right;">207</td>
<td style="text-align: right;">0.618</td>
<td style="text-align: right;">0.483</td>
</tr>
<tr class="even">
<td style="text-align: left;">(39,46]</td>
<td style="text-align: right;">193</td>
<td style="text-align: right;">0.549</td>
<td style="text-align: right;">0.198</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(46,54]</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">0.572</td>
<td style="text-align: right;">0.291</td>
</tr>
<tr class="even">
<td style="text-align: left;">(54,61]</td>
<td style="text-align: right;">188</td>
<td style="text-align: right;">0.463</td>
<td style="text-align: right;">-0.149</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(61,68]</td>
<td style="text-align: right;">181</td>
<td style="text-align: right;">0.448</td>
<td style="text-align: right;">-0.211</td>
</tr>
<tr class="even">
<td style="text-align: left;">(68,75]</td>
<td style="text-align: right;">170</td>
<td style="text-align: right;">0.471</td>
<td style="text-align: right;">-0.118</td>
</tr>
<tr class="odd">
<td style="text-align: left;">(75,82]</td>
<td style="text-align: right;">90</td>
<td style="text-align: right;">0.567</td>
<td style="text-align: right;">0.268</td>
</tr>
<tr class="even">
<td style="text-align: left;">(82,89]</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">0.400</td>
<td style="text-align: right;">-0.405</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
</div>
</div>
</div>
</figure>
</div>
<!--# maybe format this different? get rid of probability column?-->
<p>Now that we can compute the empirical logit, let’s use it to check the linearity assumption. As with linear regression, we only check linearity for quantitative predictors. To check linearity, we will make a plot of the empirical logit of the response versus the bins of the quantitative predictor. We use the mean value within each bin of the predictor to represent the bin on the graph.</p>
<p><a href="#fig-emp-logit-age" class="quarto-xref">Figure&nbsp;<span>11.10</span></a> shows a plot of the empirical logit of being comfortable with driverless cars versus the mean value of age in each bin. We use the bins from Table (a) in <a href="#tbl-emp-logit-age" class="quarto-xref">Table&nbsp;<span>11.9</span></a>, so that we know there is a similar number of observations represented by each point on the graph.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-emp-logit-age" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-emp-logit-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="11-logistic_files/figure-html/fig-emp-logit-age-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16" title="Figure&nbsp;11.10: Empirical logit of aidrive_comfort versus age"><img src="11-logistic_files/figure-html/fig-emp-logit-age-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-emp-logit-age-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;11.10: Empirical logit of <code>aidrive_comfort</code> versus <code>age</code>
</figcaption>
</figure>
</div>
</div>
</div>
<!--# use the same format as the conditions from linear regression-->
<p>When examining the plot of empirical logit versus the binned quantitative predictor, we are asking whether a line would reasonably describe the relationship between the predictor and empirical logit. The condition is satisfied if the trend generally looks linear overall. As with checking the linearity condition for linear regression, we are looking for obvious violations, not exact adherence to linearity.</p>
<p>From <a href="#fig-emp-logit-age" class="quarto-xref">Figure&nbsp;<span>11.10</span></a>, it appears there is a potential quadratic relationship between age and comfort with driverless cars, and thus the linearity condition <strong>is not satisfied.</strong> <!--# this seems like a strange conclusion. maybe reframe the purpose of the linearity condition.---> The empirical logit is lowest for respondents around 60 years old, then it appears to increase again. This prompts us to consider a quadratic term for the model.</p>
<div class="cell">
<div id="tbl-comfort-tech-age-sq" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-comfort-tech-age-sq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.10: Logistic regression model including quadratic term for age.
</figcaption>
<div aria-describedby="tbl-comfort-tech-age-sq-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">1.2106</td>
<td style="text-align: right;">0.4545</td>
<td style="text-align: right;">2.664</td>
<td style="text-align: right;">0.0077</td>
<td style="text-align: right;">0.3246</td>
<td style="text-align: right;">2.1077</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyCan’t choose</td>
<td style="text-align: right;">-0.1600</td>
<td style="text-align: right;">0.4040</td>
<td style="text-align: right;">-0.396</td>
<td style="text-align: right;">0.6922</td>
<td style="text-align: right;">-0.9745</td>
<td style="text-align: right;">0.6227</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tech_easyAgree</td>
<td style="text-align: right;">0.6832</td>
<td style="text-align: right;">0.1512</td>
<td style="text-align: right;">4.519</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.3884</td>
<td style="text-align: right;">0.9816</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyDisagree</td>
<td style="text-align: right;">-0.5118</td>
<td style="text-align: right;">0.2956</td>
<td style="text-align: right;">-1.731</td>
<td style="text-align: right;">0.0834</td>
<td style="text-align: right;">-1.1070</td>
<td style="text-align: right;">0.0562</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">-0.0498</td>
<td style="text-align: right;">0.0181</td>
<td style="text-align: right;">-2.755</td>
<td style="text-align: right;">0.0059</td>
<td style="text-align: right;">-0.0854</td>
<td style="text-align: right;">-0.0145</td>
</tr>
<tr class="even">
<td style="text-align: left;">I(age^2)</td>
<td style="text-align: right;">0.0003</td>
<td style="text-align: right;">0.0002</td>
<td style="text-align: right;">1.967</td>
<td style="text-align: right;">0.0492</td>
<td style="text-align: right;">0.0000</td>
<td style="text-align: right;">0.0007</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<!--# is adding the quadratic term too much of a digression?-->
<p><a href="#tbl-comfort-tech-age-sq" class="quarto-xref">Table&nbsp;<span>11.10</span></a> is the output of the model that includes the quadratic term for <code>age</code>. The p-value for the quadratic term is around 0.05, so based on this alone, it is unclear whether or not to keep the squared term in the model. Thus, let’s look at the confidence interval and some model comparison statistics introduced in <a href="10-model-eval.html#sec-model-compare-stats" class="quarto-xref"><span>Section 10.2</span></a> to have more information to take into account regarding the quadratic term.</p>
<p>The 95% confidence interval for the coefficient of <span class="math inline">\(\text{age}^2\)</span> is 1.955^{-6} to 6.802^{-4}. This shows the quadratic term has a very small adjustment on the relationship between age and comfort with driverless cars. Even if the quadratic term is statistically significant, it may not be practically significant.</p>
<div class="cell">
<div id="tbl-age-sq-compare" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-age-sq-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;11.11: AIC and BIC for models with and without quadratic term for <code>age</code>
</figcaption>
<div aria-describedby="tbl-age-sq-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">Model</th>
<th style="text-align: right;">AIC</th>
<th style="text-align: right;">BIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Age</td>
<td style="text-align: right;">2036</td>
<td style="text-align: right;">2062</td>
</tr>
<tr class="even">
<td style="text-align: left;">Age + Age^2</td>
<td style="text-align: right;">2034</td>
<td style="text-align: right;">2066</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In <a href="#tbl-age-sq-compare" class="quarto-xref">Table&nbsp;<span>11.11</span></a>, we look at the AIC and BIC for the model with and without the quadratic term for age. The model that includes <span class="math inline">\(\text{age}^2\)</span> has a lower AIC but a higher BIC. The difference in the AIC values is small, indicating that that one model is not preferenced over the other in terms of model fit. The same is true when comparing the values of BIC. Therefore, with a mind towards choosing the most parsimonious (simplest) model without hindering model performance, we choose to remove the quadratic term and move forward including only the main effect for <code>age</code>.</p>
</section>
<section id="independence" class="level3" data-number="11.6.2">
<h3 data-number="11.6.2" class="anchored" data-anchor-id="independence"><span class="header-section-number">11.6.2</span> Independence</h3>
<p>The independence assumption for logistic regression is similar to the assumption for linear regression, that there are no dependencies between observations. As with linear regression, this assumption is important, because we conduct inference assuming we have <span class="math inline">\(n\)</span> pieces of independent information produced by the <span class="math inline">\(n\)</span> observations. If observations there is dependency between observations, then we are effectively working with less than <span class="math inline">\(n\)</span> pieces of independent information, as knowing something about one observation tells a lot about all the others that are correlated with it.</p>
<p>We typically evaluate independence based on a description of the observations and the data collection process. If there are potential dependency issues based on the order in which the data were collected, spatial correlation, or other sub group dependencies, we can use visualizations to plot the odds or empirical logit of the response by time, space, or subgroup, respectively. We can also add predictors in the model to account for those potential dependencies.</p>
<p>For this analysis on comfort with driverless cars, the independence condition is satisfied<strong>.</strong> Based on the description of the sample and data collection process in <a href="#sec-logistic-intro-gss" class="quarto-xref"><span>Section 11.1</span></a>, we can reasonably conclude there are no dependencies between respondents.</p>
<div class="analysis_in_practice">
<p>We conduct logistic regression assuming the data are a representative sample from the population of interest. Ideally, it would be a random sample, but that is not always feasible in practice. Therefore, even if the sample is not completely random, it should be representative of the population.</p>
<p>If there are biases in the sample (e.g., a particular subgroup is over or under represented in the data), they will influence the interpretations, conclusions, and predictions from the model. Therefore, we can narrow the scope of the population for the analysis, or clearly disclose these biases when presenting the results.</p>
<p>This issue often occurs in survey data, like the data we’re analyzing in this chapter. Data scientists analyzing survey data will often include weights in their analysis so that the sample looks more representative of the population in the analysis calculations even if the original data has some bias. <!--# insert refs for weighted methods--></p>
</div>
<!--# do i need to say anything about diagnostics and outliers? -->
<!--# From Chat GPT: Maybe mention perfect separation (this could be a callout box). Does this go in the next chapter about prediction?-->
</section>
</section>
<section id="sec-logistic-r" class="level2" data-number="11.7">
<h2 data-number="11.7" class="anchored" data-anchor-id="sec-logistic-r"><span class="header-section-number">11.7</span> Logistic regression in R</h2>
<section id="fitting-a-logistic-model" class="level3" data-number="11.7.1">
<h3 data-number="11.7.1" class="anchored" data-anchor-id="fitting-a-logistic-model"><span class="header-section-number">11.7.1</span> Fitting a logistic model</h3>
<p>The logistic regression model is fit using <code>glm()</code> in the <strong>stats</strong> package in base R. This function is used to fit a variety of models that are part of the wider class of models called generalized linear models, so we must also specify which generalized linear model is being fit when using this function. The argument <code>family = binomial</code> is specifies that the model fit is a logistic regression model.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>comfort_tech_age_fit <span class="ot">&lt;-</span> <span class="fu">glm</span>(aidrive_comfort <span class="sc">~</span> tech_easy <span class="sc">+</span> age,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>                          <span class="at">data =</span> gss24_ai, </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>                          <span class="at">family =</span> binomial)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>We input the observed categorical response variable and R does all computations behind the scenes to produce the model in terms of the logit. The response variable must be coded as a character (<code>&lt;chr&gt;</code>) or factor (<code>&lt;fct&gt;</code>) type.</p>
<p>The <code>tidy</code> function produces the model output in a tidy form and <code>kable()</code> can be used to neatly format the results to a specific number of digits. The argument <code>conf.int = TRUE</code> shows the confidence interval, and <code>conf.level =</code> is used to set the confidence level.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(comfort_tech_age_fit, <span class="at">conf.int =</span> <span class="cn">TRUE</span> ,<span class="at">conf.level =</span> <span class="fl">0.95</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">0.420</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">2.020</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">0.012</td>
<td style="text-align: right;">0.828</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyCan’t choose</td>
<td style="text-align: right;">-0.118</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">-0.294</td>
<td style="text-align: right;">0.769</td>
<td style="text-align: right;">-0.928</td>
<td style="text-align: right;">0.661</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tech_easyAgree</td>
<td style="text-align: right;">0.678</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">4.487</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.383</td>
<td style="text-align: right;">0.976</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyDisagree</td>
<td style="text-align: right;">-0.499</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">-1.690</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">-1.094</td>
<td style="text-align: right;">0.068</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">-0.015</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">-4.902</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">-0.021</td>
<td style="text-align: right;">-0.009</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>By default, the tidy function will show the model output for the response in terms of the logit. The argument <code>exponentiate = TRUE</code> will produce the output for the model in terms of the odds with the exponentiated coefficients. The argument, <code>exponentiate</code> is set to <code>FALSE</code> by default.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(comfort_tech_age_fit, <span class="at">conf.int =</span> <span class="cn">TRUE</span> ,<span class="at">conf.level =</span> <span class="fl">0.95</span>, </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">exponentiate =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 28%">
<col style="width: 11%">
<col style="width: 12%">
<col style="width: 12%">
<col style="width: 10%">
<col style="width: 11%">
<col style="width: 12%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">1.522</td>
<td style="text-align: right;">0.208</td>
<td style="text-align: right;">2.020</td>
<td style="text-align: right;">0.043</td>
<td style="text-align: right;">1.012</td>
<td style="text-align: right;">2.289</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyCan’t choose</td>
<td style="text-align: right;">0.889</td>
<td style="text-align: right;">0.402</td>
<td style="text-align: right;">-0.294</td>
<td style="text-align: right;">0.769</td>
<td style="text-align: right;">0.395</td>
<td style="text-align: right;">1.936</td>
</tr>
<tr class="odd">
<td style="text-align: left;">tech_easyAgree</td>
<td style="text-align: right;">1.969</td>
<td style="text-align: right;">0.151</td>
<td style="text-align: right;">4.487</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">1.467</td>
<td style="text-align: right;">2.653</td>
</tr>
<tr class="even">
<td style="text-align: left;">tech_easyDisagree</td>
<td style="text-align: right;">0.607</td>
<td style="text-align: right;">0.295</td>
<td style="text-align: right;">-1.690</td>
<td style="text-align: right;">0.091</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">1.071</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">0.985</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">-4.902</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">0.979</td>
<td style="text-align: right;">0.991</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="simulation-based-inference" class="level3" data-number="11.7.2">
<h3 data-number="11.7.2" class="anchored" data-anchor-id="simulation-based-inference"><span class="header-section-number">11.7.2</span> Simulation-based inference</h3>
<p>The code for simulation-based inference is the same for logistic regression as the code for linear regression introduced in <a href="04-slr.html#sec-slr-R" class="quarto-xref"><span>Section 4.8</span></a>. Behind the scenes, the functions in the <strong>infer</strong> R package use the response variable to determine whether to fit a linear or logistic regression model.</p>
<p>Below is the code for the bootstrap confidence intervals and permutation test conducted in <a href="#sec-logistic-sim-inf" class="quarto-xref"><span>Section 11.5.1</span></a>. We refer the reader to <a href="08-mlr-inference.html#sec-mlr-sim-inf-R" class="quarto-xref"><span>Section 8.7.1</span></a> for more a more detailed explanation about the code.</p>
<p><strong>Permutation test</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># construct null distribution using permutation sampling</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> gss24_ai <span class="sc">|&gt;</span> </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(aidrive_comfort <span class="sc">~</span> tech_easy <span class="sc">+</span> age) <span class="sc">|&gt;</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"permute"</span>, <span class="at">variables =</span> age) <span class="sc">|&gt;</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>()</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># compute observed coefficient</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>obs_fit <span class="ot">&lt;-</span> gss24_ai <span class="sc">|&gt;</span> </span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(aidrive_comfort <span class="sc">~</span> tech_easy <span class="sc">+</span> age) <span class="sc">|&gt;</span> </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>()</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="co"># compute p-value</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>pval <span class="ot">&lt;-</span> <span class="fu">get_p_value</span>(null_dist, <span class="at">obs_stat =</span> obs_fit, <span class="at">direction =</span> <span class="st">"two-sided"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p><strong>Bootstrap confidence interval</strong></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># construct bootstrap distribution </span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>boot_dist <span class="ot">&lt;-</span> gss24_ai <span class="sc">|&gt;</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(aidrive_comfort <span class="sc">~</span> tech_easy <span class="sc">+</span> age) <span class="sc">|&gt;</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> <span class="dv">1000</span>, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>()</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># compute confidence interval</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">get_confidence_interval</span>(</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    boot_dist, </span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">level =</span> <span class="fl">0.95</span>, </span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">point_estimate =</span> obs_fit</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="empirical-logit-plots" class="level3" data-number="11.7.3">
<h3 data-number="11.7.3" class="anchored" data-anchor-id="empirical-logit-plots"><span class="header-section-number">11.7.3</span> Empirical logit plots</h3>
<p>The code to compute the empirical logit primarily utilizes data wrangling functions in the <strong>dplyr</strong> R package <span class="citation" data-cites="dplyr">(<a href="references.html#ref-dplyr" role="doc-biblioref">Wickham et al. 2023a</a>)</span>.</p>
<p><strong>Empirical logit for groups of a categorical variable</strong></p>
<p>The code below produces the empirical logit for being comfortable with driverless cars for each level of <code>tech_easy</code>, opinion on whether technology makes life easier.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-6"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-6-1" class="code-annotation-target"><a href="#annotated-cell-6-1" aria-hidden="true" tabindex="-1"></a>gss24_ai <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-6-2" class="code-annotation-target"><a href="#annotated-cell-6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tech_easy) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-6-3" class="code-annotation-target"><a href="#annotated-cell-6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(aidrive_comfort) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-6" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-6-4" class="code-annotation-target"><a href="#annotated-cell-6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n),</span>
<span id="annotated-cell-6-5"><a href="#annotated-cell-6-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">empirical_logit =</span> <span class="fu">log</span>(probability<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> probability)))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-6" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="1" data-code-annotation="1">Use the <code>gss24_ai</code> data frame.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="2" data-code-annotation="2">Compute all subsequent calculations separately for each level of <code>tech_easy</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="3" data-code-annotation="3">Count the number of observations such that <code>aidrive_comfort == 0</code>, and the number of observations such that <code>aidrive_comfort == 1</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-6" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-6" data-code-lines="4" data-code-annotation="4">Compute the probability that <code>aidrive_comfort == 0</code> and <code>aidrive_comfort == 1</code> .</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
# Groups:   tech_easy [4]
  tech_easy    aidrive_comfort     n probability empirical_logit
  &lt;fct&gt;        &lt;fct&gt;           &lt;int&gt;       &lt;dbl&gt;           &lt;dbl&gt;
1 Neutral      0                 127       0.585           0.344
2 Neutral      1                  90       0.415          -0.344
3 Can't choose 0                  18       0.6             0.405
4 Can't choose 1                  12       0.4            -0.405
5 Agree        0                 495       0.412          -0.355
6 Agree        1                 706       0.588           0.355
# ℹ 2 more rows</code></pre>
</div>
</div>
<p>The code to compute the empirical logit based on a quantitative predictor is the similar, with the additional step of splitting the quantitative predictor into bins. There are many ways to do this in R; here we will show the functions used for the tables in <a href="#sec-logistic-conditions" class="quarto-xref"><span>Section 11.6</span></a>.</p>
<p>The first is using the <code>cut()</code> function that is part of base R. This function transforms numeric variable types into factor variable types by dividing them into bins. The argument <code>breaks =</code> is used to either specify the number of bins or explicitly define the bins. If the number of bins is specified, <code>cut()</code> will divide the observations into bins of equal length, as shown in the code below.</p>
<p>Once the bins are defined, the remainder of the code is the same as before, where the probability and empirical logit are computed for each bin. Here is the code to compute the empirical logit of comfort with driverless cars by age, where age is divided into 10 bins. Here, the <code>cut()</code> function divided the age into bins of length 7.</p>
<p>Note that the option <code>dig.lab = 0</code> in the <code>cut()</code> function means to display the bin thresholds as integers, i.e., with 0 digits. This only changes how the lower and upper bounds are displayed; it does not change any computations.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>gss24_ai <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_bins =</span> <span class="fu">cut</span>(age, <span class="at">breaks =</span> <span class="dv">10</span>, <span class="at">dig.lab =</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_bins) <span class="sc">|&gt;</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(aidrive_comfort) <span class="sc">|&gt;</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">empirical_logit =</span> <span class="fu">log</span>(probability<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> probability))) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 20 × 5
# Groups:   age_bins [10]
  age_bins aidrive_comfort     n probability empirical_logit
  &lt;fct&gt;    &lt;fct&gt;           &lt;int&gt;       &lt;dbl&gt;           &lt;dbl&gt;
1 (18,25]  0                  44       0.333          -0.693
2 (18,25]  1                  88       0.667           0.693
3 (25,32]  0                  54       0.358          -0.586
4 (25,32]  1                  97       0.642           0.586
5 (32,39]  0                  79       0.382          -0.483
6 (32,39]  1                 128       0.618           0.483
# ℹ 14 more rows</code></pre>
</div>
</div>
<p>Another option for splitting the quantitative variable into bins is to do, such that each bin has an approximately equal number of observations. To do so, we can use the <code>cut2()</code> function from them <strong>Hmisc</strong> R package <span class="citation" data-cites="Hmisc">(<a href="references.html#ref-Hmisc" role="doc-biblioref">Harrell Jr 2025</a>)</span>. The number of bins is specified in the <code>g =</code> argument, and the function will divide the observations into the number of specified bins, such that each bin has an approximately equal number of observations.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>gss24_ai <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_bins =</span> <span class="fu">cut2</span>(age, <span class="at">g =</span> <span class="dv">10</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_bins) <span class="sc">|&gt;</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(aidrive_comfort) <span class="sc">|&gt;</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">probability =</span> n <span class="sc">/</span> <span class="fu">sum</span>(n)) <span class="sc">|&gt;</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">empirical_logit =</span> <span class="fu">log</span>(probability<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> probability))) <span class="sc">|&gt;</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(aidrive_comfort <span class="sc">==</span> <span class="dv">1</span>) </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 5
# Groups:   age_bins [10]
  age_bins aidrive_comfort     n probability empirical_logit
  &lt;fct&gt;    &lt;fct&gt;           &lt;int&gt;       &lt;dbl&gt;           &lt;dbl&gt;
1 [18,27)  1                 107       0.677          0.741 
2 [27,34)  1                  98       0.636          0.560 
3 [34,40)  1                 108       0.607          0.434 
4 [40,45)  1                  82       0.582          0.329 
5 [45,50)  1                  77       0.575          0.301 
6 [50,57)  1                  77       0.490         -0.0382
# ℹ 4 more rows</code></pre>
</div>
</div>
<p>We see the bins are more evenly distributed than using the previous method, but there is not an equal number in each bin. This is because the data set is imbalanced, as there are many more respondents in the data who are 18 - 27 years old versus 75 years and older. We can try different values for <code>g =</code> (minimum of 5), if we wish to make the bins more evenly distributed.</p>
<p>The plot of the empirical logit versus a quantitative predictor has the mean value within each bin on the <span class="math inline">\(x\)</span>-axis and the empirical logit for the bin on the <span class="math inline">\(y\)</span>-axis. In the code below, we use the <code>summarise()</code> function in the <strong>dplyr</strong> R package <span class="citation" data-cites="dplyr-2">(<a href="references.html#ref-dplyr-2" role="doc-biblioref">Wickham et al. 2023b</a>)</span> to compute the mean age within each bin. We then join the mean ages to the empirical logit data computed above <!--# can you cross reference a code chunk?--> (saved as the object <code>emplogit_age</code>), and use the combined data to create the scatterplot.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># compute mean age for each bin</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>mean_age  <span class="ot">&lt;-</span> gss24_ai <span class="sc">|&gt;</span> </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">age_bins =</span> <span class="fu">cut</span>(age, <span class="at">breaks =</span> <span class="dv">10</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(age_bins) <span class="sc">|&gt;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_age =</span> <span class="fu">mean</span>(age))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="co"># join the mean ages and create scatterplot</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>emplogit_age <span class="sc">|&gt;</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(mean_age, <span class="at">by =</span> <span class="st">"age_bins"</span>) <span class="sc">|&gt;</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> mean_age, <span class="at">y =</span> empirical_logit)) <span class="sc">+</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean age"</span>, </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Empirical logit of (aidrive_comfort = 1)"</span>) <span class="sc">+</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="11-logistic_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="11-logistic_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>The <strong>Stat2Data</strong> R package <span class="citation" data-cites="Stat2Data">(<a href="references.html#ref-Stat2Data" role="doc-biblioref">Cannon et al. 2019</a>)</span> has built-in functions for making empirical logit plot utilizing the base R plotting functions (instead of <strong>ggplot2</strong>).</p>
<p>The <code>emplogitplot1()</code> function is used to create the empirical logit plot for the response versus a quantitative predictor variable. The argument <code>ngroups =</code> specifies the number of bins. The bins can be explicitly defined using the <code>breaks=</code> argument instead of <code>ngroups</code>.</p>
<p>The code for the empirical logit plot versus age using 10 bins is below.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">emplogitplot1</span>(aidrive_comfort <span class="sc">~</span> age, <span class="at">data =</span> gss24_ai, <span class="at">ngroups =</span> <span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="11-logistic_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="11-logistic_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>We can include the argument <code>out = TRUE</code> save the underlying data used to make the plot. Additionally, the argument <code>showplot = FALSE</code> will suppress the plot, if we are only interested in the underlying data.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>emplogit_age_data <span class="ot">&lt;-</span> <span class="fu">emplogitplot1</span>(aidrive_comfort <span class="sc">~</span> age, <span class="at">data =</span> gss24_ai, </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">ngroups =</span> <span class="dv">10</span>, <span class="at">out =</span> <span class="cn">TRUE</span>, <span class="at">showplot =</span> <span class="cn">FALSE</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>emplogit_age_data</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Group Cases XMin XMax XMean NumYes  Prop AdjProp  Logit
1      1   158   18   26  22.8    107 0.677   0.676  0.735
2      2   154   27   33  30.2     98 0.636   0.635  0.554
3      3   178   34   39  36.6    108 0.607   0.606  0.431
4      4   141   40   44  42.2     82 0.582   0.581  0.327
5      5   134   45   49  47.1     77 0.575   0.574  0.298
6      6   157   50   56  53.3     77 0.490   0.491 -0.036
7      7   153   57   62  59.5     67 0.438   0.438 -0.249
8      8   163   63   68  65.5     76 0.466   0.466 -0.136
9      9   143   69   74  71.3     66 0.462   0.462 -0.152
10    10   140   75   89  80.2     71 0.507   0.507  0.028</code></pre>
</div>
</div>
<p>As we see from the output of underlying data, <code>emplogitplot1()</code> divides the quantitative variable into bins, such that the observations are approximately evenly distributed across bins. The result is very similar to the result from creating bins using <code>cut2()</code>. The underlying data in <code>emplogit_age_data</code> can be used to make the graph using the <strong>ggplot2</strong> functions, as shown below.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(emplogit_age_data, <span class="fu">aes</span>(<span class="at">x =</span> XMean, <span class="at">y =</span> Logit )) <span class="sc">+</span> </span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Mean age"</span>, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Empirical logit of (aidrive_comfort = 1)"</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="11-logistic_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="11-logistic_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="summary" class="level2" data-number="11.8">
<h2 data-number="11.8" class="anchored" data-anchor-id="summary"><span class="header-section-number">11.8</span> Summary</h2>
<p>In this chapter we introduced logistic regression for data with a binary categorical response variable. We used probabilities and odds to describe the distribution of the response variable, and we used odds ratios to understand the relationship between the response and predictor variables. We introduced the form of the logistic regression model and interpreted the model coefficients in terms of the logit and odds. We used simulation-based and theory-based methods to draw conclusions about individual coefficients, and used model conditions to evaluate whether the assumptions for logistic regression hold in the data. We concluded by showing these elements of logistic regression analysis in R.</p>
<p>In <a href="12-logistic-prediction.html" class="quarto-xref"><span>Chapter 12</span></a>, we will continue with logistic regression models and show how these models are used for prediction and classification. We will also present statistics to evaluate model fit and conduct model selection.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Stat2Data" class="csl-entry" role="listitem">
Cannon, Ann, George Cobb, Bradley Hartlaub, Julie Legler, Robin Lock, Thomas Moore, Allan Rossman, and Jeffrey Witmer. 2019. <span>“Stat2Data: Datasets for Stat2.”</span> <a href="https://doi.org/10.32614/CRAN.package.Stat2Data">https://doi.org/10.32614/CRAN.package.Stat2Data</a>.
</div>
<div id="ref-gss2024" class="csl-entry" role="listitem">
Davern, Michael, Rene Bautista, Jeremy Freese, Pamela Herd, and Stephen L. Morgan. 2025. <span>“General Social Survey 1972–2024.”</span> NORC at the University of Chicago; [Machine-readable data file]. <a href="https://gss.norc.org/content/dam/gss/get-documentation/pdf/codebook/GSS%202024%20Codebook.pdf">https://gss.norc.org/content/dam/gss/get-documentation/pdf/codebook/GSS%202024%20Codebook.pdf</a>.
</div>
<div id="ref-Hmisc" class="csl-entry" role="listitem">
Harrell Jr, Frank E. 2025. <span>“Hmisc: Harrell Miscellaneous.”</span> <a href="https://doi.org/10.32614/CRAN.package.Hmisc">https://doi.org/10.32614/CRAN.package.Hmisc</a>.
</div>
<div id="ref-gssr" class="csl-entry" role="listitem">
Healy, Kieran. 2023. <span>“Gssr: General Social Survey Data for Use in r.”</span> <a href="http://kjhealy.github.io/gssr">http://kjhealy.github.io/gssr</a>.
</div>
<div id="ref-Liedtke2025Zoox" class="csl-entry" role="listitem">
Liedtke, Michael. 2025. <span>“Amazon’s Zoox Launches Its Robotaxi Service in Las Vegas.”</span> <em>AP News</em>. <a href="https://apnews.com/article/amazon-zoox-robotaxis-las-vegas-bd5cb24602fb16243efcba05c7fe518f">https://apnews.com/article/amazon-zoox-robotaxis-las-vegas-bd5cb24602fb16243efcba05c7fe518f</a>.
</div>
<div id="ref-Maxmen2018SelfDrivingCarEthics" class="csl-entry" role="listitem">
Maxmen, Amy. 2018. <span>“Self-Driving Car Dilemmas Reveal That Moral Choices Are Not Universal.”</span> <em>Nature</em> 562: 469–70. <a href="https://doi.org/10.1038/d41586-018-07135-0">https://doi.org/10.1038/d41586-018-07135-0</a>.
</div>
<div id="ref-Vemoori2024EthicalDilemmasForbes" class="csl-entry" role="listitem">
Vemoori, Vamsi. 2024. <span>“Navigating the Ethical Dilemmas of Self-Driving Cars: Who Decides When Safety Is at Risk?”</span> <em>Forbes</em>, October. <a href="https://www.forbes.com/councils/forbestechcouncil/2024/10/23/navigating-the-ethical-dilemmas-of-self-driving-cars-who-decides-when-safety-is-at-risk/">https://www.forbes.com/councils/forbestechcouncil/2024/10/23/navigating-the-ethical-dilemmas-of-self-driving-cars-who-decides-when-safety-is-at-risk/</a>.
</div>
<div id="ref-wald1943tests" class="csl-entry" role="listitem">
Wald, Abraham. 1943. <span>“Tests of Statistical Hypotheses Concerning Several Parameters When the Number of Observations Is Large.”</span> <em>Transactions of the American Mathematical Society</em> 54 (3): 426–82.
</div>
<div id="ref-White2025HesaiSensors" class="csl-entry" role="listitem">
White, Edward. 2025. <span>“Top Sensor Maker Hesai Warns World Not Ready for Fully Driverless Cars.”</span> <em>Financial Times</em>, September. <a href="https://www.ft.com/content/1cea9526-17a8-4554-a660-1c1e6d69676b">https://www.ft.com/content/1cea9526-17a8-4554-a660-1c1e6d69676b</a>.
</div>
<div id="ref-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, Kirill Müller, and Davis Vaughan. 2023a. <span>“Dplyr: A Grammar of Data Manipulation.”</span> <a href="https://doi.org/10.32614/CRAN.package.dplyr">https://doi.org/10.32614/CRAN.package.dplyr</a>.
</div>
<div id="ref-dplyr-2" class="csl-entry" role="listitem">
———. 2023b. <span>“Dplyr: A Grammar of Data Manipulation.”</span> <a href="https://doi.org/10.32614/CRAN.package.dplyr">https://doi.org/10.32614/CRAN.package.dplyr</a>.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>There does appear to be some relationship. A higher proportion of those who agree technology makes life easier have comfort with driverless cars.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p><span class="math inline">\(Pr(Y = 1) = 829 / (692 + 829) = 0.545\)</span></p>
<p><span class="math inline">\(\text{odds}(Y=1) = 0.545 / (1 - 0.545)  \approx 1.2\)</span></p>
<p>Note results differ slightly due to rounding.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p><span class="math inline">\(Pr(Y=1 | \text{tech\_easy = Agree}) = 706/ (495 + 706) = 0.588\)</span> and <span class="math inline">\(\text{odds}(Y=1 | \text{tech\_easy = Agree)} = 0.588/(1 - 0.588) = 706/495 = 1.43\)</span><a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The odds ratio is <span class="math inline">\(\frac{706/495}{21/52} = 3.53\)</span> . This means that the odds a respondent who agrees technology makes life easier is comfortable with driverless cars are 3.53 times the odds a respondent who is disagrees that technology is making life easier is comfortable with driverless cars.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>The baseline level is <code>Neutral</code> . It is the only level that is not in the model output.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>The log odds a respondent who disagrees technology makes life easier is comfortable with driverless cars are expected to be 0.499 less than the log odds of a respondent who is neutral about whether technology makes life easier, holding age constant.</p>
<p>The odds a respondent who disagrees technology makes life easier is comfortable with driverless cars are expected to be 0.607 (<span class="math inline">\(e^{-0.499}\)</span>) times the odds of a respondent who is neutral about whether technology makes life easier, holding age constant.<br>
<br>
Alternatively, we could write this in terms of an odds ratio greater than 1: The odds a respondent is neutral about whether technology makes life easier is comfortable with driverless cars are expected to be 1.647 (<span class="math inline">\(1/e^{-0.499}\)</span>) times the odds of a respondent who disagrees that technology makes life easier, holding age constant.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>When age increases by 5, the log odds are expected to decrease by 0.075 (<span class="math inline">\(-0.015 \times 5\)</span> ) . The odds are expected to multiply by 0.928 ( <span class="math inline">\(e^{-0.015 \times 5}\)</span>).<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Note the difference the result here and the model output is because the model output is computed using exact values of <span class="math inline">\(\hat{\beta}_j\)</span> and <span class="math inline">\(SE_{\hat{\beta}_j}\)</span>.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>We are 95% confident that for each additional year in age, the odds of being comfortable with driverless cars are expected to multiply by 0.979 ( <span class="math inline">\(e^{-0.021}\)</span> ) to 0.991 ( <span class="math inline">\(e^{-0.009}\)</span>), holding opinions about technology constant. This interval is equal to the interval obtained using bootstrapping.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><ul>
<li>The test statistic is <span class="math inline">\(\frac{-0.499 - 0}{0.295} \approx - 1.69\)</span>. The estimated coefficient of -0.499 is 1.69 standard errors below the hypothesized mean of 0. The p-value 0.091 &gt; 0.05, so the data do not provide sufficient evidence the odds are different for those who disagree that technology makes life easier versus those who are neutral, after adjusting for age. The 95% confidence interval is computed as <span class="math inline">\(-0.499 \pm 1.96 \times 0.295\)</span>. It is consistent with the conclusion, because 0 is in the interval.<br>
</li>
</ul>
<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/introregressio\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./10-model-eval.html" class="pagination-link" aria-label="Model selection">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model selection</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./12-logistic-prediction.html" class="pagination-link" aria-label="Logistic regression: Prediction and evaluation">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Logistic regression: Prediction and evaluation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/matackett/regression-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>