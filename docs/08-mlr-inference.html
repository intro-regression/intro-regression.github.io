<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Maria Tackett">
<title>8&nbsp; Inference for multiple linear regression – Introduction to Regression Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./09-mlr-transformations.html" rel="next">
<link href="./07-mlr.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-31c3c5ec0f84e3846e28bd1517aa8340.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="https://matackett.github.io/regression-book/" src="https://plausible.io/js/script.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-mlr.html">Part 3: Multiple linear regression</a></li><li class="breadcrumb-item"><a href="./08-mlr-inference.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for multiple linear regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Regression Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/matackett/regression-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 1: Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Regression in the data science workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-review-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data analysis in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 2: Simple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-slr-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-slr-conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model conditions and diagnostics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 3: Multiple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mlr-inference.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-mlr-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Variable transformations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-model-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model selection</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 4: Beyond linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-logistic-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Logistic regression: Prediction and evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-special-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Special topics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Mathematics of linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Mathematics of logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data sets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">Learning goals</a></li>
  <li><a href="#sec-mlr-inf-intro" id="toc-sec-mlr-inf-intro" class="nav-link" data-scroll-target="#sec-mlr-inf-intro"><span class="header-section-number">8.1</span> Introduction: Inference for lemurs</a></li>
  <li><a href="#recap-overview-of-statistical-inference" id="toc-recap-overview-of-statistical-inference" class="nav-link" data-scroll-target="#recap-overview-of-statistical-inference"><span class="header-section-number">8.2</span> Recap: Overview of statistical inference</a></li>
  <li>
<a href="#sec-mlr-sim-inf" id="toc-sec-mlr-sim-inf" class="nav-link" data-scroll-target="#sec-mlr-sim-inf"><span class="header-section-number">8.3</span> Simulation-based inference</a>
  <ul class="collapse">
<li><a href="#sec-mlr-bootstrap-ci" id="toc-sec-mlr-bootstrap-ci" class="nav-link" data-scroll-target="#sec-mlr-bootstrap-ci"><span class="header-section-number">8.3.1</span> Bootstrap confidence intervals</a></li>
  <li><a href="#sec-mlr-permutation" id="toc-sec-mlr-permutation" class="nav-link" data-scroll-target="#sec-mlr-permutation"><span class="header-section-number">8.3.2</span> Permutation tests</a></li>
  </ul>
</li>
  <li>
<a href="#sec-mlr-theory-inf" id="toc-sec-mlr-theory-inf" class="nav-link" data-scroll-target="#sec-mlr-theory-inf"><span class="header-section-number">8.4</span> Theory-based inference</a>
  <ul class="collapse">
<li><a href="#sec-mlr-inf-foundation" id="toc-sec-mlr-inf-foundation" class="nav-link" data-scroll-target="#sec-mlr-inf-foundation"><span class="header-section-number">8.4.1</span> Foundations for inference</a></li>
  <li><a href="#sec-mlr-hypothesis-test" id="toc-sec-mlr-hypothesis-test" class="nav-link" data-scroll-target="#sec-mlr-hypothesis-test"><span class="header-section-number">8.4.2</span> Hypothesis tests</a></li>
  <li><a href="#confidence-intervals" id="toc-confidence-intervals" class="nav-link" data-scroll-target="#confidence-intervals"><span class="header-section-number">8.4.3</span> Confidence intervals</a></li>
  </ul>
</li>
  <li>
<a href="#sec-mlr-conditions-diagnositics" id="toc-sec-mlr-conditions-diagnositics" class="nav-link" data-scroll-target="#sec-mlr-conditions-diagnositics"><span class="header-section-number">8.5</span> Model conditions and diagnostics</a>
  <ul class="collapse">
<li><a href="#model-conditions" id="toc-model-conditions" class="nav-link" data-scroll-target="#model-conditions"><span class="header-section-number">8.5.1</span> Model conditions</a></li>
  <li><a href="#model-diagnostics" id="toc-model-diagnostics" class="nav-link" data-scroll-target="#model-diagnostics"><span class="header-section-number">8.5.2</span> Model diagnostics</a></li>
  <li><a href="#sec-mlr-multicollinearity" id="toc-sec-mlr-multicollinearity" class="nav-link" data-scroll-target="#sec-mlr-multicollinearity"><span class="header-section-number">8.5.3</span> Multicollinearity</a></li>
  </ul>
</li>
  <li>
<a href="#inference-for-multiple-linear-regression-in-r" id="toc-inference-for-multiple-linear-regression-in-r" class="nav-link" data-scroll-target="#inference-for-multiple-linear-regression-in-r"><span class="header-section-number">8.6</span> Inference for multiple linear regression in R</a>
  <ul class="collapse">
<li><a href="#sec-mlr-sim-inf-R" id="toc-sec-mlr-sim-inf-R" class="nav-link" data-scroll-target="#sec-mlr-sim-inf-R"><span class="header-section-number">8.6.1</span> Simulation-based inference in R</a></li>
  <li><a href="#theory-based-inference-in-r" id="toc-theory-based-inference-in-r" class="nav-link" data-scroll-target="#theory-based-inference-in-r"><span class="header-section-number">8.6.2</span> Theory-based inference in R</a></li>
  <li><a href="#model-conditions-and-diagnostics" id="toc-model-conditions-and-diagnostics" class="nav-link" data-scroll-target="#model-conditions-and-diagnostics"><span class="header-section-number">8.6.3</span> Model conditions and diagnostics</a></li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">8.7</span> Summary</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/matackett/regression-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-mlr.html">Part 3: Multiple linear regression</a></li><li class="breadcrumb-item"><a href="./08-mlr-inference.html"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for multiple linear regression</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-ch-mlr-inf" class="quarto-section-identifier"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for multiple linear regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="learning-goals" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="learning-goals">Learning goals</h2>
<ul>
<li>Explain how statistical inference is used to draw conclusions about coefficients in multiple linear regression</li>
<li>Conduct inference using simulation-based methods</li>
<li>Conduct inference using mathematical models based on the Central Limit Theorem</li>
<li>Interpret results from statistical inference in the context of the data</li>
<li>Evaluate model conditions and diagnostics</li>
</ul>
<!--#

## R packages {.unnumbered}

-   `library(tidyverse)` [@tidyverse]

-   `library(tidymodels`) [@tidymodels-2]

-   `library(knitr`) [@knitr]
--></section><section id="sec-mlr-inf-intro" class="level2" data-number="8.1"><h2 data-number="8.1" class="anchored" data-anchor-id="sec-mlr-inf-intro">
<span class="header-section-number">8.1</span> Introduction: Inference for lemurs</h2>
<p>In <a href="07-mlr.html" class="quarto-xref"><span>Chapter 7</span></a>, we introduced the data set <code>lemurs-sample-young.csv</code> that includes the weight and other characteristics of young lemurs (24 months old or younger) living in the Duke Lemur Center. We will continue analyzing the data set here as we use statistical inference to draw conclusions about the relationships between various characteristics and weight. The analysis focuses on the variables below. See <a href="07-mlr.html#sec-lemurs-intro" class="quarto-xref"><span>Section 7.1</span></a> for exploratory data analysis.</p>
<ul>
<li>
<code>weight</code>: Weight of the lemur (in grams)</li>
<li>
<code>taxon</code> : Code made as a combination of the lemur’s genus and species. Note that the genus is a broader categorization that includes lemurs from multiple species. <!--# is this note helpful or confusing?--> This analysis focuses on the following taxon:
<ul>
<li><p><code>ERUF</code>: Eulemur rufus, commonly known as Red-fronted brown lemur</p></li>
<li><p><code>PCOQ</code>: Propithecus coquereli, commonly known as Coquerel’s sifaka</p></li>
<li><p><code>VRUB</code>: Varecia rubra, commonly known as Red ruffed lemur</p></li>
</ul>
</li>
<li>
<code>sex</code> : Sex of lemur (<code>M</code>: Male, <code>F</code>: Female)</li>
<li>
<code>age</code>: Age of lemur when weight was recorded (in months)</li>
<li>
<code>litter_size</code>: Total number of lemurs the litter the lemur was born into</li>
</ul>
<p>The multiple linear regression model using taxon, age, sex, and litter size, to explain variability in the weight of young lemurs is in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a>.</p>
<div class="cell">
<div id="tbl-lemur-model-inf" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemur-model-inf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.1: Model to predict weight of young lemurs using various characteristics
</figcaption><div aria-describedby="tbl-lemur-model-inf-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">24.2</td>
<td style="text-align: right;">93.63</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">0.796</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">136.9</td>
<td style="text-align: right;">4.86</td>
<td style="text-align: right;">28.182</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-88.8</td>
<td style="text-align: right;">68.00</td>
<td style="text-align: right;">-1.306</td>
<td style="text-align: right;">0.193</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">471.7</td>
<td style="text-align: right;">95.43</td>
<td style="text-align: right;">4.943</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1037.3</td>
<td style="text-align: right;">133.91</td>
<td style="text-align: right;">7.747</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">-19.6</td>
<td style="text-align: right;">65.80</td>
<td style="text-align: right;">-0.298</td>
<td style="text-align: right;">0.766</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The interpretations of the coefficients for the model in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a> describe the exact relationship between the response and each predictor for the 252 young lemurs in the sample (see <a href="07-mlr.html#sec-mlr-interpret" class="quarto-xref"><span>Section 7.4</span></a>). In practice, the analysis objective is not to just understand the observations in our sample, but instead use the sample to draw conclusions about a broader population. We do so using <strong>statistical inference</strong>.</p>
<div class="objective">
<p>Use statistical inference to answer the following:</p>
<ol type="1">
<li>Is age a useful predictor of weight, after accounting for sex, taxon, and number of lemurs in the litter?</li>
<li>After taking into account sex, taxon, and number of lemurs in the litter, about how much does a young lemur’s weight increase, on average, as they get older?</li>
</ol>
</div>
<!--# Removed this your turn Write two questions about the relationship between taxon and weight that can be answered by doing statistical using the model in @tbl-lemur-model-inf.-->
<p>For the remainder of the chapter, we will build on the concepts introduced in <a href="05-slr-inference.html" class="quarto-xref"><span>Chapter 5</span></a> as we discuss statistical inference for multiple linear regression. We will also build on the model conditions and diagnostics from <a href="06-slr-conditions.html" class="quarto-xref"><span>Chapter 6</span></a> and show how they apply in the context of multiple linear regression.</p>
</section><section id="recap-overview-of-statistical-inference" class="level2" data-number="8.2"><h2 data-number="8.2" class="anchored" data-anchor-id="recap-overview-of-statistical-inference">
<span class="header-section-number">8.2</span> Recap: Overview of statistical inference</h2>
<p>Here we will do a brief review of the general ideas and methods for statistical inference. A more detailed discussion of these ideas is in <a href="05-slr-inference.html" class="quarto-xref"><span>Chapter 5</span></a>.</p>
<p>The objective of statistical inference to use the sample data to draw conclusions about the population of interest. In the context of linear regression, this means using the sample data to draw conclusions about the relationship between the response variable and the predictors. This done through one of two inferential procedures:</p>
<ul>
<li><p><strong>Hypothesis tests</strong>: Test a claim about a population coefficient</p></li>
<li><p><strong>Confidence intervals</strong>: A range of values that the population-level coefficient may reasonably take</p></li>
</ul>
<!--# check that the wording matches the slr inf chapter--><div class="yourturn">
<p>Recall the inference questions introduced in <a href="#sec-mlr-inf-intro" class="quarto-xref"><span>Section 8.1</span></a>:</p>
<ol type="1">
<li>Is age a useful predictor of weight, after accounting for sex, taxon, and number of lemurs in the litter?</li>
<li>After taking into account sex, taxon, and number of lemurs in the litter, about how much does a young lemur’s weight increase, on average, as they get older?</li>
</ol>
<p>Can we answer the question using a confidence interval, hypothesis test, or both?<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</div>
<p>We are using the results from a single sample to draw conclusions about the population. If we were to take another random sample of 252 young lemurs and fit a model using <code>sex</code>, <code>age</code>, <code>taxon</code>, and <code>litter_size</code> to explain variability in <code>weight</code>, we would expect the model coefficient of <code>age</code>, for example, to be similar but not exactly the same as the coefficient in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a>. If we repeat this process many times, we will have a distribution of the coefficient of age, and we can use this distribution to understand the sample-to-sample variability in the estimated coefficients of age, called the sampling variability <!--# maybe add reference or callout or something to vocab-->. This is true for the other predictors as well.</p>
<p>It is not feasible (or sometimes even possible) to take repeated samples from the population. Thus, we rely on methods to quantify the sampling variability in the estimated coefficients. This variability can be quantified in two ways:</p>
<ul>
<li><p><strong>Simulation-based methods</strong>: Quantify the sampling variability by generating a sampling distribution directly from the data</p></li>
<li><p><strong>Theory-based methods:</strong> Quantify the sampling variability using mathematical models based on the Central Limit Theorem</p></li>
</ul>
<!--# make sure the language matches the inference chapter --><p>The concepts and general steps to conduct inference is the same in multiple linear regression as in simple linear regression. Therefore, much of what we see in the following sections will overlap with <a href="05-slr-inference.html" class="quarto-xref"><span>Chapter 5</span></a>. The primary difference is that now we are drawing conclusions about a model coefficient for a given predictor, after taking into account the other predictors in the model. Thus, we expect the sampling variability for a coefficient to be different in the multiple linear regression model compared to the simple linear regression model.</p>
</section><section id="sec-mlr-sim-inf" class="level2" data-number="8.3"><h2 data-number="8.3" class="anchored" data-anchor-id="sec-mlr-sim-inf">
<span class="header-section-number">8.3</span> Simulation-based inference</h2>
<p>As introduced in <a href="05-slr-inference.html#sec-bootstrap-ci" class="quarto-xref"><span>Section 5.4</span></a>, with simulation-based inference, we use the sample data, instead of mathematical equations, to generate the relevant distributions for confidence intervals and hypothesis tests. This approach can be preferred at times, because it does not rely on as strict adherence to the LINE model conditions (<a href="06-slr-conditions.html" class="quarto-xref"><span>Chapter 6</span></a>), particularly in regards to the equal variance condition. These methods can be computationally intensive, however, so it is up to the data scientist to weigh these advantages and disadvantages when deciding whether to use this approach.</p>
<p>We use two simulation procedures to conduct statistical inference for a population coefficient - bootstrapping for confidence intervals and permutation for hypothesis tests. Here we will show these methods in the context of multiple linear regression. See <a href="05-slr-inference.html#sec-bootstrap-ci" class="quarto-xref"><span>Section 5.4</span></a> and <a href="05-slr-inference.html#sec-slr-testing-sim" class="quarto-xref"><span>Section 5.6</span></a> for a detailed introduction to these procedures.</p>
<section id="sec-mlr-bootstrap-ci" class="level3" data-number="8.3.1"><h3 data-number="8.3.1" class="anchored" data-anchor-id="sec-mlr-bootstrap-ci">
<span class="header-section-number">8.3.1</span> Bootstrap confidence intervals</h3>
<p>Let <span class="math inline">\(\beta_j\)</span> be the population coefficient for the predictor <span class="math inline">\(X_j\)</span>. The estimated coefficient <span class="math inline">\(\hat{\beta}_j\)</span> is the “best guess” for the value of <span class="math inline">\(\beta_j\)</span>; however, we do not expect that <span class="math inline">\(\hat{\beta}_j\)</span> is exactly equal to <span class="math inline">\(\beta_j\)</span>. In fact, if we take another sample of the same size and fit a model of the same form, we will likely get a different (and hopefully close) estimate of the coefficient. Therefore, instead of relying solely on <span class="math inline">\(\hat{\beta}_j\)</span> to tell us something about the true population coefficient, we compute a confidence interval, a range of values that is reasonable for <span class="math inline">\(\beta_j\)</span> to take based on our data <!--# i need to work on this wording--> This confidence interval is found based on the sampling distribution constructed by bootstrap sampling.</p>
<p>Let’s use a bootstrap confidence interval to answer the following question posed in <a href="#sec-mlr-inf-intro" class="quarto-xref"><span>Section 8.1</span></a>:</p>
<blockquote class="blockquote">
<p>After taking into account sex, taxon, and number of lemurs in the litter, about how much does a young lemur’s weight increase, on average, as they get older?</p>
</blockquote>
<p>The question focuses on the predictor <code>age</code>, so we are computing the confidence interval for the coefficient of age, <span class="math inline">\(\beta_{age}\)</span>. Note that the question states “after taking into account sex, taxon, and number of lemurs.” This means that we want to compute the confidence interval for the coefficient of <code>age</code> given a model of the form in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a>.</p>
<p>Bootstrapping is the process of sampling, with replacement, to generate a new sample the same size as the observed data. For the analysis of weights for young lemurs, each bootstrap sample will have 252 observations. When obtaining the bootstrap sample, each observation remains in tact. This means the values of the response and predictor variable for an individual lemur in the bootstrap sample are the same as the combination of values for a lemur in the original sample.</p>
<p>We will use 1000 bootstrap samples in this analysis. <!--# need a reference on this. what is a good number? Is it consistent with slr inf chapter?--> <a href="#tbl-mlr-inf-bootstrap" class="quarto-xref">Table&nbsp;<span>8.2</span></a> shows five observations from the first and last bootstrap samples. <!--# add a row of vertical dots between the replicates--> The column <code>replicate</code> indicates the bootstrap sample.</p>
<div class="cell">
<div id="tbl-mlr-inf-bootstrap" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mlr-inf-bootstrap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.2: Five observations from the first and last bootstrap samples
</figcaption><div aria-describedby="tbl-mlr-inf-bootstrap-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">replicate</th>
<th style="text-align: right;">weight</th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">sex</th>
<th style="text-align: left;">taxon</th>
<th style="text-align: right;">litter_size</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3340</td>
<td style="text-align: right;">20.52</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">VRUB</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1580</td>
<td style="text-align: right;">11.54</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3620</td>
<td style="text-align: right;">17.49</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">VRUB</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3390</td>
<td style="text-align: right;">23.64</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">PCOQ</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">212</td>
<td style="text-align: right;">0.82</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">PCOQ</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1000</td>
<td style="text-align: right;">720</td>
<td style="text-align: right;">1.84</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">VRUB</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1000</td>
<td style="text-align: right;">538</td>
<td style="text-align: right;">2.20</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">PCOQ</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1000</td>
<td style="text-align: right;">712</td>
<td style="text-align: right;">3.19</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">PCOQ</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1000</td>
<td style="text-align: right;">350</td>
<td style="text-align: right;">2.30</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">PCOQ</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: right;">1000</td>
<td style="text-align: right;">3300</td>
<td style="text-align: right;">18.35</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">VRUB</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Using bootstrapping, we now have 1000 “new” samples. Next, we fit a model using each bootstrap sample. <a href="#tbl-mlr-inf-bootstrap-coef" class="quarto-xref">Table&nbsp;<span>8.3</span></a> shows the model coefficients for the first five and last five bootstrap samples. <!--# add vertical dots between replicates--></p>
<!--# Removed this your turn: We will use the values of $\hat{\beta}_{age}$ estimated from the bootstrap samples to construct the sampling distribution. How many observations will be in the sampling distribution?-->
<div class="cell">
<div id="tbl-mlr-inf-bootstrap-coef" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mlr-inf-bootstrap-coef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.3: Coefficients from the first five and last five bootstrap samples
</figcaption><div aria-describedby="tbl-mlr-inf-bootstrap-coef-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">replicate</th>
<th style="text-align: right;">intercept</th>
<th style="text-align: right;">age</th>
<th style="text-align: right;">sexM</th>
<th style="text-align: right;">taxonPCOQ</th>
<th style="text-align: right;">taxonVRUB</th>
<th style="text-align: right;">litter_size</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">80.73</td>
<td style="text-align: right;">142</td>
<td style="text-align: right;">-113.6</td>
<td style="text-align: right;">451</td>
<td style="text-align: right;">974</td>
<td style="text-align: right;">-88.896</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: right;">36.99</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">-131.6</td>
<td style="text-align: right;">489</td>
<td style="text-align: right;">891</td>
<td style="text-align: right;">19.288</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: right;">130.63</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">-178.6</td>
<td style="text-align: right;">376</td>
<td style="text-align: right;">960</td>
<td style="text-align: right;">-4.860</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: right;">2.22</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">-52.6</td>
<td style="text-align: right;">452</td>
<td style="text-align: right;">1051</td>
<td style="text-align: right;">-33.453</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: right;">108.07</td>
<td style="text-align: right;">148</td>
<td style="text-align: right;">-198.1</td>
<td style="text-align: right;">361</td>
<td style="text-align: right;">822</td>
<td style="text-align: right;">0.405</td>
</tr>
<tr class="even">
<td style="text-align: right;">996</td>
<td style="text-align: right;">102.65</td>
<td style="text-align: right;">140</td>
<td style="text-align: right;">-65.6</td>
<td style="text-align: right;">368</td>
<td style="text-align: right;">904</td>
<td style="text-align: right;">19.692</td>
</tr>
<tr class="odd">
<td style="text-align: right;">997</td>
<td style="text-align: right;">22.83</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">-114.6</td>
<td style="text-align: right;">475</td>
<td style="text-align: right;">1100</td>
<td style="text-align: right;">-27.400</td>
</tr>
<tr class="even">
<td style="text-align: right;">998</td>
<td style="text-align: right;">-29.93</td>
<td style="text-align: right;">142</td>
<td style="text-align: right;">-41.0</td>
<td style="text-align: right;">420</td>
<td style="text-align: right;">980</td>
<td style="text-align: right;">7.807</td>
</tr>
<tr class="odd">
<td style="text-align: right;">999</td>
<td style="text-align: right;">-159.85</td>
<td style="text-align: right;">149</td>
<td style="text-align: right;">-67.5</td>
<td style="text-align: right;">629</td>
<td style="text-align: right;">1119</td>
<td style="text-align: right;">-29.045</td>
</tr>
<tr class="even">
<td style="text-align: right;">1000</td>
<td style="text-align: right;">86.17</td>
<td style="text-align: right;">137</td>
<td style="text-align: right;">-121.8</td>
<td style="text-align: right;">423</td>
<td style="text-align: right;">747</td>
<td style="text-align: right;">140.139</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>We include all the original predictors when we fit the model to each bootstrap sample, so we get coefficient estimates for each predictor. Notice within each column that the estimated coefficients for a given predictor are similar but not exactly the same for each bootstrap sample. At this point, we are interested in conducting inference for <code>age</code>, so we will focus on the estimated coefficients for that variable and ignore the others for now.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlr-inf-bootstrap-dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-inf-bootstrap-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-inf-bootstrap-dist-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Figure&nbsp;8.1: Bootstrap sampling distribution for age"><img src="08-mlr-inference_files/figure-html/fig-mlr-inf-bootstrap-dist-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-inf-bootstrap-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.1: Bootstrap sampling distribution for <code>age</code>
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-mlr-inf-bootstrap-dist" class="quarto-xref">Figure&nbsp;<span>8.1</span></a> is the bootstrap sampling distribution for <span class="math inline">\(\hat{\beta}_{age}\)</span>. The mean of the distribution is 136.809 and the standard deviation is 5.97. The mean of the bootstrap distribution is very close to the estimated coefficient of <code>age</code> in the original model in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a>. These values will not be exactly equal, because the bootstrap distribution is constructed from a simulation-based process that itself involves sampling. Given a confidence level <span class="math inline">\(C\)</span>, the <span class="math inline">\(C\%\)</span> confidence interval is the middle <span class="math inline">\(C\%\)</span> of the bootstrap distribution. <span class="math inline">\(C\)</span> is generally set between 90 and 99, to balance accuracy and precision (see <a href="05-slr-inference.html#sec-bootstrap-ci" class="quarto-xref"><span>Section 5.4</span></a>), with 95 being a commonly used default value.</p>
<div class="yourturn">
<p>Explain what 5.97 means in the context of the analysis.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></p>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlr-inf-bootstrap-ci" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-inf-bootstrap-ci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-inf-bootstrap-ci-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Figure&nbsp;8.2: Bootstrap sampling distribution for age with 95% confidence interval"><img src="08-mlr-inference_files/figure-html/fig-mlr-inf-bootstrap-ci-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-inf-bootstrap-ci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.2: Bootstrap sampling distribution for <code>age</code> with 95% confidence interval
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-mlr-inf-bootstrap-ci" class="quarto-xref">Figure&nbsp;<span>8.2</span></a> shows the upper and lower bounds for a 95% confidence interval on the bootstrap sampling distribution. The 95% confidence interval for the <span class="math inline">\(\beta_{age}\)</span>, the coefficient of <code>age</code> is 125.74 to 149.29. Similar to the confidence interval in simple linear regression, we are 95% confident that this interval contains the true coefficient for <code>age</code>. Let’s interpret what this means in terms of the relationship between <code>age</code> and <code>weight</code> for young lemurs.</p>
<blockquote class="blockquote">
<p><em>We are 95% confident that the weight of young lemurs increase between 125.74 and 149.29 grams, on average, for each additional month older, holding taxon, sex, and number of lemurs in the litter constant.</em></p>
</blockquote>
<p>As before, the “confidence” referenced in this statement is the long-run confidence derived from the statistical process used to compute the interval. This means that if we repeat the process outlined in this section thousands of times, and thus have thousands of bootstrap distributions and confidence intervals, then about 95% of the confidence intervals would contain the true coefficient <span class="math inline">\(\beta_{age}\)</span>. Because we don’t know what <span class="math inline">\(\beta_{age}\)</span> is (if we knew <span class="math inline">\(\beta_{age}\)</span>, we wouldn’t need inference!), we cannot state for certain whether the interval we computed is one of the 95% of intervals that contains the true coefficient or the 5% that miss the mark. Thus, we state in the interpretation that we are “95% confident”.</p>
<div class="yourturn">
<p>The 90% bootstrap confidence interval for <code>taxonPCOQ</code> based on the model in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a> is 314.442 to 630.842 . Interpret the interval in the context of the data.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
</div>
<!--# consider adding a visualization here are in chapter 5 to illustrate this-->
</section><section id="sec-mlr-permutation" class="level3" data-number="8.3.2"><h3 data-number="8.3.2" class="anchored" data-anchor-id="sec-mlr-permutation">
<span class="header-section-number">8.3.2</span> Permutation tests</h3>
<p>Sometimes we wish to evaluate a claim made about the relationship between the response variable and one of the predictors, <span class="math inline">\(X_j\)</span> using a hypothesis test. When conducting hypothesis tests to evaluate such a claim, the null hypothesis is the “baseline” condition of no linear relationship between the response and the predictor variable (<span class="math inline">\(H_0: \beta_j = 0\)</span>) , and the alternative hypothesis is that there is a linear relationship (<span class="math inline">\(H_a: \beta_j \neq 0\)</span>). Hypothesis tests can be used to evaluate other claims as well; however, we will focus on evaluating whether there is a linear relationship, because this is the claim being evaluated in output of most statistical software. See <a href="05-slr-inference.html#sec-hypothesis-test-overview" class="quarto-xref"><span>Section 5.5</span></a> for an introduction to hypothesis tests.</p>
<p><a href="05-slr-inference.html#sec-slr-testing-sim" class="quarto-xref"><span>Section 5.6</span></a> provides an introduction more specifically to permutation tests, so here we will show how to conduct the test for multiple linear regression and answer the question posed in <a href="#sec-mlr-inf-intro" class="quarto-xref"><span>Section 8.1</span></a> :</p>
<blockquote class="blockquote">
<p>Is age a useful predictor of weight, after accounting for sex, taxon, and number of lemurs in the litter?</p>
</blockquote>
<p>We begin by stating the hypotheses in the context of the data:</p>
<ul>
<li>
<strong>Null</strong>: There is no linear relationship between age and weight after accounting for sex, taxon, and number of lemurs in the litter.</li>
<li>
<strong>Alternative</strong>: There is a linear relationship between age and weight after accounting for sex, taxon, and number of lemurs in the litter.</li>
</ul>
<p>The hypotheses in mathematical notation are the following:</p>
<p><span class="math display">\[
H_0: \beta_{age} = 0 \text{ vs. }H_a: \beta_{age} \neq 0
\]</span></p>
<p>In <a href="05-slr-inference.html#sec-hypothesis-test-overview" class="quarto-xref"><span>Section 5.5</span></a>, we explained how hypothesis tests are conducted assuming null hypothesis is true, and the aim is to evaluate the strength of the evidence against the null hypothesis. Therefore, we need to obtain the sampling distribution of <span class="math inline">\(\hat{\beta}_{age}\)</span> under the assumption that there is no linear relationship between age and weight, after accounting for the other predictors in the model. This sampling distribution is the <strong>null distribution</strong>, and we construct it using permutation sampling.</p>
<p>Permutation sampling is the process of shuffling one or more columns of data, to get many new combinations of the data, i.e., “new” samples. In this case, because we are conducting inference for a single predictor <code>age</code>, we will create new samples by shuffling the values of <code>age</code>, so that they are randomly paired with values of weight. We do <u><strong>not</strong></u> shuffle the columns of the other predictors, because we are evaluating the relationship between <code>age</code> and <code>weight</code> after accounting for the relationships between <code>weight</code> and the predictors <code>sex</code>, <code>taxon</code>, and <code>litter_size</code>. By shuffling the columns of <code>age</code>, we are simulating the null condition of no linear relationship between <code>age</code> and <code>weight</code>.</p>
<div class="cell">
<div id="tbl-mlr-inf-permute" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mlr-inf-permute-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.4: First five permutations for an individual lemur
</figcaption><div aria-describedby="tbl-mlr-inf-permute-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">weight</th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">sex</th>
<th style="text-align: left;">taxon</th>
<th style="text-align: right;">litter_size</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Original Sample</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">2.27</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Permutation 1</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">20.52</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Permutation 2</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">13.51</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Permutation 3</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">16.41</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Permutation 4</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">12.20</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Permutation 5</td>
<td style="text-align: right;">410</td>
<td style="text-align: right;">22.06</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<!--# is this table confusing?-->
<p><a href="#tbl-mlr-inf-permute" class="quarto-xref">Table&nbsp;<span>8.4</span></a> shows the values from the original data and values from the first five permutations for an individual lemur. In the table, we see the values for <code>weight</code>, <code>sex</code>, <code>taxon</code>, and <code>litter_size</code> are the same for each permutation. The values of <code>age</code> are randomly shuffled, and there is no linear relationship (or any relationship) between age and weight in the permutation samples.</p>
<p>Like bootstrapping, each permutation sample is the same size as the original data. In contrast to bootstrapping, permutation sampling is merely shuffling the values of a column of data rather than sampling complete observations with replacement. We will use 1000 permutation samples for this analysis. Like bootstrapping, for each permutation sample, we fit the linear regression model and use <span class="math inline">\(\hat{\beta}_{age}\)</span>, the estimated coefficient of age from each permutation sample to create the null distribution.</p>
<div class="yourturn">
<ul>
<li>What is the approximate center of the null distribution of <code>age</code> created from the permutation samples?</li>
<li>How does the standard deviation of the null distribution compare to the standard deviation of the bootstrap distribution?<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</li>
</ul>
</div>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlr-inf-permute-null-dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-inf-permute-null-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-inf-permute-null-dist-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;8.3: Null distribution for age from 1000 permutation samples"><img src="08-mlr-inference_files/figure-html/fig-mlr-inf-permute-null-dist-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-inf-permute-null-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.3: Null distribution for <code>age</code> from 1000 permutation samples
</figcaption></figure>
</div>
</div>
</div>
<!--# make sure histogram colors are consistent with SLR Inf-->
<p><a href="#fig-mlr-inf-permute-null-dist" class="quarto-xref">Figure&nbsp;<span>8.3</span></a> shows the null distribution with the value of <span class="math inline">\(\hat{\beta}_{age}\)</span> observed in the original data marked with the red dotted line. The null distribution is centered around 0, the hypothesized value. The coefficient estimated from the observed data is very far away from the center of the distribution, so the data appears to provide strong evidence against the null hypothesis.</p>
<p>The evidence against the null hypothesis is not always so visually clear, so we compute a p-value to provide a measure for evaluating the evidence against the null hypothesis. Recall that the p-value is the probability of observing results at least as extreme as the results observed from the data, given the null hypothesis is true. In this instance, this means the probability of getting an estimated coefficient of 136.903 or more extreme in a sample of 252 lemurs, given the null hypothesis is true. Because the alternative hypothesis is <span class="math inline">\(\beta_{age} \neq 0\)</span>, “more extreme” is greater than 136.903 and less than -136.903 .</p>
<p>Based on the simulation, the p-value is 0. This means in 1000 permutation samples drawn under the assumption the null hypothesis is true, we did not compute an estimated coefficient for <code>age</code> equal to 136.903 or more extreme. We compare this p-value to a decision-making threshold <span class="math inline">\(\alpha\)</span> (see <a href="05-slr-inference.html#sec-slr-inf-conclusion" class="quarto-xref"><span>Section 5.6.4</span></a>) to draw the conclusion. The p-value of 0 is less than <span class="math inline">\(\alpha\)</span> for any chosen threshold, so we <strong>reject the null hypothesis</strong>. The data provide strong evidence in favor of the alternative hypothesis that there is a linear relationship between age and weight after accounting for sex, taxon, and number of lemurs in the litter.</p>
<div class="analysis_in_practice">
<p>Though the p-value from the simulation-based hypothesis test is equal to 0, the true p-value is very close to but not exactly 0 (but it is still very small!). R will produce a warning like the one below to highlight this.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/07-infer-pval-warning.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Infer warning about reporting p-value of 0."><img src="images/07-infer-pval-warning.png" class="img-fluid quarto-figure quarto-figure-center figure-img" alt="Warning from infer output that says &quot;Please be cautious in reporting a p-value of 0. This result is an approximation based on the number of reps chosen in the generate step. See get_p_value for more information.&quot;"></a></p>
</figure>
</div>
<figcaption>Infer warning about reporting p-value of 0.</figcaption></figure>
</div>
<p>We can report such p-values as “approximately 0” to make clear to the reader that this is an approximation and not an exact result. We can also increase the number of iterations to get a closer approximation of the p-value or use theory-based methods from <a href="#sec-mlr-theory-inf" class="quarto-xref"><span>Section 8.4</span></a> to get the exact p-value.</p>
</div>
<p>Here we used permutation sampling to construct the null distribution for the hypothesis test to evaluate a claim about the relationship between age and weight for young lemurs. Because we conducted a two-sided hypothesis test, we can use the bootstrap confidence interval from <a href="#sec-mlr-bootstrap-ci" class="quarto-xref"><span>Section 8.3.1</span></a> to evaluate this claim as well. The <span class="math inline">\(C\%\)</span> confidence interval corresponds to a test with a decision-making threshold of <span class="math inline">\(\alpha = (1-\frac{C}{100})\)</span>. See <a href="05-slr-inference.html#sec-slr-inf-relationship-ci-test" class="quarto-xref"><span>Section 5.7</span></a> for more detail about the connection between hypothesis test and confidence intervals. <!--# the percent / dividing C by 100 needs to be smoothed out--></p>
<div class="yourturn">
<p>The 95% bootstrap confidence interval for <span class="math inline">\(\beta_{age}\)</span> is 125.74 to 149.29.</p>
<ul>
<li>This interval corresponds to a hypothesis test with what <span class="math inline">\(\alpha\)</span> -level?</li>
<li>Is this interval consistent with the conclusion that there is evidence of a linear relationship between age and weight, after accounting for sex, taxon, and number of lemurs in the litter? Explain. <a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a>
</li>
</ul>
</div>
</section></section><section id="sec-mlr-theory-inf" class="level2" data-number="8.4"><h2 data-number="8.4" class="anchored" data-anchor-id="sec-mlr-theory-inf">
<span class="header-section-number">8.4</span> Theory-based inference</h2>
<p>The other approach for inference is using theory-based methods based on mathematical models and the Central Limit Theorem. Theory-based methods have formulas to quantify the sampling variability in the estimated coefficient and uses distributions to compute exact confidence intervals and p-values. Because these methods rely on formulas rather than resampling methods, they are very computationally efficient. Results from theory-based inferential methods are displayed in the model output from most statistical software. For example, you can see the inferential results we’ll discuss in the model output in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a>.</p>
<p>Theory-based inference for coefficients in a multiple linear regression model is very similar to inference in simple linear regression. Therefore, this section will provide a brief description of these methods, show how they apply to answer the questions in <a href="#sec-mlr-inf-intro" class="quarto-xref"><span>Section 8.1</span></a>, and highlight differences from simple linear regression. See <a href="05-slr-inference.html#sec-slr-inf-clt" class="quarto-xref"><span>Section 5.8</span></a> for a thorough introduction to these methods. The mathematical details utilize linear algebra and are found in <a href="appendix-linear.html#sec-assumptions-matrix" class="quarto-xref"><span>Section A.5</span></a> and <a href="appendix-linear.html#sec-beta-dist-matrix" class="quarto-xref"><span>Section A.6</span></a>.</p>
<section id="sec-mlr-inf-foundation" class="level3" data-number="8.4.1"><h3 data-number="8.4.1" class="anchored" data-anchor-id="sec-mlr-inf-foundation">
<span class="header-section-number">8.4.1</span> Foundations for inference</h3>
<p>When doing multiple linear regression, we assume a model structure of the from in <a href="#eq-mlr-stat-model" class="quarto-xref">Equation&nbsp;<span>8.1</span></a>.</p>
<p><span id="eq-mlr-stat-model"><span class="math display">\[
Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \dots + \beta_pX_p + \epsilon \hspace{8mm} \epsilon \sim N(0, \sigma^2_{\epsilon})
\tag{8.1}\]</span></span></p>
<p>The equation written in terms of the distribution of <span class="math inline">\(Y\)</span> given a combination of predictors <span class="math inline">\(X_1, X_2, \ldots, X_p\)</span> in <a href="#eq-mlr-dist-y" class="quarto-xref">Equation&nbsp;<span>8.2</span></a>.</p>
<p><span id="eq-mlr-dist-y"><span class="math display">\[
Y|X \sim N(\beta_0 + \beta_1X_1 + \beta_2X_2 + \dots + \beta_pX_p, \sigma^2_{\epsilon})
\tag{8.2}\]</span></span></p>
<p>By <a href="#eq-mlr-dist-y" class="quarto-xref">Equation&nbsp;<span>8.2</span></a>, the distribution of the response variable <span class="math inline">\(Y\)</span> given a combination of predictors <span class="math inline">\(X_1, X_2, \ldots, X_p\)</span> is normally distributed, centered at <span class="math inline">\(\beta_0 + \beta_1X_1 + \beta_2X_2 + \dots + \beta_pX_p\)</span> with variance <span class="math inline">\(\sigma^2_{\epsilon}\)</span>. Based on this distribution, the following assumptions are made when we conduct multiple linear regression:</p>
<ol type="1">
<li><p>The distribution of the response <span class="math inline">\(Y\)</span> is normal for a given combination of the predictors<span class="math inline">\(X_1, X_2, \ldots, X_p\)</span>.</p></li>
<li><p>The expected value (mean) of the distribution of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X_1, X_2, \ldots, X_p\)</span> is <span class="math inline">\(\beta_0 + \beta_1 X_1 + \beta_2X_2 + \dots + \beta_pX_p\)</span>. There is a linear relationship between the response and the predictor variables.</p></li>
<li><p>The variance of the distribution of <span class="math inline">\(Y\)</span> given <span class="math inline">\(X_1, X_2, \ldots, X_p\)</span> is <span class="math inline">\(\sigma^2_{\epsilon}\)</span>. This variance is equal for all combination of predictors <span class="math inline">\(X_1, X_2, \ldots, X_p\)</span> and does not depend on the predictors.</p></li>
<li><p>The error terms <span class="math inline">\(\epsilon\)</span> are independent of one another. This also means the values of the response variable, and the observations more generally, are independent of one another.</p></li>
</ol>
<p>Notice that these assumptions are generally the ones for simple linear regression in <a href="05-slr-inference.html#sec-slr-foundation" class="quarto-xref"><span>Section 5.3</span></a>. The difference is that the assumptions about <span class="math inline">\(Y\)</span> are made for a combination of predictors rather than a single predictor.</p>
<p>In <a href="07-mlr.html" class="quarto-xref"><span>Chapter 7</span></a>, we showed how to compute <span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1, \hat{\beta}_2, \ldots, \hat{\beta}_p\)</span>, the estimated model coefficients. The remaining parameter <span class="math inline">\(\sigma_{\epsilon}\)</span>, called the regression standard error, is the variability of the observations about the regression line. The distance between the observed values and the regression line (the predicted value of <span class="math inline">\(Y\)</span> for a given combination of predictors) is the residual. <a href="#eq-mlr-sigma" class="quarto-xref">Equation&nbsp;<span>8.3</span></a> shows how we use the residuals to estimate the regression standard error.</p>
<p><span id="eq-mlr-sigma"><span class="math display">\[
\hat{\sigma}_{\epsilon} = \sqrt{\frac{\sum_{i=1}^n e_i^2}{n - p -1 }} = \sqrt{\frac{\sum_{i=1}^n (y_i - \hat{y}_i)^2}{n - p -1 }}
\tag{8.3}\]</span></span></p>
<p>This is very similar to <a href="05-slr-inference.html#eq-slr-reg-se" class="quarto-xref">Equation&nbsp;<span>5.8</span></a>, the equation to estimate the regression standard error in simple linear regression. The difference is the denominator, <span class="math inline">\(n - p - 1\)</span>, where <span class="math inline">\(p\)</span> is the number of predictor terms. The value <span class="math inline">\(n - p - 1\)</span> is the degrees of freedom, the number of observations available to understand variability about the regression line. This stems from the fact that we “use” <span class="math inline">\(p+1\)</span> observations to estimate the model coefficients. In simple linear regression, there is one predictor, so <span class="math inline">\(p = 1\)</span>, and the degrees of freedom are <span class="math inline">\(n - 2\)</span> as shown in <a href="05-slr-inference.html#sec-estimate-reg-std-err" class="quarto-xref"><span>Section 5.8.2</span></a>. Let’s compute the degrees of freedom for the regression standard error associated with the model in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a>. There are <span class="math inline">\(n =\)</span> 252 observations in the data and <span class="math inline">\(p = 5\)</span> terms for predictors in the model. (Note that even though <code>taxon</code> is a single predictor, we need to account for the fact there are two terms for <code>taxon</code> estimated in the model). The degrees of freedom are</p>
<p><span class="math display">\[
df = 252 - (5 + 1) = 252 - 5 - 1 = 246
\]</span></p>
<p>Thus, there are 246 degrees of freedom, i.e., observations available to understand variability about the regression line for the lemurs analysis.</p>
<p>The goal is to conduct inference for a model coefficient <span class="math inline">\(\beta_j\)</span>, so we ultimately need to estimate the sampling variability in the estimated coefficients <span class="math inline">\(\hat{\beta}_j\)</span>. This variability is measured by <span class="math inline">\(SE_{\hat{\beta}_j}\)</span>, the standard error of <span class="math inline">\(\hat{\beta}_j\)</span>. The formula to compute <span class="math inline">\(SE_{\hat{\beta}_j}\)</span> in <a href="#eq-mlr-se-beta" class="quarto-xref">Equation&nbsp;<span>8.4</span></a> is more complex than in the case of simple linear regression, because we need to understand the sampling variability of <span class="math inline">\(\hat{\beta}_j\)</span> in the context of a regression model that includes other predictors.</p>
<p><span id="eq-mlr-se-beta"><span class="math display">\[
SE_{\hat{\beta}_j} = j^{th} \text{diagonal element of }\hat{\sigma}_{\epsilon}(\mathbf{X}^\mathsf{T}\mathbf{X})^{-1}
\tag{8.4}\]</span></span></p>
<p>Mathematical details for <a href="#eq-mlr-se-beta" class="quarto-xref">Equation&nbsp;<span>8.4</span></a> are in <a href="appendix-linear.html#sec-beta-dist-matrix" class="quarto-xref"><span>Section A.6</span></a>. For now, we’ll focus on a conceptual understanding about why the standard error computed here may be different than the standard error for the same predictor variable in the case of simple linear regression. To illustrate this, let’s look at the standard error for <code>age</code> in a simple linear regression model and in the model in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a>. The coefficient estimates and standard errors are printed side-by-side in <a href="#tbl-mlr-age-compare" class="quarto-xref">Table&nbsp;<span>8.5</span></a>.</p>
<div id="tbl-mlr-age-compare" class="quarto-layout-panel anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mlr-age-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.5: Comparison of standard error for <code>age</code> in simple and multiple linear regression modelss
</figcaption><div aria-describedby="tbl-mlr-age-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="do-not-create-environment cell caption-top table">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">555</td>
<td style="text-align: right;">67.31</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">142</td>
<td style="text-align: right;">5.88</td>
</tr>
</tbody>
</table>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<table class="do-not-create-environment cell caption-top table">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">24.2</td>
<td style="text-align: right;">93.63</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">136.9</td>
<td style="text-align: right;">4.86</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-88.8</td>
<td style="text-align: right;">68.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">471.7</td>
<td style="text-align: right;">95.43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1037.3</td>
<td style="text-align: right;">133.91</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">-19.6</td>
<td style="text-align: right;">65.80</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</figure>
</div>
<p>The estimated standard error for <code>age</code> in the simple linear regression model is 5.883 compared to 4.858 in the multiple linear regression model. In the case of multiple linear regression, the other predictors in the model are accounted for in two ways when computing <span class="math inline">\(SE_{\hat{\beta}{age}}\)</span> . First the other predictors are accounted for when computing <span class="math inline">\(\hat{\sigma}_\epsilon\)</span>, as they are used to compute the <span class="math inline">\(\hat{y}_i\)</span> in the <a href="#eq-mlr-sigma" class="quarto-xref">Equation&nbsp;<span>8.3</span></a>. Second, the other predictors are accounted for in <span class="math inline">\((\mathbf{X}^\mathsf{T}\mathbf{X})^{-1}\)</span>, as this matrix quantifies any relationship between the predictor variables (see <a href="appendix-linear.html#sec-beta-dist-matrix" class="quarto-xref"><span>Section A.6</span></a> for details). Thus, based on the models in <a href="#tbl-mlr-age-compare" class="quarto-xref">Table&nbsp;<span>8.5</span></a>, there is less sampling variability in <span class="math inline">\(\hat{\beta}_{age}\)</span> after we account for the other potential predictors of weight.</p>
<p>In addition to estimating the sampling variability for model coefficients, by the Central Limit Theorem, we know the full sampling distribution of the model coefficient <span class="math inline">\(\hat{\beta}_j\)</span> is normally distributed, with a mean at the true population coefficient <span class="math inline">\(\beta_j\)</span> and variance <span class="math inline">\(SE_{\hat{\beta}_j}^2\)</span>, the standard error squared as shown in <a href="#eq-mlr-beta-dist" class="quarto-xref">Equation&nbsp;<span>8.5</span></a>. We use this distribution as the basis for conducting hypothesis tests and computing confidence intervals.</p>
<p><span id="eq-mlr-beta-dist"><span class="math display">\[
\hat{\beta}_j \sim N(\beta_j, SE_{\hat{\beta}_j}^2)
\tag{8.5}\]</span></span></p>
<!--# rectify this with SLR - SE squared seems weird, but need to use variance to stay consistent with normal notation. Or maybe change everything to standard deviation? -->
</section><section id="sec-mlr-hypothesis-test" class="level3" data-number="8.4.2"><h3 data-number="8.4.2" class="anchored" data-anchor-id="sec-mlr-hypothesis-test">
<span class="header-section-number">8.4.2</span> Hypothesis tests</h3>
<p>The hypothesis test in multiple linear regression follows the same steps as simple linear regression in <a href="05-slr-inference.html#sec-slr-inf-hypotheses" class="quarto-xref"><span>Section 5.6.1</span></a>:</p>
<ol type="1">
<li>State the null and alternative hypotheses.</li>
<li>Calculate a test statistic.</li>
<li>Calculate a p-value.</li>
<li>Draw a conclusion.</li>
</ol>
<p>Using these steps, we’ll conduct a hypothesis test with decision-making threshold <span class="math inline">\(\alpha = 0.05\)</span>, to answer the question from <a href="#sec-mlr-inf-intro" class="quarto-xref"><span>Section 8.1</span></a>:</p>
<blockquote class="blockquote">
<p>Is age a useful predictor of weight, after accounting for sex, taxon, and number of lemurs in the litter?</p>
</blockquote>
<p><strong>Step 1: State the null and alternative hypotheses.</strong></p>
<p>The null and alternative hypotheses are the same for theory-based inference as they are for simulation-based inference. Thus, the null and alternative hypotheses are the following:</p>
<ul>
<li>
<strong>Null</strong>: There is no linear relationship between age and weight after accounting for sex, taxon, and number of lemurs in the litter.</li>
<li>
<strong>Alternative</strong>: There is a linear relationship between age and weight after accounting for sex, taxon, and number of lemurs in the litter.</li>
</ul>
<p>These hypothesis in mathematical notation are the following:</p>
<p><span class="math display">\[
H_0: \beta_{age} = 0 \text{ vs. }H_a: \beta_{age} \neq 0
\]</span></p>
<p><strong>Step 2: Calculate a test statistic.</strong></p>
<p>We conduct hypothesis testing assuming the null hypothesis is true. Applying this to <a href="#eq-mlr-beta-dist" class="quarto-xref">Equation&nbsp;<span>8.5</span></a>, we assume that <span class="math inline">\(\hat{\beta}_{age} \sim N(0, SE_{\hat{\beta}_{age}})\)</span>. Let’s use this to compute the test statistic, the number of standard errors <span class="math inline">\(\hat{\beta}_{age}\)</span>, the coefficient estimated from the data, is from the hypothesized center of the distribution 0.</p>
<p>The test statistic for <span class="math inline">\(\hat{\beta}_{age}\)</span> is</p>
<p><span class="math display">\[
T = \frac{\hat{\beta}_j - 0}{SE_{\hat{\beta}_j}} = \frac{136.903 - 0}{4.858} = 28.181
\]</span></p>
<p>This means that given the null hypothesis is true (<span class="math inline">\(\beta_{age} = 0\)</span>) , the coefficient estimated from the model 136.903 is about 28.181 standard errors above the mean of the distribution.</p>
<div class="yourturn">
<p>The test statistic is 28.181. Do you think this provides evidence in support of or against the null hypothesis?<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
</div>
<p><strong>Step 3: Calculate a p-value.</strong></p>
<p>Sometimes the test statistic has a magnitude that is so small or so large that we can easily use it to draw conclusions about the test. There are many times, however, it is unclear what the conclusion should be based on the test statistic alone, so we compute a p-value and compare it to the decision-making threshold <span class="math inline">\(\alpha\)</span> to make a conclusion.</p>
<p>The definition of the p-value is similar for theory-based inference as with simulation-based inference. The key difference is that we will compare the test statistic, instead of the estimated coefficient, against a distribution. Thus, the p-value is the probability of observing a test statistic in the distribution at least as extreme as the observed test statistic, assuming the null hypothesis is true.</p>
<p>Under the null hypothesis, the test statistic follows a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n- p-1\)</span> degrees of freedom, <span class="math inline">\(T \sim t_{n-p-1}\)</span> . The <span class="math inline">\(t\)</span> distribution is used, instead of the standard normal distribution, to account for the extra variability that results from using the estimated regression standard error <span class="math inline">\(\hat{\sigma}_\epsilon\)</span> to compute the standard error of the coefficient in <a href="#eq-mlr-se-beta" class="quarto-xref">Equation&nbsp;<span>8.4</span></a> (see <a href="05-slr-inference.html#sec-slr-inf-hypotheses" class="quarto-xref"><span>Section 5.6.1</span></a> for more detail about <span class="math inline">\(t\)</span> distribution). Because the alternative hypothesis is not equal to, we conduct a two-sided test and compute the p-value as <span class="math inline">\(P(|t| &gt; |T|) = P(t &lt; -|T|) + P(t &gt; |T|)\)</span>, the probability of obtaining a test statistic with magnitude greater than the test statistic <span class="math inline">\(T\)</span>.</p>
<p>In the hypothesis test for <span class="math inline">\(\beta_{age}\)</span>, the p-value is computed as</p>
<p><span class="math display">\[
P(|t| &gt; |28.181|) = P(t &lt; -28.181) + P(t &gt; 28.181)
\]</span></p>
<p>using a <span class="math inline">\(t\)</span> distribution with 246 degrees of freedom. Using statistical software, the p-value is equal to 5.563^{-79} <span class="math inline">\(\approx 0\)</span>. Now we have an exact p-value that was estimated to be 0 using the permutation test in <a href="#sec-mlr-permutation" class="quarto-xref"><span>Section 8.3.2</span></a>.</p>
<p><strong>Step 4: Draw a conclusion.</strong></p>
<p>The final step is to make a conclusion by comparing the p-value to the predefined decision-making threshold, <span class="math inline">\(\alpha\)</span>. If the p-value is less than <span class="math inline">\(\alpha,\)</span> the evidence against the null is sufficiently strong, so we reject the null hypothesis and conclude the alternative. Otherwise, the evidence against the null hypothesis is not sufficiently strong, so we fail to reject the null hypothesis.</p>
<p>When writing the conclusion, we indicate whether to reject or fail to reject the null hypothesis then state what that means in the context of the data. Thus, for the hypothesis test for <code>age</code>, the conclusion is as follows:</p>
<blockquote class="blockquote">
<p><em>The p-value is less than</em> <span class="math inline">\(\alpha = 0.05\)</span><em>, so we reject the null hypothesis. The data provide sufficient evidence of a linear relationship between age and weight, after accounting for sex, taxon, and number of lemurs in the litter.</em></p>
</blockquote>
</section><section id="confidence-intervals" class="level3" data-number="8.4.3"><h3 data-number="8.4.3" class="anchored" data-anchor-id="confidence-intervals">
<span class="header-section-number">8.4.3</span> Confidence intervals</h3>
<p>In <a href="#sec-mlr-bootstrap-ci" class="quarto-xref"><span>Section 8.3.1</span></a>, we used bootstrapping to simulate the sampling distribution of <span class="math inline">\(\hat{\beta}_j\)</span>, and marked the bounds of the middle <span class="math inline">\(C\%\)</span> of the distribution to make the <span class="math inline">\(C\%\)</span> confidence interval. Here, we will use the mathematical results about the distribution of <span class="math inline">\(\hat{\beta}_j\)</span> and compute the confidence intervals using an equation of the form</p>
<p><span id="eq-mlr-beta-ci"><span class="math display">\[
\hat{\beta}_j \pm t^*_{n-p-1} \times SE_{\hat{\beta}_j}
\tag{8.6}\]</span></span></p>
<p>where <span class="math inline">\(t^*_{n-p-1}\)</span> is the critical value marking the middle <span class="math inline">\(C\%\)</span> of the <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n - p - 1\)</span> degrees of freedom. Let’s construct a 95% confidence interval for <code>age</code> to answer the question posed in <a href="#sec-mlr-inf-intro" class="quarto-xref"><span>Section 8.1</span></a> :</p>
<blockquote class="blockquote">
<p>After taking into account sex, taxon, and number of lemurs in the litter, about how much does a young lemur’s weight increase, on average, as they get older?</p>
</blockquote>
<p>We have previously computed <span class="math inline">\(\hat{\beta}_{age}\)</span> and <span class="math inline">\(SE_{\hat{\beta}_{age}}\)</span>, so we just need to compute the critical value <span class="math inline">\(t^*_{n-p-1}\)</span> using statistical software. This critical value is the point on the <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n-p-1\)</span> degrees of freedom such that 95% of the distribution (area under the curve) is between <span class="math inline">\(-t^*_{n-p-1}\)</span> and <span class="math inline">\(t^*_{n-p-1}\)</span>. In this analysis, the critical value to construct the 95% confidence interval for <span class="math inline">\(\beta_{age}\)</span> using a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n-p-1\)</span> degrees of freedom is 1.651. <!--# do i need a figure showing where the critical value is marked?--></p>
<p>Now we have all the components needed to compute the confidence interval using <a href="#eq-mlr-beta-ci" class="quarto-xref">Equation&nbsp;<span>8.6</span></a>. By using the formula, we translate the interval from standardized values to the original units of the model coefficient by rescaling (multiplying) by <span class="math inline">\(SE_{\hat{\beta}_j}\)</span> and shift by <span class="math inline">\(\hat{\beta}_j\)</span>. Thus to get the bounds of the confidence interval from <span class="math inline">\(\pm 1.651\)</span> to values in terms of grams of weight per month older, we have</p>
<p><span class="math display">\[
136.903 \pm 1.651 \times 4.858
= [128.882, 144.924]
\]</span></p>
<!--# figure out why these intervals are not super close-->
<!--# change back to 3 digits-->
<p>Thus, we are 95% confident that the interval 128.882 to 144.924 contains <span class="math inline">\(\beta_{age}\)</span>, the true slope for age.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a> More specifically in terms of the question, this means we are 95% confident that after accounting for sex, taxon, and number of lemurs in the litter, the weight of young lemurs increases between 128.882 to 144.924 grams, on average, as the age increases by one month. Recall that the “confidence” referenced here is our confidence in the statistical methods. That if we were to repeat the process of collecting 252 observations, fitting the same model, and making a confidence interval for the coefficient of age, about 95% of those intervals will actually contain the population coefficient. We cannot say for certain, however, whether this individual interval does or does not contain the true population coefficient for age.</p>
<div class="yourturn">
<p>Confidence intervals typically have confidence levels between 90% and 99%. Suppose you are considering three possible confidence levels: 90%, 95%, and 99%.</p>
<ul>
<li><p>Which confidence level will you choose to get the most accurate interval?</p></li>
<li><p>Which confidence level will you choose to get the most precise interval?<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p></li>
</ul>
</div>
</section></section><section id="sec-mlr-conditions-diagnositics" class="level2" data-number="8.5"><h2 data-number="8.5" class="anchored" data-anchor-id="sec-mlr-conditions-diagnositics">
<span class="header-section-number">8.5</span> Model conditions and diagnostics</h2>
<p>The simulation- and theory-based inference methods rely on a set of assumptions about the relationship between the response and predictor variables in the population (<a href="#sec-mlr-inf-foundation" class="quarto-xref"><span>Section 8.4.1</span></a>). We are unable to check whether these assumptions truly hold in the population, so we use the sample data to evaluate whether they hold in the data using model conditions. We also use model diagnostics to assess whether there are outliers in the data that are having an out-sized influence on the model results. These model conditions and diagnostics are the same the ones for simple linear regression (<a href="06-slr-conditions.html" class="quarto-xref"><span>Chapter 6</span></a>) with some additional considerations for the multiple predictor variables. Here we will show the conditions and diagnostics applied to the lemur model. See <a href="06-slr-conditions.html" class="quarto-xref"><span>Chapter 6</span></a> for a detailed introduction to these topics.</p>
<section id="model-conditions" class="level3" data-number="8.5.1"><h3 data-number="8.5.1" class="anchored" data-anchor-id="model-conditions">
<span class="header-section-number">8.5.1</span> Model conditions</h3>
<p>There are four model conditions that align with the assumptions outlined in <a href="#sec-mlr-theory-inf" class="quarto-xref"><span>Section 8.4</span></a>. These conditions, commonly know by the mnemonic LINE, are the following:</p>
<ul>
<li>
<strong>L</strong>inearity: There is a linear relationship between the response and predictor variables.</li>
<li>
<strong>I</strong>ndependence: The residuals are independent of one another. <!--# Is there a more useful way to describe independence? One residual does not inform another residual? -->
</li>
<li>
<strong>N</strong>ormality: The distribution of the residuals is approximately normal.</li>
<li>
<strong>E</strong>qual variance: The spread of the residuals is approximately equal for all predicted values.</li>
</ul>
<section id="linearity" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="linearity">Linearity</h4>
<p>In the context of multiple linear regression, the linearity condition means that the relationship between the response and the predictor variables can be adequately described using the linear regression model. When this is the case, the residuals <span class="math inline">\(y_i - \hat{y}_i\)</span> captures random variability that stems from the fact that there are factors other than the ones in the model that explain variability in weight and the natural random differences in weight we’d expect in a group of lemurs. To examine this, we use a plot of the residuals versus predicted values. Ideally, the residuals are randomly scattered, indicating the systematic relationship between the response and predictor variables has been capture by the model. The linearity condition is important for simulation-based and theory-based inference, so any violations in linearity should be addressed before conducting inference.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div id="fig-mlr-resid-plot" class="quarto-float quarto-figure quarto-figure-center anchored" data-fig-align="center">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-resid-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;8.4: Residuals versus predicted for lemurs model"><img src="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-resid-plot-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.4: Residuals versus predicted for lemurs model
</figcaption></figure>
</div>
</div>
</div>
<p>Based on <a href="#fig-mlr-resid-plot" class="quarto-xref">Figure&nbsp;<span>8.4</span></a>, the linearity condition is <u><strong>satisfied</strong></u>. The scatterplot shows no discernible pattern and the points are randomly scattered around <span class="math inline">\(\text{residual } = 0\)</span>. There is one point that stands out as an outlier with a large magnitude residual around 3500 grams. We will use model diagnostics to determine whether this outlier is, in fact, an influential point.</p>
<p>When the plot of residuals versus fitted values is randomly scattered as the one in this analysis, it is often sufficient to stop there when evaluating the linearity condition. If the plot of residuals versus predicted values shows some discernible pattern (for example, a parabola), we need to more closely examine the residuals versus each predictor variable to determine which variable has a non-linear relationship with the response. We may also choose to evaluate the residuals versus each predictor for more information about how well the model captures the underlying relationship with each predictor.</p>
<div id="fig-mlr-resid-plot-by-var" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-resid-plot-by-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-resid-plot-by-var" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-resid-plot-by-var-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-resid-plot-by-var-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-by-var-1.png" class="lightbox" data-gallery="fig-mlr-resid-plot-by-var" title="Figure&nbsp;8.5&nbsp;(a): Residuals versus age"><img src="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-by-var-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-resid-plot-by-var"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-resid-plot-by-var-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Residuals versus age
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-resid-plot-by-var" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-resid-plot-by-var-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-resid-plot-by-var-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-by-var-2.png" class="lightbox" data-gallery="fig-mlr-resid-plot-by-var" title="Figure&nbsp;8.5&nbsp;(b): Residuals versus taxon"><img src="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-by-var-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-resid-plot-by-var"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-resid-plot-by-var-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Residuals versus taxon
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-resid-plot-by-var" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-resid-plot-by-var-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-resid-plot-by-var-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-by-var-3.png" class="lightbox" data-gallery="fig-mlr-resid-plot-by-var" title="Figure&nbsp;8.5&nbsp;(c): Residuals versus sex"><img src="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-by-var-3.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-resid-plot-by-var"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-resid-plot-by-var-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) Residuals versus sex
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-resid-plot-by-var" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-resid-plot-by-var-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-resid-plot-by-var-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-by-var-4.png" class="lightbox" data-gallery="fig-mlr-resid-plot-by-var" title="Figure&nbsp;8.5&nbsp;(d): Residuals versus lemurs in litter"><img src="08-mlr-inference_files/figure-html/fig-mlr-resid-plot-by-var-4.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-resid-plot-by-var"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-resid-plot-by-var-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) Residuals versus lemurs in litter
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-resid-plot-by-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.5: Residuals verus each predictor for lemurs model
</figcaption></figure>
</div>
<p><a href="#fig-mlr-resid-plot-by-var" class="quarto-xref">Figure&nbsp;<span>8.5</span></a> shows plots of the residuals versus each of the four predictor variables. We use the same criteria when evaluating the plots of residuals versus quantitative predictors. For example, the plot of residuals versus <code>age</code> in <a href="#fig-mlr-resid-plot-by-var-1" class="quarto-xref">Figure&nbsp;<span>8.5 (a)</span></a> shows there may be a non-linear relationships between <code>age</code> and <code>weight</code>. This is the same non-linearity we observed in the EDA in <a href="07-mlr.html#sec-lemurs-intro" class="quarto-xref"><span>Section 7.1</span></a>. Thus, we may consider using a transformed version of <code>age</code> in the model that more accurately represents the change in weight as age increases (see <a href="09-mlr-transformations.html" class="quarto-xref"><span>Chapter 9</span></a>). We can then compare the model with the transformed age to the current model to determine which one is an overall better fit for the data. We discuss model comparison and selection in <a href="10-model-eval.html" class="quarto-xref"><span>Chapter 10</span></a>.</p>
<p>We use boxplots to examine the relationship between the response variable and categorical predictors. We expect the boxplots to be mostly vertically centered around <span class="math inline">\(\text{residual }=0\)</span> for each category of a given predictor. For example, in the plot of <code>taxon</code> versus residual in <a href="#fig-mlr-resid-plot-by-var-2" class="quarto-xref">Figure&nbsp;<span>8.5 (b)</span></a>, we see the center of each boxplot is close (though not exactly) equal to 0 and that in general the boxes for each taxon are spread around 0. One way to think about it is given a particular taxon, PCOQ for example, we cannot determine with almost any confidence whether the residual will be positive or negative. Therefore, the model sufficiently captures the relationship between taxon and weight. The same is true for <code>sex</code> in <a href="#fig-mlr-resid-plot-by-var-3" class="quarto-xref">Figure&nbsp;<span>8.5 (c)</span></a>.</p>
<p>The residuals versus <code>litter_size</code> in <a href="#fig-mlr-resid-plot-by-var-4" class="quarto-xref">Figure&nbsp;<span>8.5 (d)</span></a> is randomly scattered, so the relationship between <code>litter_size</code> and <code>weight</code> is adequately captured in the model.</p>
</section><section id="independence" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="independence">Independence</h4>
<p>The next condition in LINE is independence. This condition is based on the assumption that the residuals are independent of one another; however, we often use information about the observations to evaluate this condition. As with simple linear regression, we use what we know about the subject matter and data collection process to evaluate whether it is reasonable to treat the observations as independent in the model. If the data have a time-ordered or spatial component, or were collected from subgroups not accounted for in the model, we can analyze the residuals to assess if there are violations in independence due to time or spatial correlation, or correlation with in a cluster.</p>
<p>Based on what we know about the lemur data, we can conclude that the independence condition is <u><strong>satisfied</strong></u>, and the observations can reasonably be treated as independent of one another. This means that the residuals for one lemur do not provide information about the residuals of another lemur.</p>
<p>The independence condition is important for simulation-based and theory-based inference, so any violations in independence should be addressed before conducting inference.</p>
</section><section id="normality" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="normality">Normality</h4>
<p>The next condition in LINE is normality. This condition is based on the assumption that the error terms are normally distributed, <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2_{\epsilon})\)</span>. We we use a plot of the residuals to evaluate this claim.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlr-resid-dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-resid-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-resid-dist-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10" title="Figure&nbsp;8.6: Distribution of residuals with normal density curve"><img src="08-mlr-inference_files/figure-html/fig-mlr-resid-dist-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-resid-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.6: Distribution of residuals with normal density curve
</figcaption></figure>
</div>
</div>
</div>
<p>The distribution of the residuals with a normal curve applied is shown in <a href="#fig-mlr-resid-dist" class="quarto-xref">Figure&nbsp;<span>8.6</span></a>. We see the outlier with the large residual again in this plot. Focusing on the distribution without the outlier, the normal curve reasonably (though not perfectly) describes the distribution. Though not exactly, the distribution is approximately unimodal and symmetric, when the outlier is ignored. Therefore, we conclude the normality condition is <u><strong>satisfied</strong></u>.</p>
<p>Simulation-based inference does not rely on any assumptions about the distribution of the residuals, so it is robust to violations in the normality condition. From the Central Limit Theorem, theory-based methods for inference on the model coefficient are also robust to violations in normality when the sample is large enough. Typically 30 is used as the threshold for a “large enough” sample, but this value should not be treated as absolute. Thus, the closer the sample size is to 30, the closer the distribution of residuals needs to fit a normal distribution for reliable inferential results.</p>
</section><section id="equal-variance" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="equal-variance">Equal variance</h4>
<p>The final model condition in LINE is the equal variance condition. This condition comes from the assumption about the distribution of the error terms, <span class="math inline">\(\epsilon_i \sim N(0, \sigma^2_{\epsilon})\)</span>, that the variance in this distribution, <span class="math inline">\(\sigma^2_{\epsilon}\)</span> is the same for all observations regardless of the values of the predictors. Thus, the variability of the residuals should be the same for all predicted values (combinations of predictors).</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlr-equal-var" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-equal-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-equal-var-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11" title="Figure&nbsp;8.7: Residuals versus predicted with markers to check equal variance"><img src="08-mlr-inference_files/figure-html/fig-mlr-equal-var-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-equal-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.7: Residuals versus predicted with markers to check equal variance
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-mlr-equal-var" class="quarto-xref">Figure&nbsp;<span>8.7</span></a> shows a plot of th residuals versus predicted values, similar to <a href="#fig-mlr-resid-plot" class="quarto-xref">Figure&nbsp;<span>8.4</span></a>. As we move along the <span class="math inline">\(x\)</span>-axis, we are looking to see if the vertical spread is approximately equal for all observations. To help evaluate this, we have added vertical lines encompassing the majority of the data. Note as we move along the <span class="math inline">\(x\)</span>-axis, the vertical spread fo the residuals is largely captured in by these vertical lines. Thus, the equal variance condition is <u><strong>satisfied</strong></u>. As with other conditions, we can ignore the high outlier when assessing the condition. Additionally, we are looking for noticeable violations in the conditions rather than perfect adherence when making the determination.</p>
<p>Simulation-based inference does not rely on any assumptions about the distribution of the residuals, so it is robust to violations in the equal variance condition. The regression standard error <span class="math inline">\(\hat{\sigma}_{\epsilon}\)</span> is used to compute <span class="math inline">\(SE_{\hat{\beta}_j}\)</span> in theory-based inference, so violations in the equal variance condition could lead to unreliable inference results. Therefore, any violations should be addressed before moving forward with inference. <a href="09-mlr-transformations.html" class="quarto-xref"><span>Chapter 9</span></a> introduces model transformations that can be used to address such violations.</p>
</section></section><section id="model-diagnostics" class="level3" data-number="8.5.2"><h3 data-number="8.5.2" class="anchored" data-anchor-id="model-diagnostics">
<span class="header-section-number">8.5.2</span> Model diagnostics</h3>
<p>After checking the model conditions, we evaluate model diagnostics to identify whether there are observations that have out-sized influence on the model. In <a href="#fig-mlr-resid-plot" class="quarto-xref">Figure&nbsp;<span>8.4</span></a>, we observed the outlying observation with the very large residual. Using model diagnostics, we can assess whether this observation is merely an outlier or, in fact, an influential point.</p>
<section id="cooks-distance" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="cooks-distance">Cook’s distance</h4>
<p>We begin by using Cook’s distance to determine whether there are influential points in the data.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlr-cooks-d" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-cooks-d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-cooks-d-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12" title="Figure&nbsp;8.8: Cook’s distance for each observation in lemur analysis"><img src="08-mlr-inference_files/figure-html/fig-mlr-cooks-d-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-cooks-d-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.8: Cook’s distance for each observation in lemur analysis
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-mlr-cooks-d" class="quarto-xref">Figure&nbsp;<span>8.8</span></a> shows Cook’s distance for each observation. There is a horizontal line at <span class="math inline">\(\text{Cook's distance} = 1\)</span> marking the threshold for influential observations. In this analysis, all the values of Cook’s distance are well below 1 (the maximum value is 0.218), so there are no influential points in the data. Thus, even though we have identified the an outlier, this observations did not have an out-sized impact on the estimated model coefficients.</p>
<p>Using the modeling workflow outlined in <a href="06-slr-conditions.html#sec-model-in-practice" class="quarto-xref"><span>Section 6.5</span></a>, if we have no influential points, we do not need to examine the components of Cook’s distance, leverage and standardized residuals. If we do identify an influential point, however, we can use leverage and standardized residuals to better understand how a given observation differs from the general trend of the data.</p>
<p>Though we did not find an influential point in this analysis, we will briefly discuss leverage and standardized residuals for multiple linear regression. See <a href="06-slr-conditions.html#sec-model-diagnostics" class="quarto-xref"><span>Section 6.4</span></a> for a introduction to these topics.</p>
</section><section id="leverage" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="leverage">Leverage</h4>
<p>In simple linear regression, an observation’s leverage is a measure of how far its value of the predictor is from the mean value of the predictor in the data. That definition is expanded in multiple linear regression, where an observation’s leverage is how far its combination of predictors is from the average (typical) combination of predictors. Mathematical details for computing leverage in multiple linear regression are in <a href="appendix-linear.html#sec-hat-matrix" class="quarto-xref"><span>Section A.4</span></a>.</p>
<div class="yourturn">
<p>Suppose we decide to fit a model using <code>taxon</code>, <code>age</code>, <code>sex</code>, and <code>litter_size</code> to predict the body length of young lemurs (instead of the weight)? How does the leverage for each observation compare in this model to the leverage in the model we’ve examined using these variables to predict weight?<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
</div>
<p>An observation has <strong>large leverage</strong> if its combination of predictors is far away from the typical combination in the data. We use a threshold of <span class="math inline">\(\frac{2(p+1)}{n}\)</span>, where <span class="math inline">\(p+1\)</span> is the number of terms in the model and <span class="math inline">\(n\)</span> is the sample size, to determine whether an observation has large leverage.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlr-leverage" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-leverage-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;8.9: Leverage for observations in lemurs analysis"><img src="08-mlr-inference_files/figure-html/fig-mlr-leverage-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-leverage-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.9: Leverage for observations in lemurs analysis
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-mlr-leverage" class="quarto-xref">Figure&nbsp;<span>8.9</span></a> shows the leverage for each observation in the data. The leverage threshold 0.048 is marked on the graph. Based on this graph, there are 13 observations with large leverage. These are observations who have a combination of predictors that is far from the typical combination in the data. Given the multidimensionality of the data, it is not as straight forward to identify what makes these observations have large leverage as it was in simple linear regression. We can examine the data further to see what (if anything) these large leverage observations have in common and how they differ from the typical combination of predictors in the data. From Cook’s distance computed earlier; however, we know that these observations are not influential.</p>
</section><section id="standardized-residuals" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="standardized-residuals">Standardized residuals</h4>
<p>Standardized residuals are used to identify observations that have large magnitude residuals and thus the model poorly fit. We already noticed such an observation in <a href="#fig-mlr-resid-plot" class="quarto-xref">Figure&nbsp;<span>8.4</span></a>, so why do we need standardized residuals? Recall that residuals are on the same scale and have the same units as the response variable. Thus, if we use the raw residuals, we would need to determine a new threshold for identifying outliers in each analysis. On the other hand, standardized residuals are on the same scale in every analysis (mean of 0 and standard deviation of 1) with no units, so we can use a universal threshold that applies to every analysis.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlr-std-resid" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-std-resid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="08-mlr-inference_files/figure-html/fig-mlr-std-resid-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14" title="Figure&nbsp;8.10: Standardized residuals versus predicted values for lemur model"><img src="08-mlr-inference_files/figure-html/fig-mlr-std-resid-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-std-resid-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;8.10: Standardized residuals versus predicted values for lemur model
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-mlr-std-resid" class="quarto-xref">Figure&nbsp;<span>8.10</span></a> shows the standardized residuals versus predicted values, with lines at -3 and 3, the thresholds for identifying outliers. There is one observation that is an outlier in the <span class="math inline">\(Y\)</span> direction with a standardized residual of 6.442. Though this observation is a noticeable outlier in the model performance, it is not an influential point based on Cook’s distance computed earlier.</p>
<div class="yourturn">
<p>Consider the outlier observation. The residual for this observation is 3380.42 and the standardized residual for this observation is 6.442.</p>
<ul>
<li>Explain what the value of the residual means in the context of the data.</li>
<li>Explain what the value of the standardized residual means in the context of the data.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>
</li>
</ul>
</div>
<p>We did not have any influential points in this analysis, but there will be times when do have such points in modeling. <a href="06-slr-conditions.html#sec-outliers-impact" class="quarto-xref"><span>Section 6.4.5</span></a> discuses strategies for handling influential points in modeling.</p>
</section></section><section id="sec-mlr-multicollinearity" class="level3" data-number="8.5.3"><h3 data-number="8.5.3" class="anchored" data-anchor-id="sec-mlr-multicollinearity">
<span class="header-section-number">8.5.3</span> Multicollinearity</h3>
<p>Ideally the predictors in a multiple linear regression model would be completely independent of one another, so knowing something about one predictor would not provide information other predictors. In practice, however, there is often some correlation between a subset of the predictors. This is why some data scientists prefer to interpret coefficients using the language “after adjusting for all other predictors” rather than “holding all else constant” (see <a href="07-mlr.html#sec-mlr-interpret" class="quarto-xref"><span>Section 7.4</span></a>). This is typically not an issue for the model, but issues may arise if two or more predictors are too highly correlated. High correlation among predictors is called <strong>multicollinearity</strong>. More specifically, multicollinearity means there is near-linear dependencies between the predictors. More details of the mathematics behind multicollinearity are in <a href="appendix-linear.html#sec-multicollinearity-matrix" class="quarto-xref"><span>Section A.7</span></a>.</p>
<p>If two or more predictors are exactly correlated, then we are unable to compute estimates for some of the model coefficients. This will often show up as <code>NA</code> in the model output where the estimated coefficient should be, so software provides a clear signal when this is the case. The more challenging issue, then, is when predictors are strongly correlated, i.e., when there is multicollinearity. Though we are still able to obtain estimates for the model coefficients, there are other concerns with the associated inferential statistics.</p>
<p>When multicollinearity is present, the standard errors for correlated predictors <span class="math inline">\((SE_{\hat{\beta}_j})\)</span> are very large (see <a href="appendix-linear.html#sec-multicollinearity-matrix" class="quarto-xref"><span>Section A.7</span></a> for mathematical details). This is because when there is multicollinearity, different combinations of the coefficient estimates produce equally good model fits. Therefore, it becomes less clear what combination of coefficient estimates result in the “best fit” model. This ultimately leads to unreliable inferential conclusions, because the confidence intervals and hypothesis tests in <a href="#sec-mlr-theory-inf" class="quarto-xref"><span>Section 8.4</span></a> rely on <span class="math inline">\(SE_{\hat{\beta}_j}\)</span>. Because the standard errors are inflated, we may conclude there is no statistically significant relationship between the response and a predictor, when, in fact, there is (i.e., make a Type 1 error).</p>
<p>We detect multicollinearity using the <strong>variance inflation factor (VIF)</strong>. This is a measure of how much <span class="math inline">\(SE_{\hat{\beta}_j}\)</span> for a predictor is inflated due to its correlation with other predictors. <a href="#eq-vif" class="quarto-xref">Equation&nbsp;<span>8.7</span></a> is the VIF for the <span class="math inline">\(j^{th}\)</span> predictor.</p>
<p><span id="eq-vif"><span class="math display">\[
VIF_j = \frac{1}{1 - R^2_j}
\tag{8.7}\]</span></span></p>
<p>where <span class="math inline">\(R^2_j\)</span> is the proportion of variation in predictor <span class="math inline">\(X_j\)</span> that is explained by the other predictors. In other words, VIF considers not only if predictor <span class="math inline">\(X_j\)</span> is correlated with one other predictor, but also if it can explained as a linear combination of two or more other predictors.</p>
<p>Because we expect at least some correlation between the predictors, we conclude that concerning multicollinearity exists if VIF is 10 or greater. <a href="#tbl-lemur-vif" class="quarto-xref">Table&nbsp;<span>8.6</span></a> are the VIF for the predictors in <a href="#tbl-lemur-model-inf" class="quarto-xref">Table&nbsp;<span>8.1</span></a>.</p>
<div class="cell">
<div id="tbl-lemur-vif" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemur-vif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;8.6: VIF for predictors in <a href="#tbl-lemur-vif" class="quarto-xref">Table&nbsp;<span>8.6</span></a>
</figcaption><div aria-describedby="tbl-lemur-vif-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;"></th>
<th style="text-align: right;">x</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">1.0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">1.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">3.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">3.3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Because all the VIFs are less than 10, there are no concerns with multicollinearity in this model. Thus, we can proceed with the analysis.</p>
<p>If there is concerning multicollinearity, there are some strategies to deal with it. The first is to remove one of the predictors that is part of the correlated set. We can use model performance statistics, such as those in <a href="04-slr.html#sec-model-assessment" class="quarto-xref"><span>Section 4.7</span></a> and <a href="10-model-eval.html#sec-model-compare-stats" class="quarto-xref"><span>Section 10.2</span></a> to determine which predictor we’d like to remove from the model. If there is multicollinearity between indicators for a categorical predictor, this is generally an indication that there are too few observations in the baseline level. Therefore changing the baseline level will reduce issues with multicollinearity among the indicators. These are just two of the many creative ways the data scientist can deal with multicollinearity.</p>
</section></section><section id="inference-for-multiple-linear-regression-in-r" class="level2" data-number="8.6"><h2 data-number="8.6" class="anchored" data-anchor-id="inference-for-multiple-linear-regression-in-r">
<span class="header-section-number">8.6</span> Inference for multiple linear regression in R</h2>
<section id="sec-mlr-sim-inf-R" class="level3" data-number="8.6.1"><h3 data-number="8.6.1" class="anchored" data-anchor-id="sec-mlr-sim-inf-R">
<span class="header-section-number">8.6.1</span> Simulation-based inference in R</h3>
<p>As with simulation-based inference for simple linear regression, we use the <strong>infer</strong> R package <span class="citation" data-cites="infer">(<a href="references.html#ref-infer" role="doc-biblioref">Couch et al. 2021</a>)</span> for bootstrap confidence intervals and permutation tests. The code is shown below with brief explanations in the comments. It is described in <a href="05-slr-inference.html#sec-slr-bootstrap-r" class="quarto-xref"><span>Section 5.9.1</span></a> and <a href="05-slr-inference.html#sec-slr-permutation-r" class="quarto-xref"><span>Section 5.9.2</span></a>.</p>
<p>The code to construct the 95% bootstrap confidence interval for the coefficient of <code>age</code> is shown below.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span><span class="va">niter</span> <span class="op">=</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># construct bootstrap distribution</span></span>
<span><span class="va">boot_dist</span> <span class="op">&lt;-</span> <span class="va">lemurs_sample_young</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">specify</span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">taxon</span> <span class="op">+</span> <span class="va">litter_size</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">generate</span><span class="op">(</span>reps <span class="op">=</span> <span class="va">niter</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># compute 95% confidence interval for age</span></span>
<span><span class="va">boot_dist</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">==</span> <span class="st">"age"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span><span class="fu">get_confidence_interval</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.95</span>, type <span class="op">=</span> <span class="st">"percentile"</span><span class="op">)</span> </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1     127.     149.</code></pre>
</div>
</div>
<p>Next, the code to construct the null distribution and compute p-value for the permutation test is below. Note that the argument <code>variables = age</code> is used in <code>generate()</code> to specify that <code>age</code> is the only column that is permuted (shuffled). The default for <code>generate()</code> is to permute all columns.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span> </span>
<span><span class="va">niter</span> <span class="op">=</span> <span class="fl">1000</span> </span>
<span></span>
<span><span class="va">age_coef</span> <span class="op">&lt;-</span> <span class="va">lemurs_model</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">==</span> <span class="st">"age"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">pull</span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># construct null distribution</span></span>
<span><span class="va">null_dist</span> <span class="op">&lt;-</span> <span class="va">lemurs_sample_young</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">specify</span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">taxon</span> <span class="op">+</span> <span class="va">litter_size</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">hypothesize</span><span class="op">(</span>null <span class="op">=</span> <span class="st">"independence"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">generate</span><span class="op">(</span>reps <span class="op">=</span> <span class="va">niter</span>, type <span class="op">=</span> <span class="st">"permute"</span>, variables <span class="op">=</span> <span class="va">age</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="op">)</span> </span>
<span></span>
<span><span class="co"># compute p-value</span></span>
<span><span class="va">null_dist</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">term</span> <span class="op">==</span> <span class="st">"age"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">get_p_value</span><span class="op">(</span>obs_stat <span class="op">=</span> <span class="va">age_coef</span>, direction <span class="op">=</span> <span class="st">"two-sided"</span><span class="op">)</span> </span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Please be cautious in reporting a p-value of 0. This result is an approximation
based on the number of `reps` chosen in the `generate()` step.
ℹ See `get_p_value()` (`?infer::get_p_value()`) for more information.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  p_value
    &lt;dbl&gt;
1       0</code></pre>
</div>
</div>
</section><section id="theory-based-inference-in-r" class="level3" data-number="8.6.2"><h3 data-number="8.6.2" class="anchored" data-anchor-id="theory-based-inference-in-r">
<span class="header-section-number">8.6.2</span> Theory-based inference in R</h3>
<p>The statistics associated with the hypothesis test for each coefficient are produced by default when printing the output using <code>tidy()</code>. We can add the arguments <code>conf.int =</code> and <code>conf.level =</code> to the tidy function to output the confidence interval for each model coefficient.</p>
<p>Below is the code to fit and output the model from <a href="#sec-mlr-inf-intro" class="quarto-xref"><span>Section 8.1</span></a> with the 95% confidence interval for the model coefficients. The <code>kable</code> function is used to display the results in a neatly formatted table rounding all values to three digits.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lemurs_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">taxon</span> <span class="op">+</span></span>
<span>                          <span class="va">litter_size</span>,</span>
<span>                        data <span class="op">=</span> <span class="va">lemurs_sample_young</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">lemurs_model</span>, conf.int <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 14%">
<col style="width: 14%">
<col style="width: 11%">
<col style="width: 13%">
<col style="width: 14%">
</colgroup>
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
<th style="text-align: right;">conf.low</th>
<th style="text-align: right;">conf.high</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">24.2</td>
<td style="text-align: right;">93.63</td>
<td style="text-align: right;">0.259</td>
<td style="text-align: right;">0.796</td>
<td style="text-align: right;">-160</td>
<td style="text-align: right;">208.7</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">136.9</td>
<td style="text-align: right;">4.86</td>
<td style="text-align: right;">28.182</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">127</td>
<td style="text-align: right;">146.5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-88.8</td>
<td style="text-align: right;">68.00</td>
<td style="text-align: right;">-1.306</td>
<td style="text-align: right;">0.193</td>
<td style="text-align: right;">-223</td>
<td style="text-align: right;">45.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">471.7</td>
<td style="text-align: right;">95.43</td>
<td style="text-align: right;">4.943</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">284</td>
<td style="text-align: right;">659.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1037.3</td>
<td style="text-align: right;">133.91</td>
<td style="text-align: right;">7.747</td>
<td style="text-align: right;">0.000</td>
<td style="text-align: right;">774</td>
<td style="text-align: right;">1301.1</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">-19.6</td>
<td style="text-align: right;">65.80</td>
<td style="text-align: right;">-0.298</td>
<td style="text-align: right;">0.766</td>
<td style="text-align: right;">-149</td>
<td style="text-align: right;">110.0</td>
</tr>
</tbody>
</table>
</div>
</div>
</section><section id="model-conditions-and-diagnostics" class="level3" data-number="8.6.3"><h3 data-number="8.6.3" class="anchored" data-anchor-id="model-conditions-and-diagnostics">
<span class="header-section-number">8.6.3</span> Model conditions and diagnostics</h3>
<p>We use the <code>augment</code> function to produce a tibble of the statistics used for model conditions and diagnostics as with simple linear regression. See <a href="06-slr-conditions.html#sec-conditions-in-r" class="quarto-xref"><span>Section 6.6</span></a> for a description of the output produced by <code>augment()</code> and how these values are used to check model conditions and diagnostics.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lemur_aug</span> <span class="op">&lt;-</span> <span class="fu">augment</span><span class="op">(</span><span class="va">lemurs_model</span><span class="op">)</span></span>
<span></span>
<span><span class="va">lemur_aug</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5 × 11
  weight   age sex   taxon litter_size .fitted .resid   .hat .sigma    .cooksd
   &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;      &lt;dbl&gt;
1    410  2.27 F     ERUF            0    335.   75.0 0.0277   534. 0.0000968 
2    137  0.72 F     ERUF            0    123.   14.2 0.0298   534. 0.00000374
3    206  0.69 F     PCOQ            0    590. -384.  0.0201   533. 0.00182   
4    185  1.05 M     PCOQ            0    551. -366.  0.0183   533. 0.00150   
5    373  2.66 F     PCOQ            0    860. -487.  0.0178   533. 0.00257   
# ℹ 1 more variable: .std.resid &lt;dbl&gt;</code></pre>
</div>
</div>
<p>The variance inflation factors can be computed using <code>vif()</code> in the <strong>rms</strong> R package <span class="citation" data-cites="rms">(<a href="references.html#ref-rms" role="doc-biblioref">Harrell Jr 2025</a>)</span>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">vif</span><span class="op">(</span><span class="va">lemurs_model</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        age        sexM   taxonPCOQ   taxonVRUB litter_size 
       1.03        1.02        1.88        3.92        3.27 </code></pre>
</div>
</div>
</section></section><section id="summary" class="level2" data-number="8.7"><h2 data-number="8.7" class="anchored" data-anchor-id="summary">
<span class="header-section-number">8.7</span> Summary</h2>
<p>In this chapter, we built upon inference for simple linear regression introduced <a href="05-slr-inference.html" class="quarto-xref"><span>Chapter 5</span></a> and showed how inference can be used to draw conclusions about model coefficients in multiple linear regression models. We showed how to conduct simulation-based inference using bootstrapping for confidence intervals and permutation tests for hypothesis testing. Then, we showed how to compute the values shown the regression output by conducting inference using mathematical models based on the Central Limit Theorem. Lastly, we showed how to check model conditions and diagnostics for multiple linear regression, building off of the introduction to these topics in <a href="06-slr-conditions.html" class="quarto-xref"><span>Chapter 6</span></a>.</p>
<p>Sometimes the data shows violations in the model conditions that need to be addressed to make reliable conclusions and predictions from the model. In the next chapter, we will introduce variable transformations that can be used to address violations in the model conditions, particularly in the linearity and equal variance conditions.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-infer" class="csl-entry" role="listitem">
Couch, Simon P., Andrew P. Bray, Chester Ismay, Evgeni Chasnovski, Benjamin S. Baumer, and Mine Çetinkaya-Rundel. 2021. <span>“<span></span>Infer<span></span>: An <span></span>r<span></span> Package for Tidyverse-Friendly Statistical Inference”</span> 6: 3661. <a href="https://doi.org/10.21105/joss.03661">https://doi.org/10.21105/joss.03661</a>.
</div>
<div id="ref-rms" class="csl-entry" role="listitem">
Harrell Jr, Frank E. 2025. <span>“Rms: Regression Modeling Strategies.”</span> <a href="https://doi.org/10.32614/CRAN.package.rms">https://doi.org/10.32614/CRAN.package.rms</a>.
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>Question 1: This can be answered by hypothesis test and confidence interval. Question 2: This question can be answered by a confidence interval.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>It is estimate of <span class="math inline">\(SE_{\hat{\beta}_{age}}\)</span>, the standard error of the coefficient of <code>age</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>We are 90% confident that the weight of PCOQ lemurs is 314.442 to 630.842 grams higher, on average, compared the weight of ERUF lemurs, holding age, sex, and litter size constant.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4">
<ol type="1">
<li>The center of the null distribution is approximately equal to 0, the hypothesized value. Because the null is created using a simulation-based procedure, it will not be exact but very close as the number of samples increases.</li>
<li>The standard deviation of the null distribution is approximately equal to the standard deviation of the bootstrap distribution. They are both approximations of <span class="math inline">\(SE_{\hat{\beta}_{age}}\)</span>.<br>
</li>
</ol>
<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a>
</li>
<li id="fn5"><p>It corresponds to a hypothesis test with <span class="math inline">\(\alpha = 0.05\)</span>. Yes, the interval is consistent, because the null hypothesized value 0 is not in the interval.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>This is a large test statistic, so it appears to provide evidence against the null hypothesis. We will complete the last two steps of hypothesis testing to see the conclusion.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>Our calculations do not exactly match the confidence interval produced by software, because we have used rounded values of the estimated slope, critical value, and standard error.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The confidence level 99% produces the most accurate interval. The confidence level 90% produces the most precise interval.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>The leverage of each observation will be the same for the two models. Leverage only depends on the predictor variables. It does not depend on the response variable.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>The residual means that the observed weight for this lemur is 3380.42 grams greater than the weight predicted by the model. The standardized residual means that the residual for this observation is 6.442standard errors above the mean of the distribution of residuals.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/introregressio\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./07-mlr.html" class="pagination-link" aria-label="Multiple linear regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./09-mlr-transformations.html" class="pagination-link" aria-label="Variable transformations">
        <span class="nav-page-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Variable transformations</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/matackett/regression-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>