<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Maria Tackett">
<title>7&nbsp; Multiple linear regression – Introduction to Regression Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./08-mlr-inference.html" rel="next">
<link href="./06-slr-conditions.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-31c3c5ec0f84e3846e28bd1517aa8340.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script defer="" data-domain="https://matackett.github.io/regression-book/" src="https://plausible.io/js/script.js"></script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-mlr.html">Part 3: Multiple linear regression</a></li><li class="breadcrumb-item"><a href="./07-mlr.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Regression Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/matackett/regression-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 1: Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Regression in the data science workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-review-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data analysis in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 2: Simple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-slr-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-slr-conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model conditions and diagnostics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 3: Multiple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-mlr.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mlr-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-mlr-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Variable transformations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-model-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model selection</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 4: Beyond linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-logistic-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Logistic regression: Prediction and evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-special-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Special topics</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Mathematics of linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Mathematics of logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data sets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">Learning goals</a></li>
  <li>
<a href="#sec-lemurs-intro" id="toc-sec-lemurs-intro" class="nav-link" data-scroll-target="#sec-lemurs-intro"><span class="header-section-number">7.1</span> Introduction: Lemurs</a>
  <ul class="collapse">
<li><a href="#sec-mlr-eda" id="toc-sec-mlr-eda" class="nav-link" data-scroll-target="#sec-mlr-eda"><span class="header-section-number">7.1.1</span> Exploratory data analysis</a></li>
  </ul>
</li>
  <li>
<a href="#sec-mlr-fit-line" id="toc-sec-mlr-fit-line" class="nav-link" data-scroll-target="#sec-mlr-fit-line"><span class="header-section-number">7.2</span> Fitting the regression line</a>
  <ul class="collapse">
<li><a href="#statistical-model-for-multiple-linear-regression" id="toc-statistical-model-for-multiple-linear-regression" class="nav-link" data-scroll-target="#statistical-model-for-multiple-linear-regression"><span class="header-section-number">7.2.1</span> Statistical model for multiple linear regression</a></li>
  <li><a href="#evaluating-whether-mlr-is-appropriate" id="toc-evaluating-whether-mlr-is-appropriate" class="nav-link" data-scroll-target="#evaluating-whether-mlr-is-appropriate"><span class="header-section-number">7.2.2</span> Evaluating whether MLR is appropriate</a></li>
  </ul>
</li>
  <li>
<a href="#sec-mlr-estimate-coef" id="toc-sec-mlr-estimate-coef" class="nav-link" data-scroll-target="#sec-mlr-estimate-coef"><span class="header-section-number">7.3</span> Estimating the coefficients</a>
  <ul class="collapse">
<li><a href="#optional-matrix-notation-for-multiple-linear-regression" id="toc-optional-matrix-notation-for-multiple-linear-regression" class="nav-link" data-scroll-target="#optional-matrix-notation-for-multiple-linear-regression"><span class="header-section-number">7.3.1</span> (Optional) Matrix notation for multiple linear regression</a></li>
  </ul>
</li>
  <li>
<a href="#sec-mlr-interpret" id="toc-sec-mlr-interpret" class="nav-link" data-scroll-target="#sec-mlr-interpret"><span class="header-section-number">7.4</span> Interpreting model coefficients</a>
  <ul class="collapse">
<li><a href="#sec-mlr-interpret-quantitative" id="toc-sec-mlr-interpret-quantitative" class="nav-link" data-scroll-target="#sec-mlr-interpret-quantitative"><span class="header-section-number">7.4.1</span> Interpreting coefficients of quantitative predictors</a></li>
  <li><a href="#sec-mlr-interpret-categorical" id="toc-sec-mlr-interpret-categorical" class="nav-link" data-scroll-target="#sec-mlr-interpret-categorical"><span class="header-section-number">7.4.2</span> Interpreting coefficients of categorical predictors</a></li>
  <li><a href="#sec-intercept" id="toc-sec-intercept" class="nav-link" data-scroll-target="#sec-intercept"><span class="header-section-number">7.4.3</span> Interpreting the intercept</a></li>
  </ul>
</li>
  <li><a href="#prediction" id="toc-prediction" class="nav-link" data-scroll-target="#prediction"><span class="header-section-number">7.5</span> Prediction</a></li>
  <li>
<a href="#sec-other-predictors" id="toc-sec-other-predictors" class="nav-link" data-scroll-target="#sec-other-predictors"><span class="header-section-number">7.6</span> Centered and standardized predictors</a>
  <ul class="collapse">
<li><a href="#centered-quantitative-predictors" id="toc-centered-quantitative-predictors" class="nav-link" data-scroll-target="#centered-quantitative-predictors"><span class="header-section-number">7.6.1</span> Centered quantitative predictors</a></li>
  <li><a href="#standardized-quantitative-predictors" id="toc-standardized-quantitative-predictors" class="nav-link" data-scroll-target="#standardized-quantitative-predictors"><span class="header-section-number">7.6.2</span> Standardized quantitative predictors</a></li>
  </ul>
</li>
  <li>
<a href="#sec-mlr-interaction" id="toc-sec-mlr-interaction" class="nav-link" data-scroll-target="#sec-mlr-interaction"><span class="header-section-number">7.7</span> Interaction terms</a>
  <ul class="collapse">
<li><a href="#interaction-between-a-quantitative-and-a-categorical-predictor" id="toc-interaction-between-a-quantitative-and-a-categorical-predictor" class="nav-link" data-scroll-target="#interaction-between-a-quantitative-and-a-categorical-predictor"><span class="header-section-number">7.7.1</span> Interaction between a quantitative and a categorical predictor</a></li>
  <li><a href="#interaction-between-two-categorical-predictors" id="toc-interaction-between-two-categorical-predictors" class="nav-link" data-scroll-target="#interaction-between-two-categorical-predictors"><span class="header-section-number">7.7.2</span> Interaction between two categorical predictors</a></li>
  <li><a href="#interaction-between-two-quantitative-predictors" id="toc-interaction-between-two-quantitative-predictors" class="nav-link" data-scroll-target="#interaction-between-two-quantitative-predictors"><span class="header-section-number">7.7.3</span> Interaction between two quantitative predictors</a></li>
  </ul>
</li>
  <li>
<a href="#multiple-linear-regression-in-r" id="toc-multiple-linear-regression-in-r" class="nav-link" data-scroll-target="#multiple-linear-regression-in-r"><span class="header-section-number">7.8</span> Multiple linear regression in R</a>
  <ul class="collapse">
<li><a href="#sec-mlr-estimate-r" id="toc-sec-mlr-estimate-r" class="nav-link" data-scroll-target="#sec-mlr-estimate-r"><span class="header-section-number">7.8.1</span> Estimating coefficient using R</a></li>
  <li><a href="#prediction-1" id="toc-prediction-1" class="nav-link" data-scroll-target="#prediction-1"><span class="header-section-number">7.8.2</span> Prediction</a></li>
  <li><a href="#interaction-terms" id="toc-interaction-terms" class="nav-link" data-scroll-target="#interaction-terms"><span class="header-section-number">7.8.3</span> Interaction terms</a></li>
  </ul>
</li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">7.9</span> Summary</a></li>
  </ul><div class="toc-actions"><ul><li><a href="https://github.com/matackett/regression-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./07-mlr.html">Part 3: Multiple linear regression</a></li><li class="breadcrumb-item"><a href="./07-mlr.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-ch-mlr" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><section id="learning-goals" class="level2 unnumbered"><h2 class="unnumbered anchored" data-anchor-id="learning-goals">Learning goals</h2>
<ul>
<li>Explain how multiple predictor variables can be used to explain variability and predict a quantitative response variable</li>
<li>Interpret model coefficients in the context of the data</li>
<li>Compute predicted values from the multiple linear regression model</li>
<li>Use different types of predictors in the regression model <!--# need better wording for this-->
</li>
<li>Conduct multiple linear regression analysis using R <!--# make sure this goal is consistently stated across chapters -->
</li>
</ul>
<!--#

## R packages {.unnumbered}

-   `library(tidyverse)` [@tidyverse]
-   `library(tidymodels)` [@tidymodels-2]
-   `library(patchwork)` [@patchwork]
-   `library(skimr)` [@skimr]
-   `library(broom)` [@broom-2]

--><!--# UPDATED THIS TO INCLUDE ONLY LEMURS 0.5 MONTHS OR HIGHER BC OF ISSUES WITH LOG(AGE) WITH VERY SMALL AGES. NEED TO GO THROUGH CHAPTER TO MAKE SURE ALL VALUES ALIGN--></section><section id="sec-lemurs-intro" class="level2" data-number="7.1"><h2 data-number="7.1" class="anchored" data-anchor-id="sec-lemurs-intro">
<span class="header-section-number">7.1</span> Introduction: Lemurs</h2>
<!--# Lemur Tidy Tuesday: https://github.com/rfordatascience/tidytuesday/blob/main/data/2021/2021-08-24/readme.md -->
<p>About 95% of lemur species are at risk of extinction, so it is important for researchers to study and better understand lemurs to more effectively save these species <span class="citation" data-cites="tidytuesday">(<a href="references.html#ref-tidytuesday" role="doc-biblioref">Community 2024</a>)</span>. The Duke Lemur Center currently has over 250 lemurs from 12 species. It has the most diverse population of lemurs outside of Madagascar, the native home for lemurs <span class="citation" data-cites="duke2025meetlemurs">(<a href="references.html#ref-duke2025meetlemurs" role="doc-biblioref">Duke Lemur Center n.d.</a>)</span>. <!--# do i need more specific citation?--> In this chapter, we will use various characteristics to understand the variability in the weight of lemurs who are 24 months old or younger. We refer to this group of lemurs as “young lemurs” throughout the analysis. <!--# Insert some reasoning about why we would care to study these lemurs or what's different when they are young--> The data contains the weight and other features of young lemurs from three taxon (ERUF, PCOQ, and VRUB) <!--# reference image?--> who lived at the Duke Lemur Center at the time the data were collected. The data were originally from <span class="citation" data-cites="zehrlife">Zehr et al. (<a href="references.html#ref-zehrlife" role="doc-biblioref">n.d.</a>)</span> and were featured as part of the TidyTuesday weekly data visualization challenge in August 2021 <span class="citation" data-cites="tidytuesday">(<a href="references.html#ref-tidytuesday" role="doc-biblioref">Community 2024</a>)</span>.</p>
<div id="fig-lemurs" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lemurs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/06-eruf-lemur.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Eulemur rufus (ERUF)"><img src="images/06-eruf-lemur.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<figcaption>Eulemur rufus (ERUF)</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/06-pcoq-lemur.jpg" class="lightbox" data-gallery="quarto-lightbox-gallery-2" title="Propithecus coquereli (PCOQ)"><img src="images/06-pcoq-lemur.jpg" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<figcaption>Propithecus coquereli (PCOQ)</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 33.3%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><a href="images/06-vrub-lemur.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Varecia rubra (VRUB)"><img src="images/06-vrub-lemur.png" class="img-fluid quarto-figure quarto-figure-center figure-img"></a></p>
</figure>
</div>
<figcaption>Varecia rubra (VRUB)</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lemurs-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.1: Types of lemurs represented in the data set. Images from <span class="citation" data-cites="duke2025meetlemurs">Duke Lemur Center (<a href="references.html#ref-duke2025meetlemurs" role="doc-biblioref">n.d.</a>)</span>.
</figcaption></figure>
</div>
<!--# check that I can actually use these images from Duke Lemur Website: https://lemur.duke.edu/discover/meet-the-lemurs/ -->
<p>The data are in <code>lemurs-sample-young.csv</code>. This analysis in this chapter focuses on the following variables:</p>
<ul>
<li>
<code>weight</code>: Weight of the lemur (in grams)</li>
<li>
<code>taxon</code> : Code made as a combination of the lemur’s genus and species. Note that the genus is a broader categorization that includes lemurs from multiple species. <!--# is this note helpful or confusing?--> This analysis focuses on the following taxon:
<ul>
<li><p><code>ERUF</code>: Eulemur rufus, commonly known as Red-fronted brown lemur</p></li>
<li><p><code>PCOQ</code>: Propithecus coquereli, commonly known as Coquerel’s sifaka</p></li>
<li><p><code>VRUB</code>: Varecia rubra, commonly known as Red ruffed lemur</p></li>
</ul>
</li>
<li>
<code>sex</code> : Sex of lemur (<code>M</code>: Male, <code>F</code>: Female)</li>
<li>
<code>age</code>: Age of lemur when weight was recorded (in months)</li>
<li>
<code>litter_size</code>: Total number of infants in the litter the lemur was born into (this includes the observed lemur)</li>
</ul>
<div class="objective">
<p>The goal of the analysis is to use age, taxon, sex, and litter size to predict and explain variability in the weights of young lemurs.</p>
</div>
<!--# removed the your turn here: Add question here about how the original data set had multiple rows / weight measures per lemur?-->
<section id="sec-mlr-eda" class="level3" data-number="7.1.1"><h3 data-number="7.1.1" class="anchored" data-anchor-id="sec-mlr-eda">
<span class="header-section-number">7.1.1</span> Exploratory data analysis</h3>
<p>The distribution and summary statistics for the response variable <code>weight</code> are shown in <a href="#fig-mlr-response" class="quarto-xref">Figure&nbsp;<span>7.2</span></a> and <a href="#tbl-mlr-response" class="quarto-xref">Table&nbsp;<span>7.1</span></a>, respectively. The center of the distribution is around the median of 1779.5 grams and the interquartile range (IQR) is 2087 grams. The distribution is bimodal, which may be due to the multiple taxa represented in the data. There is one lemur with a high outlying weight of 6969 grams. We will keep the bimodality and outlier in mind as we proceed with the analysis.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-mlr-response" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-response-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-mlr-response-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;7.2: Univariate distribution of weight of young lemurs"><img src="07-mlr_files/figure-html/fig-mlr-response-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-response-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.2: Univariate distribution of <code>weight</code> of young lemurs
</figcaption></figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-mlr-response" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mlr-response-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.1: Summary statistics for <code>weight</code>
</figcaption><div aria-describedby="tbl-mlr-response-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Median (Q2)</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Missing</th>
</tr></thead>
<tbody><tr class="odd">
<td style="text-align: left;">weight</td>
<td style="text-align: right;">1839</td>
<td style="text-align: right;">1190</td>
<td style="text-align: right;">131</td>
<td style="text-align: right;">677</td>
<td style="text-align: right;">1780</td>
<td style="text-align: right;">2764</td>
<td style="text-align: right;">6969</td>
<td style="text-align: right;">0</td>
</tr></tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Now let’s look at the distributions of the predictors in this analysis. The visualizations of each variable’s distribution and summary statistics for the quantitative predictors are in <a href="#fig-mlr-pred-var" class="quarto-xref">Figure&nbsp;<span>7.3</span></a> and <a href="#tbl-mlr-pred-var" class="quarto-xref">Table&nbsp;<span>7.2</span></a>, respectively.</p>
<div id="fig-mlr-pred-var" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-pred-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-pred-var" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-pred-var-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-pred-var-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-mlr-pred-var-1.png" class="lightbox" data-gallery="fig-mlr-pred-var" title="Figure&nbsp;7.3&nbsp;(a): age"><img src="07-mlr_files/figure-html/fig-mlr-pred-var-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-pred-var"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-pred-var-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <code>age</code>
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-pred-var" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-pred-var-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-pred-var-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-mlr-pred-var-2.png" class="lightbox" data-gallery="fig-mlr-pred-var" title="Figure&nbsp;7.3&nbsp;(b): taxon"><img src="07-mlr_files/figure-html/fig-mlr-pred-var-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-pred-var"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-pred-var-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) <code>taxon</code>
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-pred-var" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-pred-var-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-pred-var-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-mlr-pred-var-3.png" class="lightbox" data-gallery="fig-mlr-pred-var" title="Figure&nbsp;7.3&nbsp;(c): sex"><img src="07-mlr_files/figure-html/fig-mlr-pred-var-3.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-pred-var"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-pred-var-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) <code>sex</code>
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-pred-var" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-pred-var-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-pred-var-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-mlr-pred-var-4.png" class="lightbox" data-gallery="fig-mlr-pred-var" title="Figure&nbsp;7.3&nbsp;(d): litter_size"><img src="07-mlr_files/figure-html/fig-mlr-pred-var-4.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-pred-var"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-pred-var-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) <code>litter_size</code>
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-pred-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.3: Univariate distributions of predictor variables
</figcaption></figure>
</div>
<div class="cell">
<div id="tbl-mlr-pred-var" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-mlr-pred-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.2: Summary statistics of quantitative predictors
</figcaption><div aria-describedby="tbl-mlr-pred-var-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Median (Q2)</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Missing</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">3.0</td>
<td style="text-align: right;">4.0</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">9.0</td>
<td style="text-align: right;">7.0</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">15.6</td>
<td style="text-align: right;">23.9</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><br>
The distribution of <code>taxon</code> in <a href="#fig-mlr-pred-var-2" class="quarto-xref">Figure&nbsp;<span>7.3 (b)</span></a> shows that most lemurs are from the VRUB taxon and the fewest are from the ERUF taxon. The distribution of <code>sex</code> in <a href="#fig-mlr-pred-var-3" class="quarto-xref">Figure&nbsp;<span>7.3 (c)</span></a> shows a relatively equal distribution, with a small majority of the lemurs being female. Finally, a vast majority of the lemurs were born as the only lemur in their litter as seen in <a href="#fig-mlr-pred-var-4" class="quarto-xref">Figure&nbsp;<span>7.3 (d)</span></a>.</p>
<div class="yourturn">
<p>Use the visualizations in <a href="#fig-mlr-pred-var" class="quarto-xref">Figure&nbsp;<span>7.3</span></a> and summary statistics in <a href="#tbl-mlr-pred-var" class="quarto-xref">Table&nbsp;<span>7.2</span></a> to describe the distribution of <code>age</code>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</div>
<p>Now, we conduct bivariate exploratory data analysis, shown in <a href="#fig-mlr-bivariate" class="quarto-xref">Figure&nbsp;<span>7.4</span></a>, to explore the relationship between the response and each of the predictor variables.</p>
<div id="fig-mlr-bivariate" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-mlr-bivariate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-bivariate" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-bivariate-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-bivariate-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-mlr-bivariate-1.png" class="lightbox" data-gallery="fig-mlr-bivariate" title="Figure&nbsp;7.4&nbsp;(a): weight vs.&nbsp;age"><img src="07-mlr_files/figure-html/fig-mlr-bivariate-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-bivariate"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-bivariate-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <code>weight</code> vs.&nbsp;<code>age</code>
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-bivariate" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-bivariate-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-bivariate-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-mlr-bivariate-2.png" class="lightbox" data-gallery="fig-mlr-bivariate" title="Figure&nbsp;7.4&nbsp;(b): weight vs.&nbsp;taxon"><img src="07-mlr_files/figure-html/fig-mlr-bivariate-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-bivariate"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-bivariate-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) <code>weight</code> vs.&nbsp;<code>taxon</code>
</figcaption></figure>
</div>
</div>
</div>
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-bivariate" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-bivariate-3" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-bivariate-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-mlr-bivariate-3.png" class="lightbox" data-gallery="fig-mlr-bivariate" title="Figure&nbsp;7.4&nbsp;(c): weight vs.&nbsp;sex"><img src="07-mlr_files/figure-html/fig-mlr-bivariate-3.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-bivariate"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-bivariate-3-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(c) <code>weight</code> vs.&nbsp;<code>sex</code>
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-mlr-bivariate" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-mlr-bivariate-4" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-mlr-bivariate-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-mlr-bivariate-4.png" class="lightbox" data-gallery="fig-mlr-bivariate" title="Figure&nbsp;7.4&nbsp;(d): weight vs.&nbsp;litter_size"><img src="07-mlr_files/figure-html/fig-mlr-bivariate-4.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-mlr-bivariate"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-mlr-bivariate-4-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(d) <code>weight</code> vs.&nbsp;<code>litter_size</code>
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-mlr-bivariate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.4: Bivariate exploratory data analysis
</figcaption></figure>
</div>
<p>From <a href="#fig-mlr-bivariate-1" class="quarto-xref">Figure&nbsp;<span>7.4 (a)</span></a>, we see a strong, positive relationship between <code>age</code> and <code>weight</code>. The relationship looks linear; however, the relationship flattens as age increases. This aligns with what we might expect; lemurs experience fairly rapid growth early on, and then their growth rate slows over time. In <a href="09-mlr-transformations.html" class="quarto-xref"><span>Chapter 9</span></a>, we will introduce transformations that can be applied to the predictor and response variables to account for such trends in the model. For now, we will model the relationship as a constant rate of change between <code>age</code> and <code>weight</code>.</p>
<p>In <a href="#fig-mlr-bivariate-2" class="quarto-xref">Figure&nbsp;<span>7.4 (b)</span></a>, lemurs from the PCOQ taxon have a lower median weight than lemurs from ERUF or VRUB: however, there is a lot of overlap in the distribution of weights of ERUF and PCOQ lemurs. Lemurs in the VRUB taxon have the highest median weight; however, the middle 50% of the distribution overlaps greatly with the distribution for PCOQ lemurs. There is more variability in the weights of PCOQ lemurs compared to ERUF and VRUB, and we see the lemur with the outlier weight is in the PCOQ taxon.</p>
<p>Based on the medians and large overlap in the boxplots in <a href="#fig-mlr-bivariate-3" class="quarto-xref">Figure&nbsp;<span>7.4 (c)</span></a>, there does not appear to be much difference in the weights of male and female lemurs. From this plot, we see the lemur with the high outlying weight is a female.</p>
<p><a href="#fig-mlr-bivariate-4" class="quarto-xref">Figure&nbsp;<span>7.4 (d)</span></a> shows the relationship between <code>litter_size</code> and <code>weight</code>. Random noise was added to reduce overlap in the points on the graph. This makes it easier to see the relationship between the two variables. Based on this scatterplot, the relationship between <code>litter_size</code> and <code>weight</code> appears to be positive and relatively weak.</p>
<p>Now that we have a better understanding of the variables in this analysis, we will use a multiple linear regression model to understand how taxon, litter size, age, and sex explains variability in the weight of lemurs. Before looking at the model specific to this data, we will discuss the details of the multiple linear regression model, in general, and to determine if a multiple linear regression model is appropriate for the data.</p>
<!--# add something about the outlier and you'll explore as an exercise if this is an influential point-->
</section></section><section id="sec-mlr-fit-line" class="level2" data-number="7.2"><h2 data-number="7.2" class="anchored" data-anchor-id="sec-mlr-fit-line">
<span class="header-section-number">7.2</span> Fitting the regression line</h2>
<p>In <a href="04-slr.html" class="quarto-xref"><span>Chapter 4</span></a>, we introduced simple linear regression to quantify the relationship between a response and a single predictor variable. Using multiple linear regression, we can expand on the regression model to quantify the relationship between a response variable and multiple predictors.</p>
<section id="statistical-model-for-multiple-linear-regression" class="level3" data-number="7.2.1"><h3 data-number="7.2.1" class="anchored" data-anchor-id="statistical-model-for-multiple-linear-regression">
<span class="header-section-number">7.2.1</span> Statistical model for multiple linear regression</h3>
<p>Recall from <a href="04-slr.html#sec-fit-regression" class="quarto-xref"><span>Section 4.3</span></a> that the general form of a model for a response variable <span class="math inline">\(Y\)</span> is</p>
<p><span id="eq-general-model-recap"><span class="math display">\[
Y = \text{Model} + \text{Error}
\tag{7.1}\]</span></span></p>
<p>In the case of simple linear regression, <span class="math inline">\(\text{Model} = f(X)\)</span> where <span class="math inline">\(X\)</span> is the predictor variable used to explain the variability in <span class="math inline">\(Y\)</span>. Now we will expand <a href="#eq-general-model-recap" class="quarto-xref">Equation&nbsp;<span>7.1</span></a> to the case in which multiple predictor variables, denoted <span class="math inline">\(\mathbf{X} = X_1, X_2, \ldots, X_p\)</span> are used in combination to explain variability in the response variable <span class="math inline">\(Y\)</span>. The values of the response variable <span class="math inline">\(Y\)</span> are generated based on the following equation</p>
<p><span id="eq-general-model-mlr"><span class="math display">\[
\begin{aligned}
Y &amp;= \text{Model} + \text{Error} \\[5pt]
&amp; = f(\mathbf{X}) + \epsilon \\[5pt]
&amp; = f(X_1, X_2, \ldots, X_p) + \epsilon
\end{aligned}
\tag{7.2}\]</span></span></p>
<p>where <span class="math inline">\(p\)</span> represents the number of predictor variables and <span class="math inline">\(\epsilon\)</span> is the error term quantifying the amount in which the actual value of <span class="math inline">\(Y\)</span> differs from what is expected from the model <span class="math inline">\(f(X_1, X_2, \ldots, X_p)\)</span>.</p>
<p><a href="#eq-general-model-mlr" class="quarto-xref">Equation&nbsp;<span>7.2</span></a> is the general form of the model. As with simple linear regression, we know the form of <span class="math inline">\(f(X_1,  X_2, \ldots, X_p)\)</span> when we assume there is a linear relationship between the response and predictor variables. <a href="#eq-general-model-mlr" class="quarto-xref">Equation&nbsp;<span>7.2</span></a> can be more specifically written as a <strong>multiple linear regression model</strong> (MLR) of the form</p>
<p><span id="eq-mlr-stat-model-1"><span class="math display">\[
Y = \beta_0 + \beta_1X_1 + \beta_2X_2 + \dots + \beta_pX_p + \epsilon, \hspace{8mm} \epsilon \sim N(0, \sigma^2_{\epsilon})
\tag{7.3}\]</span></span></p>
<p>where <span class="math inline">\(\epsilon \sim N(0, \sigma^2_{\epsilon})\)</span> indicates the error terms are normally distributed with a mean of 0 and variance <span class="math inline">\(\sigma^2_{\epsilon}\)</span>. <a href="#eq-mlr-stat-model-1" class="quarto-xref">Equation&nbsp;<span>7.3</span></a> is the population-level statistical model for multiple linear regression.</p>
<p>Recall from <a href="04-slr.html#sec-slr-specify" class="quarto-xref"><span>Section 4.3.1</span></a>, the function <span class="math inline">\(f(X) = \mu_{Y|X}\)</span> is the expected value (mean) of <span class="math inline">\(Y\)</span> given a value of the predictor <span class="math inline">\(X\)</span>. Extending this to multiple linear regression, <span class="math inline">\(f(\mathbf{X}) = f(X_1, X_2, \ldots, X_p)\)</span> outputs the expected value of <span class="math inline">\(Y\)</span> for a combination of the predictors. Therefore,</p>
<p><span id="eq-mlr-exp-y"><span class="math display">\[
\mu_{Y|\mathbf{X}} = \mu_{Y|X_1, X_2, \ldots, X_p} = \beta_0 + \beta_1X_1 + \beta_2X_2 + \dots + \beta_pX_p
\tag{7.4}\]</span></span></p>
<p>Thus, when we fit a multiple linear regression model, the output from the fitted model will be the predicted expected value of the response variable for a given combination of values of the predictor variables.</p>
</section><section id="evaluating-whether-mlr-is-appropriate" class="level3" data-number="7.2.2"><h3 data-number="7.2.2" class="anchored" data-anchor-id="evaluating-whether-mlr-is-appropriate">
<span class="header-section-number">7.2.2</span> Evaluating whether MLR is appropriate</h3>
<!--# could this section be a callout box?-->
<p>Before we move forward with fitting the regression model, we should first ask whether the multiple linear regression model is appropriate or useful for the data. We can ask the same questions we did for simple linear regression; however, now we are considering the relationship between <span class="math inline">\(Y\)</span> and multiple predictor variables rather than a single predictor.</p>
<ul>
<li>Will a linear regression model be practically useful? Does quantifying and interpreting the relationship between the variables make sense in this scenario?</li>
<li>Do the observations in the data represent the population of interest, or are there biases that should be addressed when drawing conclusions from the analysis? <!--# Differentiate this from the first two bullet points. Make clear if the first two points are violated, we definitely shouldn't do SLR. If this one is violated, we can still do SLR but need to be mindful about the scope of conclusions.-->
</li>
<li>Would a linear regression model reasonably summarize the relationship between the response and predictor variables?</li>
</ul>
<p>The last question can be more challenging to answer for multiple linear regression than it was in simple linear regression, because it is difficult to visualize the relationship between three or more variables in the exploratory data analysis. As we saw in <a href="#sec-mlr-eda" class="quarto-xref"><span>Section 7.1.1</span></a>, we can visualize the relationship between the response and each individual predictor. This can give us some indication of linearity and if there are non-linear trends that need to be taken into account (more on this in <a href="09-mlr-transformations.html" class="quarto-xref"><span>Chapter 9</span></a>). We will primarily rely on the assessment of the model conditions (<a href="08-mlr-inference.html#sec-mlr-conditions-diagnositics" class="quarto-xref"><span>Section 8.5</span></a>) to ultimately determine whether a linear model adequately captures the relationship between the response and predictor variables. <!--# maybe add a your turn or some discussion about whether it's appropriate to do MLR for lemurs data--></p>
</section></section><section id="sec-mlr-estimate-coef" class="level2" data-number="7.3"><h2 data-number="7.3" class="anchored" data-anchor-id="sec-mlr-estimate-coef">
<span class="header-section-number">7.3</span> Estimating the coefficients</h2>
<p>The predicted value <span class="math inline">\(Y\)</span> for the <span class="math inline">\(i^{th}\)</span> observation output from the estimated multiple linear regression is shown in <a href="#eq-mlr-estimated-model" class="quarto-xref">Equation&nbsp;<span>7.5</span></a> is</p>
<p><span id="eq-mlr-estimated-model"><span class="math display">\[
\hat{y}_i = \hat{\mu}_{y_i|x_{i1},x_{i2}, \ldots, x_{ip}} = \hat{\beta}_0 + \hat{\beta}_1x_{i1} + \hat{\beta}_2x_{i2} + \dots + \hat{\beta}_px_{ip}
\tag{7.5}\]</span></span></p>
<p>The error term for the <span class="math inline">\(i^{th}\)</span> observation, <span class="math inline">\(\epsilon_i\)</span>, is estimated by calculating the residuals as before, <span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>, the difference between what is observed in the data and what is expected from <a href="#eq-mlr-estimated-model" class="quarto-xref">Equation&nbsp;<span>7.5</span></a>. As with simple linear regression in <a href="04-slr.html#sec-slr-estimation" class="quarto-xref"><span>Section 4.4</span></a>, the coefficients are estimated using least-squares, finding <span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1, \ldots, \hat{\beta}_p\)</span> that minimize the sum of square residuals shown in <a href="#eq-mlr-min-sse" class="quarto-xref">Equation&nbsp;<span>7.6</span></a></p>
<p><span id="eq-mlr-min-sse"><span class="math display">\[
\sum_{i=1}^{n}e_i^2 = \sum_{i=1}^{n}(y_i - \hat{y}_i)^2 = \sum_{i=1}^n(y_i - [\beta_0 + \beta_1x_{i1} + \dots+ \beta_px_{ip}])^2
\tag{7.6}\]</span></span></p>
<section id="optional-matrix-notation-for-multiple-linear-regression" class="level3" data-number="7.3.1"><h3 data-number="7.3.1" class="anchored" data-anchor-id="optional-matrix-notation-for-multiple-linear-regression">
<span class="header-section-number">7.3.1</span> (Optional) Matrix notation for multiple linear regression</h3>
<!--# is there a more obvious way to mark optional text?-->
<!--# should all of this just go in the appendix?-->
<p>The calculus required to find the values that minimize <a href="#eq-mlr-min-sse" class="quarto-xref">Equation&nbsp;<span>7.6</span></a> can become quite cumbersome, <!--# word here to indicate it's a lot of work not necessarily hard-->particularly if there are a lot of predictor variables. We can instead think of <a href="#eq-mlr-stat-model-1" class="quarto-xref">Equation&nbsp;<span>7.3</span></a> and <a href="#eq-mlr-estimated-model" class="quarto-xref">Equation&nbsp;<span>7.5</span></a> in terms of matrices and utilize linear algebra and matrix calculus <!--# are these the correct terms or can i say matrix algebra and calculus?--> to compute the estimated coefficients. Suppose there are <span class="math inline">\(n\)</span> observations and <span class="math inline">\(p\)</span> predictors, then</p>
<p><span class="math display">\[
\mathbf{Y} = \begin{bmatrix}y_1 \\ y_2 \\ \vdots \\y_n\end{bmatrix} \hspace{10mm}
\mathbf{X} = \begin{bmatrix}1 &amp; x_{11} &amp; x_{12} &amp; \dots &amp; x_{1p} \\1&amp; x_{21} &amp; x_{22} &amp; \dots &amp; x_{2p} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\1&amp; x_{n1} &amp; x_{n2} &amp; \dots &amp; x_{np} \end{bmatrix}
\]</span></p>
<p>where <span class="math inline">\(\mathbf{Y}\)</span> is an <span class="math inline">\(n \times 1\)</span> vector of the values of the response, and <span class="math inline">\(\mathbf{X}\)</span> is an <span class="math inline">\(n \times (p + 1)\)</span> matrix called the <strong>design matrix</strong>. The first column of <span class="math inline">\(\mathbf{X}\)</span> is a vector of 1’s that correspond to the intercept <span class="math inline">\(\beta_0\)</span>. The remaining columns are the observed values for each predictor variable. For example, the row <span class="math inline">\(\begin{bmatrix} 1 &amp; x_{11}  &amp; x_{12} &amp;  \dots &amp; x_{1p} \end{bmatrix}\)</span> contains the observed values for the first observation, and</p>
<p>the column <span class="math inline">\(\begin{bmatrix} x_{11}  &amp; x_{21} &amp;  \dots &amp; x_{n1} \end{bmatrix}^\mathsf{T}\)</span> is the column of observed values for predictor <span class="math inline">\(X_1\)</span>.</p>
<p>Additionally, let</p>
<p><span class="math display">\[
\boldsymbol{\beta}= \begin{bmatrix}\beta_0 \\ \beta_1 \\ \vdots \\ \beta_p \end{bmatrix} \hspace{5mm}\boldsymbol{\epsilon}= \begin{bmatrix}\epsilon_1 \\ \epsilon_2 \\ \vdots \\ \epsilon_n \end{bmatrix}
\]</span></p>
<p>such that <span class="math inline">\(\boldsymbol{\beta}\)</span> is a <span class="math inline">\((p + 1) \times 1\)</span> vector of the model coefficients and <span class="math inline">\(\boldsymbol{\epsilon}\)</span> is an <span class="math inline">\(n \times 1\)</span> vector of the error terms. <a href="#eq-mlr-stat-model-1" class="quarto-xref">Equation&nbsp;<span>7.3</span></a> written in matrix notation is</p>
<p><span class="math display">\[
\underbrace{\begin{bmatrix}y_1 \\ y_2 \\ \vdots \\y_n\end{bmatrix}}_{\mathbf{Y}} =
\underbrace{\begin{bmatrix}1 &amp; x_{11} &amp; x_{12} &amp; \dots &amp; x_{1p} \\1&amp; x_{21} &amp; x_{22} &amp; \dots &amp; x_{2p} \\\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\1&amp; x_{n1} &amp; x_{n2} &amp; \dots &amp; x_{np} \end{bmatrix}}_{\mathbf{X}} \hspace{2mm}
\underbrace{\begin{bmatrix}\beta_0 \\ \beta_1 \\ \vdots \\ \beta_p \end{bmatrix}}_{\boldsymbol{\beta}}  +
\underbrace{\begin{bmatrix}\epsilon_1 \\ \epsilon_2 \\ \vdots \\ \epsilon_n \end{bmatrix}}_{\boldsymbol{\epsilon}}
\]</span></p>
<p><span id="eq-mlr-stat-model-matrix"><span class="math display">\[
\mathbf{Y} = \mathbf{X}\boldsymbol{\beta} + \boldsymbol{\epsilon}
\tag{7.7}\]</span></span></p>
<p>Similarly, <a href="#eq-mlr-estimated-model" class="quarto-xref">Equation&nbsp;<span>7.5</span></a> in matrix notation is</p>
<p><span class="math display">\[
\hat{\mathbf{Y}} = \mathbf{X}\boldsymbol{\hat{\beta}}
\]</span></p>
<p>Applying the rules of linear algebra and matrix calculus, we find that the estimated coefficients <span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1, \ldots, \hat{\beta}_p\)</span> can be found using <a href="#eq-mlr-est-beta-matrix" class="quarto-xref">Equation&nbsp;<span>7.8</span></a></p>
<p><span id="eq-mlr-est-beta-matrix"><span class="math display">\[
\boldsymbol{\hat{\beta}} = (\mathbf{X}^\mathsf{T}\mathbf{X})^{-1}\mathbf{X}^\mathsf{T} \mathbf{Y}
\tag{7.8}\]</span></span></p>
<p>Details for using the matrix form of the model to find <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> in <a href="#eq-mlr-est-beta-matrix" class="quarto-xref">Equation&nbsp;<span>7.8</span></a> are in <a href="appendix-linear.html#sec-mlr-estimation-matrix" class="quarto-xref"><span>Section A.3</span></a>.</p>
<div class="math_rules">
<p><strong>Matrix form of simple linear regression</strong></p>
<p>The design matrix <span class="math inline">\(\mathbf{X}\)</span> and the vector of coefficients <span class="math inline">\(\boldsymbol{\beta}\)</span> are indexed by the number of predictors <span class="math inline">\(p\)</span>. The number of predictors can be any value between 1 and <span class="math inline">\(n\)</span>, the number of observations<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Therefore, the linear regression computations in matrix form apply to simple linear regression as well.</p>
<p><br><br>
One way to practice using the matrix representation of the model is to compare the results from simple linear regression in <a href="04-slr.html#sec-slr-estimation" class="quarto-xref"><span>Section 4.4</span></a> to the results using matrix notation.</p>
</div>
</section></section><section id="sec-mlr-interpret" class="level2" data-number="7.4"><h2 data-number="7.4" class="anchored" data-anchor-id="sec-mlr-interpret">
<span class="header-section-number">7.4</span> Interpreting model coefficients</h2>
<p>The fitted model for explaining variability in the weight of young lemurs is in <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a>. We refer to this model as we interpret the model coefficients.</p>
<div class="cell">
<div id="tbl-lemurs-model" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.3: Output of model using various characteristics to explain variability in weight of young lemurs
</figcaption><div aria-describedby="tbl-lemurs-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">43.8</td>
<td style="text-align: right;">121.72</td>
<td style="text-align: right;">0.360</td>
<td style="text-align: right;">0.719</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">136.9</td>
<td style="text-align: right;">4.86</td>
<td style="text-align: right;">28.182</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-88.8</td>
<td style="text-align: right;">68.00</td>
<td style="text-align: right;">-1.306</td>
<td style="text-align: right;">0.193</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">471.7</td>
<td style="text-align: right;">95.43</td>
<td style="text-align: right;">4.943</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1037.3</td>
<td style="text-align: right;">133.91</td>
<td style="text-align: right;">7.747</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">-19.6</td>
<td style="text-align: right;">65.80</td>
<td style="text-align: right;">-0.298</td>
<td style="text-align: right;">0.766</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<section id="sec-mlr-interpret-quantitative" class="level3" data-number="7.4.1"><h3 data-number="7.4.1" class="anchored" data-anchor-id="sec-mlr-interpret-quantitative">
<span class="header-section-number">7.4.1</span> Interpreting coefficients of quantitative predictors</h3>
<p>The interpretation for coefficients of quantitative predictors is similar to the interpretation in simple linear regression in <a href="04-slr.html#sec-slr-interpret-coef" class="quarto-xref"><span>Section 4.5</span></a>. Given a quantitative predictor <span class="math inline">\(x_j\)</span>, its model coefficient <span class="math inline">\(\beta_j\)</span> is the slope describing the relationship between <span class="math inline">\(x_j\)</span> and the response variable, <em>after adjusting for the other predictors in the model</em>. For example, the coefficient for <code>age</code> in <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a> is 136.903. Let’s compare this to the coefficient from a simple linear regression model using age shown in <a href="#tbl-lemurs-age-model-slr" class="quarto-xref">Table&nbsp;<span>7.4</span></a>.</p>
<div class="cell">
<div id="tbl-lemurs-age-model-slr" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-age-model-slr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.4: Simple linear regression model of <code>weight</code> versus <code>age</code>
</figcaption><div aria-describedby="tbl-lemurs-age-model-slr-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">555</td>
<td style="text-align: right;">67.31</td>
<td style="text-align: right;">8.25</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">142</td>
<td style="text-align: right;">5.88</td>
<td style="text-align: right;">24.12</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>In the model in <a href="#tbl-lemurs-age-model-slr" class="quarto-xref">Table&nbsp;<span>7.4</span></a> that only uses <code>age</code> to predict <code>weight</code>, the weight is expected to increase by 141.892 grams, on average for each month increase in age. If we also take into account sex, taxon, and litter size in addition to age, then the weight is expected to increase by 136.903 grams, on average, as age increases by one month. This means some of the change in weight as age increases in <a href="#tbl-lemurs-age-model-slr" class="quarto-xref">Table&nbsp;<span>7.4</span></a> can be explained by the other predictors in <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a>.</p>
<p><br>
We write the interpretation of the coefficients in a multiple linear regression models in a way that indicates there are other variables being taken into account in the model. There are two commonly used ways to word this. The first is by interpreting the coefficient <span class="math inline">\(\beta_j\)</span> as the expected change in the response variable when <span class="math inline">\(x_j\)</span> increases by one unit, <em>adjusting for all other predictors in the model</em>. This interpretation means that once we have taken into account the relationship between all the other predictors and the response variable, then we have isolated the effect of the predictor <span class="math inline">\(x_j\)</span> and thus can explain the relationship between the response variable and the predictor <span class="math inline">\(x_j\)</span>. The second way is to specify that <em>all other predictors are held constant</em>. This means that if have two observations with the same values for all other predictors, then we see how the value of the response is expected to change between these two observations as <span class="math inline">\(x_j\)</span> changes. <!--# Add something noting that these are th same thing--></p>
<p>Let’s apply this to interpret <code>age</code> in the model in <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a>. The following are two acceptable forms of the interpretation:</p>
<blockquote class="blockquote">
<p><em>For each additional month in a young lemur’s age, their weight is expected to be greater by 136.903 grams, on average, adjusting for taxon, sex, and litter size.</em></p>
<p><em>For each additional month in a young lemur’s age, their weight is expected to be greater by 136.903 grams, on average, holding taxon, sex, and litter size constant.</em></p>
</blockquote>
<p>The phrase “holding all else constant” stems from the fact that multiple linear regression is conducted assuming the predictors are independent. Some argue, however, that it is not feasible for the predictors to be completely independent in practice, so the phrasing “adjusting for all other predictors” may better represent the model in practice. We will use both forms of the interpretation throughout the book. We talk more about more the relationship between the predictors in <a href="08-mlr-inference.html" class="quarto-xref"><span>Chapter 8</span></a>.</p>
<!--# this all seems very clunky. Maybe present one interpretation - look at some books and read that paper, then show the other in a callout box as an alternative.-->
<div class="yourturn">
<p>Interpret the coefficient <code>litter_size</code> in the context of the data.</p>
<p>Recall from <a href="04-slr.html#sec-slr-interpret-coef" class="quarto-xref"><span>Section 4.5</span></a>, “in the context of the data” means</p>
<ul>
<li>using the variable names or meaningful descriptions of the variables,</li>
<li>including the units in the interpretation, and</li>
<li>Indicating the population for which this model applies.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a>
</li>
</ul>
</div>
</section><section id="sec-mlr-interpret-categorical" class="level3" data-number="7.4.2"><h3 data-number="7.4.2" class="anchored" data-anchor-id="sec-mlr-interpret-categorical">
<span class="header-section-number">7.4.2</span> Interpreting coefficients of categorical predictors</h3>
<p>When categorical predictors are included in a model, we need a way to transform the levels (or categories) of the predictor into quantitative information that can be used in the regression calculations. To do so, <strong>indicator variable</strong>s are created for each level of the categorical predictor. We then use these indicator variables in the regression model.</p>
<p>Suppose we have a categorical variable that has <span class="math inline">\(k\)</span> levels. We define <span class="math inline">\(k\)</span> indicator variables, one for each level, such that the indicator takes the value <span class="math inline">\(1\)</span> if the observation belongs to the particular level and <span class="math inline">\(0\)</span> if the observation does not belong to the particular level. Let’s take a look at the variable <code>taxon</code> in the lemurs data.</p>
<!--# Key term: An indicator variable represents a specific level of a categorical variable. It takes the value 1 if an observation is in that level and 0 otherwise. Indicator variables are used for categorical predictors in a model.-->
<p>The variable <code>taxon</code> has three levels, ERUF, PCOQ, and VRUB, so we create three indicator variables. We will call these indicators <code>taxonERUF</code>, <code>taxonPCOQ</code>, and <code>taxonVRUB</code>. <a href="#tbl-indicators" class="quarto-xref">Table&nbsp;<span>7.5</span></a>, shows the number of observation at each level of the original variable <code>taxon</code> and the number of observations that take values 1 or 0 for each indicator variable.</p>
<div class="cell">
<div id="tbl-indicators" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-indicators-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.5: Indicator variables for taxon
</figcaption><div aria-describedby="tbl-indicators-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">taxon</th>
<th style="text-align: right;">taxonERUF</th>
<th style="text-align: right;">taxonPCOQ</th>
<th style="text-align: right;">taxonVRUB</th>
<th style="text-align: right;">n</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">48</td>
</tr>
<tr class="even">
<td style="text-align: left;">PCOQ</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">93</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VRUB</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">111</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Now we are ready to use the indicator variables in the model. In <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a>, we see there are only two indicator variables (not three) for <code>taxon</code> in the model. When there are <span class="math inline">\(k\)</span> levels of a categorical predictor, there are <span class="math inline">\(k-1\)</span> indicator variables for the categorical predictor included in the model. The level that does not have an indicator variable in the model is called the <strong>baseline level</strong> (this is also known as the <em>reference level</em>). Thus, the interpretation of the coefficients for indicator variables describe how much the expected response for a given level is expected to differ, on average, compared to the expected response at the baseline level, after adjusting for the other predictors in the model. <!--# or holding all other predictors constant.--></p>
<!--# ::: {.callout-note icon="false"} 
<!--# ## Why not put all $k$ indicators in the model?

\[Add content\]

<!--# Make note here about how this doesn't work mathematically.-->
<!--# Maybe conceptually, we can say with an intercept in the model, it doesn't make sense for all the indicators to be equal to 0.-->
<p>Let’s take a look at the indicator variables for <code>taxon</code> in <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a>. The baseline level is “ERUF”, the taxon that is not represented by an indicator variable in the model. Therefore, the interpretations of the coefficients for <code>taxonPCOQ</code> and <code>taxonVRUB</code> will be how the weights for young lemurs in those taxa are expected to differ, on average, to the weight for lemurs in the ERUF taxon, after adjusting for age, sex, and litter size.</p>
<blockquote class="blockquote">
<p><em>The coefficient for the PCOQ taxon is</em> <span class="math inline">\(\hat{\beta}_{PCOQ} =\)</span> <em>471.715. This means that the expected weight is 471.715 grams greater, on average, for lemurs in the PCOQ taxon compared to the expected weight for lemurs in the ERUF taxon, holding age, sex, and litter size constant.</em></p>
<p><em>The coefficient for the VRUB taxon is</em> <span class="math inline">\(\hat{\beta}_{VRUB} =\)</span> <em>1037.323. This means that the expected weight is 1037.323 grams greater, on average, for lemurs in the VRUB taxon compared to the expected weight for lemurs in the ERUF taxon, holding age, sex, and litter size constant.</em></p>
</blockquote>
<div class="analysis_in_practice">
<p>The code in <span class="quarto-unresolved-ref">?sec-mlr-estimate-R</span> shows that we only need to put the name of the categorical predictor into the <code>lm</code> function for fitting the model. R (and other statistical software) will create indicator variables behind the scenes and selects the baseline level as the following:</p>
<ul>
<li><p>If the categorical predictor is nominal (it has no inherent order like <code>taxon</code>), then R chooses the first level alphabetically to be the baseline. R made ERUF the baseline level for <code>taxon</code>, because it is first alphabetically in the list of ERUF, PCOQ, and VRUB.</p></li>
<li><p>If the categorical predictor is ordinal (there is some order imposed), then R chooses the lowest level to be the baseline.</p></li>
</ul>
<p>As the data scientists, we can determine which level we would like to be the baseline level if neither of these approaches align well with the data. To do so, use functions to impose an ordering with the desired baseline as the first level.</p>
</div>
<p>Indicator variables in the model describe how much the intercept of the model shifts based on the levels of the categorical variable. The intercept term in the model is the intercept associated with the baseline level for the categorical predictor. This means the intercepts for <code>taxon</code> are the following:</p>
<ul>
<li><p>ERUF: 43.844</p></li>
<li><p>PCOQ: 515.559 (43.844 + 471.715)</p></li>
<li><p>VRUB: 1081.167 (43.844 + 1037.323 )</p></li>
</ul>
<p>This shift in the intercept is visually represented in the scatterplot of <code>age</code> versus <code>weight</code> by <code>taxon</code> in <a href="#fig-lemur-intercepts" class="quarto-xref">Figure&nbsp;<span>7.5</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-lemur-intercepts" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lemur-intercepts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-lemur-intercepts-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13" title="Figure&nbsp;7.5: Different intercepts for each taxon. Purple dotted line = ERUF, Pink dashed line = PCOQ, Yellow sold line = VRUF"><img src="07-mlr_files/figure-html/fig-lemur-intercepts-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lemur-intercepts-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.5: Different intercepts for each taxon. Purple dotted line = ERUF, Pink dashed line = PCOQ, Yellow sold line = VRUF
</figcaption></figure>
</div>
</div>
</div>
<!--# this point about the intercepts maybe need to be moved to the next section-->
<div class="yourturn">
<p>The other categorical predictor in the model in <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a> is <code>sex</code>.</p>
<ul>
<li>What is the baseline level for <code>sex</code>?</li>
<li>Interpret the coefficient of <code>sex</code> in the context of the data.</li>
<li>What is the intercept for female lemurs? For male lemurs?<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a>
</li>
</ul>
</div>
</section><section id="sec-intercept" class="level3" data-number="7.4.3"><h3 data-number="7.4.3" class="anchored" data-anchor-id="sec-intercept">
<span class="header-section-number">7.4.3</span> Interpreting the intercept</h3>
<p>As with simple linear regression, the intercept is the expected value of the response when all predictors in the model equal 0. Let’s take a look at what this means for our model in <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a>. The intercept is at the point such that</p>
<!--# make sure these match the tidytuesday definitions-->
<ul>
<li>
<code>age = 0</code>: The lemur is 0 months old at the time of the weight</li>
<li>
<code>sexM = 0</code>: The lemur is female.</li>
<li>
<code>taxonPCOQ = 0</code> and <code>taxonVRUB = 0</code>: The lemur is from the ERUF taxon. (See <a href="#tbl-indicators" class="quarto-xref">Table&nbsp;<span>7.5</span></a> to confirm this)</li>
<li>
<code>litter_size = 0</code>: There were 0 lemurs in the litter size in which the lemurs born. (Note that this is not a possible in the data set).</li>
</ul>
<p>Based on the model, the expected weight for such lemurs is about 43.844 grams.</p>
<p>Putting this together in narrative form, we have</p>
<blockquote class="blockquote">
<p>The expected weight for female lemurs from the ERUF taxon who are 0 months old at the time of weight and were born into a litter with 0 lemurs is about 43.844 grams.</p>
</blockquote>
<p>As in SLR, we need the intercept to get the least-squares model. The intercept, however, does not always have a meaningful interpretation in practice. Therefore, as with simple linear regression, the intercept has a meaningful interpretation when the following are true:</p>
<ol type="1">
<li><p>The scenario described by <u><strong>all</strong></u> the predictors in the model being at or near zero is plausible in practice.</p></li>
<li><p>The data used to fit the model includes observations in which <u><strong>all</strong></u> the predictors are at or near zero.</p></li>
</ol>
<div class="yourturn">
<p>Based on these criteria, do you think the interpretation of the intercept is meaningful for the lemurs data? Why or why not?<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
</div>
</section></section><section id="prediction" class="level2" data-number="7.5"><h2 data-number="7.5" class="anchored" data-anchor-id="prediction">
<span class="header-section-number">7.5</span> Prediction</h2>
<p>The same process is used to predict for multiple linear regression as the one introduced in <a href="04-slr.html#sec-slr-predict" class="quarto-xref"><span>Section 4.6</span></a> for simple linear regression. Now that there are two or more predictor variables, we need to input a value for every predictor variable.</p>
<p>For example, suppose we wish to use the model in <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a> to compute the predicted weight for a 10-month old male lemur in the VRUB taxon who was born into a litter of 4 lemurs. We compute this value by plugging in the value for the new observation into the model equation as shown in <a href="#eq-lemurs-predict" class="quarto-xref">Equation&nbsp;<span>7.9</span></a>.<br></p>
<p><span id="eq-lemurs-predict"><span class="math display">\[
\begin{aligned}
\widehat{\text{weight\_g}} &amp;= 43.844 \\ &amp;+ 136.903 \times 10 \\ &amp;- 88.838 \times 1 \\ &amp;+ 471.715 \times 0 \\ &amp;+ 1037.323 \times 1 \\ &amp;- 19.607 \times 4 \\
&amp; = 2282.931
\end{aligned}
\tag{7.9}\]</span></span></p>
<div class="yourturn">
<p>Use the equation in <a href="#tbl-lemurs-model" class="quarto-xref">Table&nbsp;<span>7.3</span></a> to compute the predicted value for a 14-month old female lemur in the ERUF taxon who was born into a litter of 2 lemurs. It should match the predicted value shown it the output above.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
</div>
<p>It is important to avoid extrapolation when making predictions using a multiple linear regression model. This can sometimes to be challenging to assess, as extrapolation might occur both in terms of a single predictor variable being far outside the range in the data but also in terms of a combination of predictors being outside the general patterns observed in the data. When working with real-world data, we can consider if the combination of predictor values can be realistically observed in the population being studied. If that is the case, and the data are representative of the population, then the combination of values if likely to be within the trend represented in the data.</p>
<p>One more consideration for prediction is that we expect there to be some uncertainty in the predicted values, because they are computed based on a model fit using sample data. <!--# We will discuss this uncertainty further in @sec-ch-mlr-inf.--> <!--# need to add something about prediction intervals--></p>
</section><section id="sec-other-predictors" class="level2" data-number="7.6"><h2 data-number="7.6" class="anchored" data-anchor-id="sec-other-predictors">
<span class="header-section-number">7.6</span> Centered and standardized predictors</h2>
<!--# insert some intro sentences-->
<section id="centered-quantitative-predictors" class="level3" data-number="7.6.1"><h3 data-number="7.6.1" class="anchored" data-anchor-id="centered-quantitative-predictors">
<span class="header-section-number">7.6.1</span> Centered quantitative predictors</h3>
<!--# make a note here that it is called centering because we are changing the center of the data but not rescaling it-->
<!--# do i make the point anywhere that centering doesn't not change the units of the variable-->
<p>We need an intercept to fit the least-squares regression model, but it may not have a meaningful interpretation as seen in the example in <a href="#sec-intercept" class="quarto-xref"><span>Section 7.4.3</span></a>. This is usually because it is not meaningful or realistic for a quantitative variable to take values at or near zero. One way to remedy this is to shift the distribution of one or more quantitative predictors, such that it would be feasible for the shifted predictors to take values near zero. This process is called centering.</p>
<!--# is it always called centering if we're just shifting the variable? -->
<p><strong>Centering</strong> a predictor means to shift every observation of that predictor by a single constant, denoted <span class="math inline">\(C\)</span>. For example, given a predictor <span class="math inline">\(X\)</span>, then the centered version of the predictor is <span class="math inline">\(X_{cent} = X - C\)</span>. Thus when <span class="math inline">\(X_{cent}\)</span> is a predictor in the model (instead of <span class="math inline">\(X\)</span>), then the intercept is now the expected response when <span class="math inline">\(X_{cent} = X - C = 0\)</span>, which occurs when <span class="math inline">\(X = C\)</span>.</p>
<p>In the previous section, we determined that it is not possible for the litter size to be 0, because the litter size includes the observed lemur. Therefore, we can use centering to create a new variable <code>litter_size_cent</code> by shifting <code>litter_size</code> by 1, so that <code>litter_size_cent = 0</code> means <code>litter_size = 1</code> . Though it is not always the case, the newly centered variable <code>litter_size_cent</code> has a new meaningful interpretation. It is the number of siblings of in the litter. Putting this together, <code>litter_size_cent</code> = 0 means the lemur was born into a litter with no siblings.</p>
<p>Because this centered variable has its own meaningful interpretation, we will rename the variable to more clearly indicate what this variable is measuring. We call the centered variable <code>litter_size_siblings</code> and use this name for the centered variable moving forward. The distributions of the original and centered variables are shown in <a href="#fig-centering" class="quarto-xref">Figure&nbsp;<span>7.6</span></a> and <a href="#tbl-centering" class="quarto-xref">Table&nbsp;<span>7.6</span></a>.</p>
<div id="fig-centering" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-centering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-centering" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-centering-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-centering-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-centering-1.png" class="lightbox" data-gallery="fig-centering" title="Figure&nbsp;7.6&nbsp;(a): Distribution of litter_size"><img src="07-mlr_files/figure-html/fig-centering-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-centering"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-centering-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Distribution of <code>litter_size</code>
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-centering" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-centering-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-centering-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-centering-2.png" class="lightbox" data-gallery="fig-centering" title="Figure&nbsp;7.6&nbsp;(b): Distribution of litter_size_siblings"><img src="07-mlr_files/figure-html/fig-centering-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-centering"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-centering-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Distribution of <code>litter_size_siblings</code>
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-centering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.6: Original versus centered values of <code>litter_size</code>
</figcaption></figure>
</div>
<div class="cell">
<div id="tbl-centering" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-centering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.6: Distributions of <code>litter_size</code> vs <code>litter_size_siblings</code>
</figcaption><div aria-describedby="tbl-centering-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Median (Q2)</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">1.7</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size_siblings</td>
<td style="text-align: right;">0.7</td>
<td style="text-align: right;">0.9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>From <a href="#fig-centering" class="quarto-xref">Figure&nbsp;<span>7.6</span></a> and <a href="#tbl-centering" class="quarto-xref">Table&nbsp;<span>7.6</span></a>, we see that the only statistics that have changed are those about location (e.g., <span class="math inline">\(Q1\)</span>, <span class="math inline">\(Q3\)</span>, min, max) and those related the center (mean and median). The shape of the distribution and statistics regarding the spread (standard deviation and IQR) have remained the same after centering. By centering the variable we have essentially moved the distribution along the number line by some constant amount.</p>
<p><a href="#fig-centering-bivariate" class="quarto-xref">Figure&nbsp;<span>7.7</span></a> shows the relationship between weight versus the original and centered values of <code>litter_size</code>. Both plots have the same slope, illustrating that the slope of the relationship between the predictor and response has not changed by centering. All that has changed is what in means to be “zero”, what observations whose expected response is at the intercept. This is illustrated by the different intercepts for the models shown in the two plots.</p>
<!--# is it an accessibility issue to have the equations in the plots?-->
<div id="fig-centering-bivariate" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-centering-bivariate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-centering-bivariate" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-centering-bivariate-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-centering-bivariate-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-centering-bivariate-1.png" class="lightbox" data-gallery="fig-centering-bivariate" title="Figure&nbsp;7.7&nbsp;(a): weight versus litter_size"><img src="07-mlr_files/figure-html/fig-centering-bivariate-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-centering-bivariate"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-centering-bivariate-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) <code>weight</code> versus <code>litter_size</code>
</figcaption></figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-centering-bivariate" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-centering-bivariate-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure"><div aria-describedby="fig-centering-bivariate-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-centering-bivariate-2.png" class="lightbox" data-gallery="fig-centering-bivariate" title="Figure&nbsp;7.7&nbsp;(b): weight versus litter_size_siblings"><img src="07-mlr_files/figure-html/fig-centering-bivariate-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-centering-bivariate"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-centering-bivariate-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) <code>weight</code> versus <code>litter_size_siblings</code>
</figcaption></figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-centering-bivariate-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.7: Weight versus original and centered values of litter size
</figcaption></figure>
</div>
<p>A commonly used type of centering is <strong>mean-centering</strong>, in which <span class="math inline">\(C = \bar{X}\)</span>, meaning a quantitative predictor is shifted by its mean. Let’s mean-center <code>age</code>, so that the intercept does not represent lemurs who are 0 months old, but rather lemurs are who are the mean age in the data set.</p>
<p><span class="math display">\[\text{age\_cent} = \text{age} - \text{mean(age)}
\]</span></p>
<p><a href="#tbl-age-cent-summary" class="quarto-xref">Table&nbsp;<span>7.7</span></a> is a table of the summary statistics for the <code>age</code> and <code>age_cent</code>. As before, the location statistics have changed but the variability is the same.</p>
<div class="cell">
<div id="tbl-age-cent-summary" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-age-cent-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.7: Distributions of <code>age</code> and <code>age_cent</code>
</figcaption><div aria-describedby="tbl-age-cent-summary-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Median (Q2)</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Max</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">age</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0.6</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">7.1</td>
<td style="text-align: right;">15.6</td>
<td style="text-align: right;">23.9</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_cent</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">-8.5</td>
<td style="text-align: right;">-6.3</td>
<td style="text-align: right;">-2.0</td>
<td style="text-align: right;">6.6</td>
<td style="text-align: right;">14.9</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Note that we do not mean-center the categorical predictors <code>sex</code> and <code>taxon</code>, because there is already a meaningful interpretation for the indicator variables for these predictors being equal to 0, and there is not a realistic notion of the “average taxon” or “average sex”. Unlike the categorical predictors, we could mean-center <code>litter_size</code> as well.; however, we created the new variable <code>litter_size_siblings</code> by shifting by 1.</p>
<!--# Key terms: Centering a variable is the process of shifting each observation by a constant amount $(X_{cent} = X - C$) -->
<p>.</p>
<!--# Mean-centering a variable is the process of shifting each observation by the variable's mean ( $X_{mean-cent} = X - \bar{X}$)-->
<p>The output for the model with <code>age_cent</code> and <code>litter_size_siblings</code>, the centered and litter size respectively, is is in <a href="#tbl-lemurs-model-centered" class="quarto-xref">Table&nbsp;<span>7.8</span></a> .</p>
<div class="cell">
<div id="tbl-lemurs-model-centered" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-model-centered-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.8: Model for lemurs data with centered quantitative predictors
</figcaption><div aria-describedby="tbl-lemurs-model-centered-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">1263.2</td>
<td style="text-align: right;">81.59</td>
<td style="text-align: right;">15.482</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_cent</td>
<td style="text-align: right;">136.9</td>
<td style="text-align: right;">4.86</td>
<td style="text-align: right;">28.182</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-88.8</td>
<td style="text-align: right;">68.00</td>
<td style="text-align: right;">-1.306</td>
<td style="text-align: right;">0.193</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">471.7</td>
<td style="text-align: right;">95.43</td>
<td style="text-align: right;">4.943</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1037.3</td>
<td style="text-align: right;">133.91</td>
<td style="text-align: right;">7.747</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size_siblings</td>
<td style="text-align: right;">-19.6</td>
<td style="text-align: right;">65.80</td>
<td style="text-align: right;">-0.298</td>
<td style="text-align: right;">0.766</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<!--# add note to code that you can also mean-center by using the scale function-->
<p>A comparison of the model coefficients from the original model and the model with the mean-centered values for the quantitative predictors is shown in <a href="#tbl-lemurs-model-compare" class="quarto-xref">Table&nbsp;<span>7.9</span></a>. Let’s consider in what ways the two models are the same and in what ways they are different.</p>
<div class="cell">
<div id="tbl-lemurs-model-compare" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-model-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.9: Model coefficients for original model and model with centered quantitative predictors
</figcaption><div aria-describedby="tbl-lemurs-model-compare-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Original</th>
<th style="text-align: right;">Centered</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">43.8</td>
<td style="text-align: right;">1263.2</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">136.9</td>
<td style="text-align: right;">136.9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-88.8</td>
<td style="text-align: right;">-88.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">471.7</td>
<td style="text-align: right;">471.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1037.3</td>
<td style="text-align: right;">1037.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">-19.6</td>
<td style="text-align: right;">-19.6</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The only term that changed between the two models is the intercept; the coefficients for all other predictors remained the same. This shows that centering one or more quantitative predictors, by shifting by the mean or some other constant, does not change the relationships between the predictor variables with the response variable. With this in mind, let’s interpret the intercept for the model with the centered variables.</p>
<p>As before, the intercept is the expected weight when all the predictors are equal to 0. Thus, using the model in <a href="#tbl-lemurs-model-centered" class="quarto-xref">Table&nbsp;<span>7.8</span></a>, the intercept is the expected weight when</p>
<ul>
<li><p><code>age_cent = 0</code>: The lemur is the mean age in the sample, 9.05 months old.</p></li>
<li><p><code>sexM = 0</code>: The lemur is female.</p></li>
<li><p><code>taxonPCOQ = 0</code> and <code>taxonVRUB = 0</code>: The lemur is from the ERUF taxon.</p></li>
<li><p><code>litter_size_siblings = 0</code>: The lemur was born into a litter with 0 other lemurs (<code>litter_size = 1</code>).</p></li>
</ul>
<!--# OLD TEXT: Before we write the full interpretation, let's see why age_at_weight_mo and litter_size are at the mean values when we interpret the intercept. --><!--# OLD TEXT: insert latex showing the quick equation--><!--# OLD TEXT: The same holds true for litter_size. --><p>The interpretation of the intercept in narrative form when the quantitative predictors are centered is</p>
<blockquote class="blockquote">
<p><em>The expected weight for female lemurs from the ERUF taxon who are 9.05 months old and were born into a litter with no siblings is about 1263.178 grams.</em></p>
</blockquote>
<p>Because the coefficients for the other predictors are the same, the interpretations for these predictors are the same as in <a href="#sec-mlr-interpret-quantitative" class="quarto-xref"><span>Section 7.4.1</span></a> and <a href="#sec-mlr-interpret-categorical" class="quarto-xref"><span>Section 7.4.2</span></a>.</p>
</section><section id="standardized-quantitative-predictors" class="level3" data-number="7.6.2"><h3 data-number="7.6.2" class="anchored" data-anchor-id="standardized-quantitative-predictors">
<span class="header-section-number">7.6.2</span> Standardized quantitative predictors</h3>
<p>Thus far, we have interpreted the coefficients to understand the relationship between the response and each predictor variable. Sometimes, however, the primary objective of the analysis may be less focused on interpretation and more focused on identifying which predictors are most important in understanding variability in the response variable. When that is the case, we can fit a model using standardized values of the quantitative predictors.</p>
<!--# Add something about why we can't compare across scales for original variables.-->
<p><strong>Standardizing</strong> a variable is shifting every observation of that variable by its mean (as in mean-centering) and dividing by its standard deviation. Thus, given a quantitative predictor <span class="math inline">\(X\)</span>, the standardized value of <span class="math inline">\(X\)</span>, denoted <span class="math inline">\(X_{std}\)</span>, is</p>
<p><span class="math display">\[
X_{std} = \frac{X - \bar{X}}{s_X}
\]</span></p>
<p>where <span class="math inline">\(\bar{X}\)</span> is the mean of <span class="math inline">\(X\)</span> and <span class="math inline">\(s_{X}\)</span> is the standard deviation of <span class="math inline">\(X\)</span>. In addition to shifting the centered of the new distribution to be equal to 0, the standardized variable is rescaled such the standard deviation (and variance) of the standardized variable is 1. This is similar to computing a <span class="math inline">\(z\)</span>- score from the normal distribution.</p>
<!--# Key term: Standardizing a variable is shifting it by its mean and dividing by its standard deviation-->
<!--# $$
X_{std} = \frac{X - \bar{X}}{s_X}
$$-->
<p>Unlike centering, standardizing a variable changes its units, because it is rescaled by the standard deviation. Therefore, the units are no longer the original units but rather the number of standard deviations an observation is away from the mean value. Because the units have changed, the value (but not the sign!) of the coefficient for standardized variables will change as well. <a href="#tbl-lemurs-model-std" class="quarto-xref">Table&nbsp;<span>7.10</span></a> shows the output of the model using standardized coefficients for <code>age</code> and <code>litter_size</code>. Similar to centering, we only standardize quantitative predictors, as there is no meaningful notion of “average” or “standard deviation” for categorical predictors such as <code>taxon</code> or <code>sex</code>.</p>
<div class="cell">
<div id="tbl-lemurs-model-std" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-model-std-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.10: Model with standardized coefficients for quantitative predictors
</figcaption><div aria-describedby="tbl-lemurs-model-std-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">1249.0</td>
<td style="text-align: right;">89.4</td>
<td style="text-align: right;">13.978</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">age_at_wt_std</td>
<td style="text-align: right;">960.1</td>
<td style="text-align: right;">34.1</td>
<td style="text-align: right;">28.182</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-88.8</td>
<td style="text-align: right;">68.0</td>
<td style="text-align: right;">-1.306</td>
<td style="text-align: right;">0.193</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">471.7</td>
<td style="text-align: right;">95.4</td>
<td style="text-align: right;">4.943</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1037.3</td>
<td style="text-align: right;">133.9</td>
<td style="text-align: right;">7.747</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size_std</td>
<td style="text-align: right;">-18.1</td>
<td style="text-align: right;">60.8</td>
<td style="text-align: right;">-0.298</td>
<td style="text-align: right;">0.766</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Now let’s compare the model with standardized quantitative predictors to the original model and the model using centered quantitative predictors. <a href="#tbl-lemurs-model-compare-pt2" class="quarto-xref">Table&nbsp;<span>7.11</span></a> shows the comparison of these models.</p>
<div class="cell">
<div id="tbl-lemurs-model-compare-pt2" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-model-compare-pt2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.11: Model coefficients for original model, model with centered quantitiatve predictors, and model with standardized quantitative predictors
</figcaption><div aria-describedby="tbl-lemurs-model-compare-pt2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">Term</th>
<th style="text-align: right;">Original</th>
<th style="text-align: right;">Centered</th>
<th style="text-align: right;">Standardized</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">43.8</td>
<td style="text-align: right;">1263.2</td>
<td style="text-align: right;">1249.0</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">136.9</td>
<td style="text-align: right;">136.9</td>
<td style="text-align: right;">960.1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-88.8</td>
<td style="text-align: right;">-88.8</td>
<td style="text-align: right;">-88.8</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">471.7</td>
<td style="text-align: right;">471.7</td>
<td style="text-align: right;">471.7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1037.3</td>
<td style="text-align: right;">1037.3</td>
<td style="text-align: right;">1037.3</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">-19.6</td>
<td style="text-align: right;">-19.6</td>
<td style="text-align: right;">-18.1</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="yourturn">
<p>The coefficients for <code>sexM</code> , <code>taxonPCOQ</code>, and <code>taxonVRUB</code> are the same across all three models. Why do these coefficients stay the same?<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
</div>
<p>The interpretation for the standardized predictors is in terms of a one standard deviation (one “unit”) increase in the predictor. Below is the interpretation of the coefficient of <code>age_std</code>, the standardized value of <code>age</code>.</p>
<blockquote class="blockquote">
<p><em>For every one standard deviation increase in the age, the weight of lemurs is expected to increase by 960.139 grams, on average, holding taxon, sex, and litter size constant.</em></p>
</blockquote>
<p>Though this interpretation is technically correct, it is not meaningful to the reader to merely say a “one standard deviation increase”. Therefore, we can use the exploratory data analysis in <a href="#tbl-mlr-response" class="quarto-xref">Table&nbsp;<span>7.1</span></a> to be more specific about how much a one standard deviation increase in the age is and make this interpretation more easily understood to readers.</p>
<blockquote class="blockquote">
<p><em>For every 7 months increase in age, the weight of lemurs is expected to increase by 960.139 grams, on average, holding taxon, sex, and litter size constant.</em></p>
</blockquote>
<p>We often standardize predictors when we want to identify which predictors are most important in explaining variability in the response variable. Because all the quantitative predictors are now on the same scale, we can look at the magnitude of the coefficients to rank the predictors in terms of importance. <!--# make sure this is true in terms of categorical predictors--> From the coefficients in <a href="#tbl-lemurs-model-std" class="quarto-xref">Table&nbsp;<span>7.10</span></a>, we see that <code>taxonVRUB</code> is the most important predictor, because it has the coefficient with the highest magnitude, i.e., the highest absolute value. This means that just knowing the lemur is from the VRUB taxon results in the largest expected change in the weight, on average, even after adjusting for the other predictors.</p>
<div class="yourturn">
<p>Based on <a href="#tbl-lemurs-model-std" class="quarto-xref">Table&nbsp;<span>7.10</span></a>, which predictor is the least important for predicting the weight of lemurs?<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
</div>
</section></section><section id="sec-mlr-interaction" class="level2" data-number="7.7"><h2 data-number="7.7" class="anchored" data-anchor-id="sec-mlr-interaction">
<span class="header-section-number">7.7</span> Interaction terms</h2>
<!--# do i call these interaction effects or terms? -->
<!--# I could move this section before transformations and higher-order terms. Could also move those sections to a different chapter?-->
<p>Thus far, we have fit models in which the coefficient of each predictor is the same for all lemurs. What if, however, the effect of one predictor on the response variable differed by values of another predictor? For example, what if the relationship between age and weight differed based on the lemur’s taxon? Or what if the relationship between litter size and weight differed by age? Or what if the relationship between sex and weight differed by taxon? We can explore all of these, and similar, questions by including interaction terms in the regression model.</p>
<p>Sometimes the relationship between one predictor and the response variable differs based on values of another predictor variable. We account for this difference by including <strong>interaction terms</strong> in the regression model. There are three types of interaction terms between two variables: interaction between a quantitative and categorical predictor, interaction between two categorical predictors, and interaction between two quantitative predictors. We discuss all three types of potential interaction terms here. Note, however, we most often include interaction terms involving a categorical predictor, because we want to account for the unique relationship between the response and predictor variable for different subgroups of the population.</p>
<!--# Key term: An interaction term quantifies how much the relationship between the response and one predictor differs based on values of another predictor.-->
<!--# add something here that shows that interactions are one variable multiplied by another -->
<section id="interaction-between-a-quantitative-and-a-categorical-predictor" class="level3" data-number="7.7.1"><h3 data-number="7.7.1" class="anchored" data-anchor-id="interaction-between-a-quantitative-and-a-categorical-predictor">
<span class="header-section-number">7.7.1</span> Interaction between a quantitative and a categorical predictor</h3>
<p>Do different types of lemurs grow at different rates? We can explore this question by looking at the relationship between weight and age and how that differs (or not) by taxon. Before fitting the models, we can use exploratory data analysis to get an initial understanding about the relationship between age and weight for each taxon. In <a href="#sec-mlr-eda" class="quarto-xref"><span>Section 7.1.1</span></a>, we used univariate and bivariate exploratory data analysis to explore one variable and two variables, respectively. Now when we look at potential interaction effects, we use multivariate exploratory data analysis as introduced in <a href="03-eda.html" class="quarto-xref"><span>Chapter 3</span></a>.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-lemurs-age-taxon-int" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lemurs-age-taxon-int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-lemurs-age-taxon-int-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18" title="Figure&nbsp;7.8: Multivariate EDA to explore potential interaction effect between age and taxon"><img src="07-mlr_files/figure-html/fig-lemurs-age-taxon-int-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lemurs-age-taxon-int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.8: Multivariate EDA to explore potential interaction effect between <code>age</code> and <code>taxon</code>
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-lemurs-age-taxon-int" class="quarto-xref">Figure&nbsp;<span>7.8</span></a> shows the relationship between <code>age</code> and <code>weight</code> by <code>taxon</code>. Based on the lines, it appears that there is some difference in the relationship between age and weight depending on the taxon, as the slopes of the lines appear to differ. Thus, the plot suggests a potential interaction effect that is worth exploring in the model. If there was no potential interaction effect, then the lines would be parallel (i.e., the same slope). As with any exploratory data analysis, we do not use this plot to conclude whether or not there is an interaction effect; we will use the regression model and statistical inference for those purposes. This plot provides some intuition and guidance of what we might expect as we look at the results of the regression model.</p>
<div class="yourturn">
<p>Lemurs from which taxon appear to grow at the fastest rate?<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
</div>
<div class="cell">
<div id="tbl-lemurs-age-taxon-int-model" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-age-taxon-int-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.12: Output for regression model including interaction between age and taxon
</figcaption><div aria-describedby="tbl-lemurs-age-taxon-int-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">578.8</td>
<td style="text-align: right;">135.43</td>
<td style="text-align: right;">4.274</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">78.6</td>
<td style="text-align: right;">9.95</td>
<td style="text-align: right;">7.900</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-85.2</td>
<td style="text-align: right;">60.97</td>
<td style="text-align: right;">-1.398</td>
<td style="text-align: right;">0.163</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">-355.7</td>
<td style="text-align: right;">134.37</td>
<td style="text-align: right;">-2.647</td>
<td style="text-align: right;">0.009</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">634.0</td>
<td style="text-align: right;">162.69</td>
<td style="text-align: right;">3.897</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">-36.9</td>
<td style="text-align: right;">58.64</td>
<td style="text-align: right;">-0.629</td>
<td style="text-align: right;">0.530</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age:taxonPCOQ</td>
<td style="text-align: right;">96.1</td>
<td style="text-align: right;">12.05</td>
<td style="text-align: right;">7.971</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">age:taxonVRUB</td>
<td style="text-align: right;">49.4</td>
<td style="text-align: right;">11.96</td>
<td style="text-align: right;">4.125</td>
<td style="text-align: right;">0.000</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The model wit the interaction between <code>age</code> and <code>taxon</code> is in <a href="#tbl-lemurs-age-taxon-int-model" class="quarto-xref">Table&nbsp;<span>7.12</span></a>. The interaction terms are indicated in the output in the format <code>var1:var2</code>; for example, the interaction term of <code>age</code> for the PCOQ taxon is labeled as <code>age:taxonPCOQ</code>. This individual term is an estimate of how much the slope of <code>age</code> differs between the taxa PCOQ and ERUF, the baseline. Thus, the interpretation is</p>
<blockquote class="blockquote">
<p><em>The slope of age for lemurs in the PCOQ taxon is about 96.085 greater for lemurs in PCOQ compared to lemurs in the ERUF taxon. This means for each additional month older a lemur is, the weight of a PCOQ lemur is expected to increase by 96.085 grams <u><strong>more</strong></u>, on average, compared to an ERUF lemur, holding sex and litter size constant.</em></p>
</blockquote>
<p>This interpretation aligns with the steep slope of the line for the PCOQ species in <a href="#fig-lemurs-age-taxon-int" class="quarto-xref">Figure&nbsp;<span>7.8</span></a>. Note from the interpretation that coefficient of the interaction effect is how much the relationship between age and weight differ for the PCOQ species compared to the ERUF species, but it is <u><strong>not</strong></u> the overall relationship between age and weight for PCOQ lemurs. To get that value, we must add the main effect of age (<code>age</code>) and the interaction effect (<code>age:taxonPCOQ</code>).</p>
<blockquote class="blockquote">
<p><em>The overall slope of age for PCOQ lemurs is 174.664 (78.579 + 96.085 ). This means that among PCOQ lemurs, for each additional month in age, the weight is expected to be greater by 174.664 grams, on average, holding sex and litter size constant.</em></p>
</blockquote>
<div class="yourturn">
<p>What is the slope of <code>age</code> for lemurs in the VRUB taxon? Interpret it in the context of the data.<a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a></p>
</div>
<p>By now we have quantified the relationship between age and weight for PCOQ and VRUB lemurs, but what about this relationship for ERUF lemurs, the baseline category? The interaction effect <code>age:taxonPCOQ</code> is the adjustment in the slope of age for PCOQ lemurs; the same is true about <code>age:taxonVRUB</code> for VRUB lemurs. Therefore, neither of these interaction effects apply to ERUF lemurs. Putting all this together, the coefficient of <code>age</code> for ERUF lemurs is 78.579. The term in the model <code>age</code> is called a <strong>main effect</strong>, because it describes the relationship between the response and predictor variable (among the baseline subgroup). The terms <code>age:taxonPCOQ</code> and <code>age:taxonVRUB</code> called <strong>interaction effects</strong>, because they are how much the relationship between the response and one predictor differs by values of another predictor.</p>
<!--# Key terms: The main effect is the term in the model quantifying the relationship between the response and predictor. This effect could apply all observations or a subgroup of observations.-->
<!--# The interaction is the term in the model quantifying how much the relationship between the response and one predictor variable differs based on values of another predictor variable.-->
<!--# need to address the fact that we should use log(age)-->
<div class="analysis_in_practice">
<p>We used the original variables <code>age</code> and <code>litter_size</code> in this section; however, everything we’ve shown about interaction terms also applies to centered and standardized variables.</p>
</div>
</section><section id="interaction-between-two-categorical-predictors" class="level3" data-number="7.7.2"><h3 data-number="7.7.2" class="anchored" data-anchor-id="interaction-between-two-categorical-predictors">
<span class="header-section-number">7.7.2</span> Interaction between two categorical predictors</h3>
<p>Another type of interaction effect is between two categorical predictors. Let’s consider the interaction between <code>taxon</code> and <code>sex</code> for this data. We might include this interaction effect if we want to explore whether the relationship between sex and weight differs by taxon.<a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a></p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-lemurs-taxon-sex-int" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lemurs-taxon-sex-int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-lemurs-taxon-sex-int-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19" title="Figure&nbsp;7.9: weight versus sex by taxon"><img src="07-mlr_files/figure-html/fig-lemurs-taxon-sex-int-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lemurs-taxon-sex-int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.9: <code>weight</code> versus <code>sex</code> by <code>taxon</code>
</figcaption></figure>
</div>
</div>
</div>
<p><a href="#fig-lemurs-taxon-sex-int" class="quarto-xref">Figure&nbsp;<span>7.9</span></a> shows the relationship between <code>sex</code> and <code>weight</code> by <code>taxon</code>. Recall that an interaction effect means that the relationship between one predictor and the response variable differs by values of another predictor. Therefore, as we examine this plot, we are looking to see whether the relationship between sex and weight appears similar or different for each taxon (see <a href="03-eda.html#sec-multivar-eda" class="quarto-xref"><span>Section 3.6</span></a>). When we look at the boxplots for male and female relative to one another in the figure, we don’t see much difference across the three taxa, as there is a lot of overlap between the box plots for each taxon. The median weight for males versus females appears to differ for PCOQ lemurs compared to the other two groups. Thus, from the EDA we might expect a useful interaction for sex and the PCOQ species, but maybe not for VRUB.</p>
<p>We add this interaction term in to the model using the same syntax as before. The output from the regression model is in <a href="#tbl-lemurs-sex-taxon-int-model" class="quarto-xref">Table&nbsp;<span>7.13</span></a>.</p>
<div class="cell">
<div id="tbl-lemurs-sex-taxon-int-model" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-sex-taxon-int-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.13: Output for regression model including interaction between <code>sex</code> and <code>taxon</code>
</figcaption><div aria-describedby="tbl-lemurs-sex-taxon-int-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-60.3</td>
<td style="text-align: right;">134.96</td>
<td style="text-align: right;">-0.447</td>
<td style="text-align: right;">0.656</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">137.1</td>
<td style="text-align: right;">4.88</td>
<td style="text-align: right;">28.102</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">169.2</td>
<td style="text-align: right;">159.26</td>
<td style="text-align: right;">1.063</td>
<td style="text-align: right;">0.289</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">633.2</td>
<td style="text-align: right;">124.57</td>
<td style="text-align: right;">5.083</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1124.0</td>
<td style="text-align: right;">152.67</td>
<td style="text-align: right;">7.363</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">-14.4</td>
<td style="text-align: right;">65.58</td>
<td style="text-align: right;">-0.219</td>
<td style="text-align: right;">0.826</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM:taxonPCOQ</td>
<td style="text-align: right;">-387.4</td>
<td style="text-align: right;">192.94</td>
<td style="text-align: right;">-2.008</td>
<td style="text-align: right;">0.046</td>
</tr>
<tr class="even">
<td style="text-align: left;">sexM:taxonVRUB</td>
<td style="text-align: right;">-253.2</td>
<td style="text-align: right;">188.75</td>
<td style="text-align: right;">-1.341</td>
<td style="text-align: right;">0.181</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<!--# if I put this chapter after inference, I can talk about the p-values here.-->
<!--# if i want to ignore the pvalues, figure out how other texts deal with this-->
<p>Similar to the interpretations in the previous section, the interaction terms tell us how much the effect of sex among PCOQ or VRUB lemurs differ compared to the effect of sex for the baseline, ERUF lemurs. For example, the interaction term for PCOQ lemurs, <code>sexM:taxonPCOQ</code> = -387.382. This interpretation of this value is as follows:</p>
<blockquote class="blockquote">
<p><em>The difference in the average weight of male lemurs compared to female lemurs is predicted to be 387.382 grams less for lemurs from the PCOQ taxon compared to those in the ERUF taxon, holding age and litter size constant.</em></p>
</blockquote>
<p>As before, to get the overall difference in the average weight between male and female lemurs for the PCOQ species, we add the coefficients for the main effect <code>sexM</code> and the interaction effect <code>sexM:taxonPCOQ</code>. The overall effect of sex for PCOQ lemurs is -218.144 (169.238 + -387.382). The interpretation of this value is as follows:</p>
<blockquote class="blockquote">
<p><em>For lemurs in the PCOQ taxon, the weight of male lemurs is expected to be 218.144 grams less than the weight of female lemurs, on average, holding age and litter size constant.</em></p>
</blockquote>
<div class="yourturn">
<ul>
<li>What is the overall effect of <code>sexM</code> for lemurs in the VRUB taxon?</li>
<li>What is the overall effect of <code>sexM</code> for lemurs in the ERUF taxon?<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a>
</li>
</ul>
</div>
</section><section id="interaction-between-two-quantitative-predictors" class="level3" data-number="7.7.3"><h3 data-number="7.7.3" class="anchored" data-anchor-id="interaction-between-two-quantitative-predictors">
<span class="header-section-number">7.7.3</span> Interaction between two quantitative predictors</h3>
<p>The last type of interaction is between two quantitative predictors. This type of interaction is less common than the interactions including at least one categorical predictor, but they can be found in some scientific contexts<!--# be more specific and find a reference / example here-->. For the lemurs analysis, we will look at the interaction effect between <code>age</code> and <code>litter_size</code>. As with the interaction effect between two categorical predictors, we can interpret the interaction between <code>age</code> and <code>litter_size</code> as how much the effect of litter size changes as age changes or how much the effect of age changes as litter size changes. While either of these interpretations would be statistically valid, we will focus on the how the effect of litter size changes as age changes. This will allow us to more directly explore whether the impact of a lemur’s birth conditions (represented by the litter size) changes as the lemur gets older.</p>
<p>Visualizations for the potential interaction effect between two quantitative predictors can be complex, because a continuous predictor can take on infinitely many values. Therefore, when visualizing the potential interaction effect, we will create bins for one of the predictors and use the bins to see how the value of one of the predictors changes based on the other. <!--# this sentence is very muddled--> <a href="#fig-lemurs-age-litter-int" class="quarto-xref">Figure&nbsp;<span>7.10</span></a> is a scatterplot exploring the potential interaction between age and litter size.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-lemurs-age-litter-int" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure"><div aria-describedby="fig-lemurs-age-litter-int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="07-mlr_files/figure-html/fig-lemurs-age-litter-int-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20" title="Figure&nbsp;7.10: weight versus litter_size by age"><img src="07-mlr_files/figure-html/fig-lemurs-age-litter-int-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-lemurs-age-litter-int-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;7.10: <code>weight</code> versus <code>litter_size</code> by <code>age</code>
</figcaption></figure>
</div>
</div>
</div>
<p>Because we are specifically interested in interpreting how the effect of litter size changes as age changes, we have created bins to mark off age ranges and looked a the scatterplot of litter size and weight for each bin.</p>
<p>In <a href="#fig-lemurs-age-litter-int" class="quarto-xref">Figure&nbsp;<span>7.10</span></a>, the relationship between litter size and weight appears flatter for the older age groups, in particular the 20 - 25 month age group. This means it appears that litter size has much more impact on the weight among very young lemurs compared to those closer to two years old. As with all exploratory data analysis, we can not make a definitive conclusion based on this visualization alone, so we will fit a model with this interaction using the code below.</p>
<div class="cell">
<div id="tbl-lemurs-age-litter-int-model" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-age-litter-int-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.14: Output for regression model including interaction between <code>age</code> and <code>litter_size</code>
</figcaption><div aria-describedby="tbl-lemurs-age-litter-int-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-132.3</td>
<td style="text-align: right;">148.49</td>
<td style="text-align: right;">-0.891</td>
<td style="text-align: right;">0.374</td>
</tr>
<tr class="even">
<td style="text-align: left;">age</td>
<td style="text-align: right;">155.6</td>
<td style="text-align: right;">10.34</td>
<td style="text-align: right;">15.046</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">sexM</td>
<td style="text-align: right;">-69.6</td>
<td style="text-align: right;">68.22</td>
<td style="text-align: right;">-1.020</td>
<td style="text-align: right;">0.309</td>
</tr>
<tr class="even">
<td style="text-align: left;">taxonPCOQ</td>
<td style="text-align: right;">477.7</td>
<td style="text-align: right;">94.86</td>
<td style="text-align: right;">5.036</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">taxonVRUB</td>
<td style="text-align: right;">1042.5</td>
<td style="text-align: right;">133.07</td>
<td style="text-align: right;">7.834</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: left;">litter_size</td>
<td style="text-align: right;">77.4</td>
<td style="text-align: right;">80.78</td>
<td style="text-align: right;">0.958</td>
<td style="text-align: right;">0.339</td>
</tr>
<tr class="odd">
<td style="text-align: left;">age:litter_size</td>
<td style="text-align: right;">-10.9</td>
<td style="text-align: right;">5.33</td>
<td style="text-align: right;">-2.045</td>
<td style="text-align: right;">0.042</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The output for the model with the interaction between <code>age</code> and <code>litter_size</code> is in <a href="#tbl-lemurs-age-litter-int-model" class="quarto-xref">Table&nbsp;<span>7.14</span></a>. The coefficient for the term <code>age:litter_size</code> is the amount the effect of litter size changes as age increases by 1 month. It is interpreted as follows:</p>
<blockquote class="blockquote">
<p>For each additional month in age, the slope of litter size and weight decreases by 10.902, on average, holding taxon and sex constant.</p>
</blockquote>
<p>As with previous interaction effects, we add the coefficients for the main effect term and interaction term to get the overall effect of litter size at different ages. Recall that interaction effects are just two predictor variables multiplied together, so we need to plug in a value of age to get the overall effect of litter for that age. When we had interaction effects with at least one categorical predictor, we plugged in the 1 or 0 for the indicator variable. Now we can choose any age in the range of our data to plug in. We may also want to plug in a few different ages throughout the range to see how the effect of litter size compares for different ages.</p>
<p>Let’s interpret the effect of litter size for lemurs who are 12 months old. The effect of litter size for lemurs of this age is -53.4 (77.424 + 12 <span class="math inline">\(\times\)</span> -10.902). The interpretation is as follows:</p>
<blockquote class="blockquote">
<p><em>For lemurs who are 12 months old, for each additional lemur in their litter, their weight is expected to be less by 53.4 grams, on average, holding sex and taxon constant.</em></p>
</blockquote>
<p>The coefficient of the main effect of <code>litter_size</code> is the effect of litter size when <code>age = 0</code>. There are no lemurs who are 0 months old in the data, so we should be cautious about trying to derive meaning from the main effect of litter size in this model or refit the model using the centered values of the quantitative predictors.</p>
<div class="yourturn">
<p>What is the overall effect of litter size for lemurs who are 20 months old? Interpret this value in the context of the data.<a href="#fn13" class="footnote-ref" id="fnref13" role="doc-noteref"><sup>13</sup></a></p>
</div>
<div class="analysis_in_practice">
<p>In this section we only discussed interactions between two variables, but there can be interactions between three or more variables. Though such interactions are possible, they should be used with caution to avoid fitting the model too closely to the sample data and losing generalizability (called model overfit). These complex interactions also become difficult to interpret and can be harder to explain to a general audience.</p>
<p>Therefore, we recommend only using interaction effects with two variables unless there is a specific research or analysis objective that benefits from the more complex interaction effects.</p>
</div>
<!--# need to have quadratic predictors here-->
<!--# do we call adding the quadratic term to the model a transformation?-->
<!--# do we need to explain why we add the linear term when adding quadratic effect but not a linear term in addition to log transformaton-->
<!--# do i leave this here or have another chapter or section for transformations? Maybe the same for higher order terms?-->
</section></section><section id="multiple-linear-regression-in-r" class="level2" data-number="7.8"><h2 data-number="7.8" class="anchored" data-anchor-id="multiple-linear-regression-in-r">
<span class="header-section-number">7.8</span> Multiple linear regression in R</h2>
<section id="sec-mlr-estimate-r" class="level3" data-number="7.8.1"><h3 data-number="7.8.1" class="anchored" data-anchor-id="sec-mlr-estimate-r">
<span class="header-section-number">7.8.1</span> Estimating coefficient using R</h3>
<p>Similar to simple linear regression, we use the <code>lm</code> function to find the coefficient estimates <span class="math inline">\(\hat{\beta}_0, \hat{\beta}_1, \ldots, \hat{\beta}_p\)</span>. The code to fit the the model using age, sex, taxon, and litter size to understand variability in the weight of young lemurs is shown below.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lemurs_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> </span>
<span>                     <span class="va">taxon</span> <span class="op">+</span> <span class="va">litter_size</span>,</span>
<span>                   data <span class="op">=</span> <span class="va">lemurs</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">lemurs_model</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>The <code>tidy</code> function structures the model output into a data data frame, and <code>kable()</code> is used to display the results as a neatly formatted table.</p>
</section><section id="prediction-1" class="level3" data-number="7.8.2"><h3 data-number="7.8.2" class="anchored" data-anchor-id="prediction-1">
<span class="header-section-number">7.8.2</span> Prediction</h3>
<p>We use <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> to compute predicted values from multiple linear regression models. We begin by making a tibble that contains the values fo the new observation. The variable names in the tibble of new observations must match the column names in the original data exactly, including letter case. Additionally, the observed values of the categorical predictors are put in the tibble, not indicator variables. As with variable names, the values of the categorical predictors must be input exactly as they show in the data set (including case).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">new_lemur</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>age <span class="op">=</span> <span class="fl">10</span>, </span>
<span>                    taxon <span class="op">=</span> <span class="st">"VRUB"</span>, </span>
<span>                    sex <span class="op">=</span> <span class="st">"M"</span>, </span>
<span>                    litter_size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">lemurs_model</span>, <span class="va">new_lemur</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1 
2283 </code></pre>
</div>
</div>
<p>We can also use <code><a href="https://rdrr.io/r/stats/predict.html">predict()</a></code> to compute the predicted values for multiple new observations. Suppose we wish to predict the weight of the following lemurs:</p>
<ul>
<li><p>Lemur 1: 10-month old male lemur in the VRUB taxon who was born into a litter of 4 lemurs (same as before)</p></li>
<li><p>Lemur 2: 14-month old female lemur in the ERUF taxon who was born into a litter of 2 lemurs</p></li>
</ul>
<p>We use the same process as before, extending the tibble to include the observed values for both new lemurs.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb4"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">new_lemurs</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">14</span><span class="op">)</span>, </span>
<span>                    taxon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"VRUB"</span>, <span class="st">"ERUF"</span><span class="op">)</span>, </span>
<span>                    sex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M"</span>,<span class="st">"F"</span><span class="op">)</span>, </span>
<span>                    litter_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">lemurs_model</span>, <span class="va">new_lemurs</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>   1    2 
2283 1921 </code></pre>
</div>
</div>
<div class="analysis_in_practice">
<p><strong>Predictions using <code>augment()</code></strong></p>
<p>The <code>augment</code> function, introduced in <a href="06-slr-conditions.html#sec-model-conditions" class="quarto-xref"><span>Section 6.2</span></a>, can be used to compute predicted values for each observation in the data set used to fit the model. The predicted values are stored in the column <code>.fitted</code> in the augmented data frame, as shown in <a href="#tbl-lemurs-model-augment" class="quarto-xref">Table&nbsp;<span>7.15</span></a>.</p>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lemurs_model_aug</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">select</span><span class="op">(</span><span class="va">weight</span><span class="op">:</span><span class="va">.fitted</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">slice</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span><span class="fu">kable</span><span class="op">(</span>digits <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div id="tbl-lemurs-model-augment" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure"><figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-lemurs-model-augment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;7.15: Partial output from the lemurs model augumented data frame
</figcaption><div aria-describedby="tbl-lemurs-model-augment-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead><tr class="header">
<th style="text-align: right;">weight</th>
<th style="text-align: right;">age</th>
<th style="text-align: left;">sex</th>
<th style="text-align: left;">taxon</th>
<th style="text-align: right;">litter_size</th>
<th style="text-align: right;">.fitted</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">410</td>
<td style="text-align: right;">2.27</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">335</td>
</tr>
<tr class="even">
<td style="text-align: right;">137</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">ERUF</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">123</td>
</tr>
<tr class="odd">
<td style="text-align: right;">206</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">PCOQ</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">590</td>
</tr>
<tr class="even">
<td style="text-align: right;">185</td>
<td style="text-align: right;">1.05</td>
<td style="text-align: left;">M</td>
<td style="text-align: left;">PCOQ</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">551</td>
</tr>
<tr class="odd">
<td style="text-align: right;">373</td>
<td style="text-align: right;">2.66</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">PCOQ</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">860</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
</section><section id="interaction-terms" class="level3" data-number="7.8.3"><h3 data-number="7.8.3" class="anchored" data-anchor-id="interaction-terms">
<span class="header-section-number">7.8.3</span> Interaction terms</h3>
<p>We use the asterisks <code>*</code> to include interaction terms between any two variables in R. The code to include the interaction between <code>taxon</code> and <code>age</code> is below.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lemurs_age_taxon_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">taxon</span> <span class="op">+</span> </span>
<span>                             <span class="va">litter_size</span> <span class="op">+</span> <span class="va">taxon</span> <span class="op">*</span> <span class="va">age</span>, </span>
<span>                           data <span class="op">=</span> <span class="va">lemurs</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">tidy</span><span class="op">(</span><span class="va">lemurs_age_taxon_int</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 5
  term        estimate std.error statistic  p.value
  &lt;chr&gt;          &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;
1 (Intercept)    579.     135.       4.27  2.76e- 5
2 age             78.6      9.95     7.90  9.51e-14
3 sexM           -85.2     61.0     -1.40  1.63e- 1
4 taxonPCOQ     -356.     134.      -2.65  8.65e- 3
5 taxonVRUB      634.     163.       3.90  1.26e- 4
6 litter_size    -36.9     58.6     -0.629 5.30e- 1
# ℹ 2 more rows</code></pre>
</div>
</div>
<p>The syntax to include the interaction between two quantitative variables is the same as the other interactions. Note also that even though we used the binned values of age to help visualize the potential interaction effect in <a href="#fig-lemurs-age-litter-int" class="quarto-xref">Figure&nbsp;<span>7.10</span></a>, we use the original non-binned values of age in the model.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">lemurs_age_litter_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">weight</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">sex</span> <span class="op">+</span> <span class="va">taxon</span> <span class="op">+</span> </span>
<span>                             <span class="va">litter_size</span> <span class="op">+</span> <span class="va">age</span> <span class="op">*</span> <span class="va">litter_size</span>, </span>
<span>                           data <span class="op">=</span> <span class="va">lemurs</span><span class="op">)</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section></section><section id="summary" class="level2" data-number="7.9"><h2 data-number="7.9" class="anchored" data-anchor-id="summary">
<span class="header-section-number">7.9</span> Summary</h2>
<p>In this chapter, we introduced multiple linear regression, in which two or more predictor variables are used to understand variability and compute predictions for a quantitative response variable. We introduced a various different predictors that can be in the model, including categorical predictors and interaction terms. We showed how to use R to estimate model coefficients and compute predictions from the model. We expect there is uncertainty in the coefficient estimates produced by the regression model, given it was fit using sample data. In the next chapter, we will discuss inference for multiple linear regression and use it to draw conclusions about the relationships between the response and predictor variables.</p>
<!--# Exercise-->
<!--# Come back to Lemur data from conditions chapter-->
<!--# example where the centering is to shift the data by some year-->
<!--# Should include centering by a year or make this an exercise?-->
<!--# Use the lemurs data set for exercises-->
<!--# how do coefficients for categorical predictors compare across original , mean-centered, and standardized models? why they the same across all three models? -->
<!--# exercise to about indicator variables and plugging in 1/0 in interaction effects-->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-tidytuesday" class="csl-entry" role="listitem">
Community, Data Science Learning. 2024. <span>“Tidy Tuesday: A Weekly Social Data Project.”</span> <a href="https://tidytues.day">https://tidytues.day</a>.
</div>
<div id="ref-duke2025meetlemurs" class="csl-entry" role="listitem">
Duke Lemur Center. n.d. <span>“Meet the Lemurs.”</span> <a href="https://lemur.duke.edu/discover/meet-the-lemurs/" class="uri">https://lemur.duke.edu/discover/meet-the-lemurs/</a>.
</div>
<div id="ref-james2021introduction" class="csl-entry" role="listitem">
James, Gareth, Daniela Witten, Trevor Hastie, and Robert Tibshirani. 2021. <em>An Introduction to Statistical Learning: With Applications in r</em>. 2nd ed. Springer.
</div>
<div id="ref-zehrlife" class="csl-entry" role="listitem">
Zehr, SM, RG Roach, D Haring, J Taylor, FH Cameron, and AD Yoder. n.d. <span>“Life History Profiles for 27 Strepsirrhine Primate Taxa Generated Using Captive Data from the Duke Lemur Center. Sci Data. 2014; 1: 140019.”</span>
</div>
</div>
</section><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><hr>
<ol>
<li id="fn1"><p>The distribution of <code>age</code> is unimodal and skewed right, so the center is best described by the median 7.1 months and spread by the IQR of 12.8 months. There does not appear to be any outliers for age in the data.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>It is possible to fit models such that <span class="math inline">\(p &gt; n\)</span>. These models are beyond the scope of this text, so we refer the reader to Chapter 6 of <span class="citation" data-cites="james2021introduction">James et al. (<a href="references.html#ref-james2021introduction" role="doc-biblioref">2021</a>)</span> for further reading.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>For each additional lemur in the litter in which a young lemur was born, the weight is expected to be lower by 19.607 grams, holding taxon, sex, and age constant.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>The baseline level for sex is “F” (Female). The average weight for male lemurs is about 88.838 grams less than the average weight for female lemurs, holding taxon, age, and litter size constant. The intercept for female lemurs is 43.844 .The intercept for male lemurs is -44.994 (43.844 + -88.838 ).<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>It is not, because it is not possible for a lemur to be born into a litter of size 0. The litter size must be at least 1.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p><span class="math inline">\(\widehat{\text{weight\_g}} = 43.844 + 136.903 \times 14 - 88.838 \times 0 + 471.715 \times 0 + 1037.323 \times 0 - 19.607 \times 2 = 1921.272\)</span>$<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>We only centered or standardized the quantitative predictors; we have not changed the categorical predictors. Recall that the indicator variables shift the intercept, and thus this did not change though the relationship between the response and the quantitative predictors may have changed.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>The variable <code>litter_size</code> , because it has the coefficient with the smallest magnitude, |18.128 |= 18.128 .<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>Lemurs in the PCOQ taxon appear to grow at the fastest rate, because its line in <a href="#fig-lemurs-age-taxon-int" class="quarto-xref">Figure&nbsp;<span>7.8</span></a> (green dotted line) is the steepest.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p>The slope of age for lemurs in the VRUB taxon is 127.931 (78.579 + 49.352). This means that among VRUB lemurs, for each additional month in age, the weight is expected to be greater by 127.931 grams, on average, holding sex and litter size constant.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>The interaction between sex and taxon would also tell us if the relationship between taxon and weight differs by sex. We have decided to interpret the interaction effect in the other direction given it is more practically meaningful to understand differences between sexes within each taxon versus the other way around.<a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>The overall effect of <code>sexM</code> for lemurs in the VRUB taxon is -83.971 (169.238 + -253.209 ). The overall effect of <code>sexM</code> for lemurs in the ERUF taxon is 169.238<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn13"><p>The overall effect of litter size for lemurs who are 20 months old is 66.522 . This means that for lemurs who are 20 months old, for each additional sibling in their litter, their weight is expected to be less by 140.616 (77.424 + 20 <span class="math inline">\(\times\)</span> -10.902 ), on average, holding sex and taxon constant.<a href="#fnref13" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/introregressio\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./06-slr-conditions.html" class="pagination-link" aria-label="Model conditions and diagnostics">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model conditions and diagnostics</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./08-mlr-inference.html" class="pagination-link" aria-label="Inference for multiple linear regression">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for multiple linear regression</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/matackett/regression-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>


</body></html>