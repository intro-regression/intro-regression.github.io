<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.24">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Maria Tackett">

<title>5&nbsp; Inference for simple linear regression – Introduction to Regression Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./06-slr-conditions.html" rel="next">
<link href="./04-slr.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dc55a5b9e770e841cd82e46aadbfb9b0.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-31c3c5ec0f84e3846e28bd1517aa8340.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script defer="" data-domain="https://matackett.github.io/regression-book/" src="https://plausible.io/js/script.js"></script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-slr.html">Part 2: Simple linear regression</a></li><li class="breadcrumb-item"><a href="./05-slr-inference.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for simple linear regression</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to Regression Analysis</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/matackett/regression-book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./00-preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 1: Getting started</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Regression in the data science workflow</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-review-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Data analysis in R</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Exploratory data analysis</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 2: Simple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-slr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-slr-inference.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for simple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-slr-conditions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model conditions and diagnostics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 3: Multiple linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-mlr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-mlr-inference.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Inference for multiple linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-mlr-transformations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Variable transformations</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-model-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Model selection</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Part 4: Beyond linear regression</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-logistic-prediction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Logistic regression: Prediction and evaluation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-special-topics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Special topics</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-linear.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">Mathematics of linear regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix-logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Mathematics of logistic regression</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./datasets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Data sets</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-goals" id="toc-learning-goals" class="nav-link active" data-scroll-target="#learning-goals">Learning goals</a></li>
  <li><a href="#sec-slr-inf-data" id="toc-sec-slr-inf-data" class="nav-link" data-scroll-target="#sec-slr-inf-data"><span class="header-section-number">5.1</span> Introduction: Access to playgrounds</a>
  <ul class="collapse">
  <li><a href="#sec-parks-eda-model" id="toc-sec-parks-eda-model" class="nav-link" data-scroll-target="#sec-parks-eda-model"><span class="header-section-number">5.1.1</span> Exploratory data analysis</a></li>
  </ul></li>
  <li><a href="#sec-mlr-inf-objective" id="toc-sec-mlr-inf-objective" class="nav-link" data-scroll-target="#sec-mlr-inf-objective"><span class="header-section-number">5.2</span> Objectives of statistical inference</a></li>
  <li><a href="#sec-slr-foundation" id="toc-sec-slr-foundation" class="nav-link" data-scroll-target="#sec-slr-foundation"><span class="header-section-number">5.3</span> Foundations of simple linear regression</a></li>
  <li><a href="#sec-bootstrap-ci" id="toc-sec-bootstrap-ci" class="nav-link" data-scroll-target="#sec-bootstrap-ci"><span class="header-section-number">5.4</span> Bootstrap confidence intervals</a>
  <ul class="collapse">
  <li><a href="#sec-construct-bootstrap-ci" id="toc-sec-construct-bootstrap-ci" class="nav-link" data-scroll-target="#sec-construct-bootstrap-ci"><span class="header-section-number">5.4.1</span> Constructing a bootstrap confidence interval for <span class="math inline">\(\beta_1\)</span></a></li>
  <li><a href="#interpreting-the-interval" id="toc-interpreting-the-interval" class="nav-link" data-scroll-target="#interpreting-the-interval"><span class="header-section-number">5.4.2</span> Interpreting the interval</a></li>
  <li><a href="#what-does-confidence-mean" id="toc-what-does-confidence-mean" class="nav-link" data-scroll-target="#what-does-confidence-mean"><span class="header-section-number">5.4.3</span> What does “confidence” mean?</a></li>
  </ul></li>
  <li><a href="#sec-hypothesis-test-overview" id="toc-sec-hypothesis-test-overview" class="nav-link" data-scroll-target="#sec-hypothesis-test-overview"><span class="header-section-number">5.5</span> Hypothesis tests</a>
  <ul class="collapse">
  <li><a href="#define-the-hypotheses" id="toc-define-the-hypotheses" class="nav-link" data-scroll-target="#define-the-hypotheses"><span class="header-section-number">5.5.1</span> Define the hypotheses</a></li>
  <li><a href="#evaluate-the-evidence" id="toc-evaluate-the-evidence" class="nav-link" data-scroll-target="#evaluate-the-evidence"><span class="header-section-number">5.5.2</span> Evaluate the evidence</a></li>
  <li><a href="#make-a-conclusion" id="toc-make-a-conclusion" class="nav-link" data-scroll-target="#make-a-conclusion"><span class="header-section-number">5.5.3</span> Make a conclusion</a></li>
  </ul></li>
  <li><a href="#sec-slr-testing-sim" id="toc-sec-slr-testing-sim" class="nav-link" data-scroll-target="#sec-slr-testing-sim"><span class="header-section-number">5.6</span> Permutation tests</a>
  <ul class="collapse">
  <li><a href="#sec-slr-inf-hypotheses" id="toc-sec-slr-inf-hypotheses" class="nav-link" data-scroll-target="#sec-slr-inf-hypotheses"><span class="header-section-number">5.6.1</span> State the hypotheses</a></li>
  <li><a href="#sec-slr-inf-permutation" id="toc-sec-slr-inf-permutation" class="nav-link" data-scroll-target="#sec-slr-inf-permutation"><span class="header-section-number">5.6.2</span> Simulate the null distribution</a></li>
  <li><a href="#sec-calc-pvalue" id="toc-sec-calc-pvalue" class="nav-link" data-scroll-target="#sec-calc-pvalue"><span class="header-section-number">5.6.3</span> Calculate p-value</a></li>
  <li><a href="#sec-slr-inf-conclusion" id="toc-sec-slr-inf-conclusion" class="nav-link" data-scroll-target="#sec-slr-inf-conclusion"><span class="header-section-number">5.6.4</span> Draw conclusion</a></li>
  <li><a href="#type-i-and-type-ii-error" id="toc-type-i-and-type-ii-error" class="nav-link" data-scroll-target="#type-i-and-type-ii-error"><span class="header-section-number">5.6.5</span> Type I and Type II error</a></li>
  </ul></li>
  <li><a href="#sec-slr-inf-relationship-ci-test" id="toc-sec-slr-inf-relationship-ci-test" class="nav-link" data-scroll-target="#sec-slr-inf-relationship-ci-test"><span class="header-section-number">5.7</span> Relationship between confidence intervals and hypothesis tests</a></li>
  <li><a href="#sec-slr-inf-clt" id="toc-sec-slr-inf-clt" class="nav-link" data-scroll-target="#sec-slr-inf-clt"><span class="header-section-number">5.8</span> Theory-based inference</a>
  <ul class="collapse">
  <li><a href="#sec-slr-clt" id="toc-sec-slr-clt" class="nav-link" data-scroll-target="#sec-slr-clt"><span class="header-section-number">5.8.1</span> Central Limit Theorem</a></li>
  <li><a href="#sec-estimate-reg-std-err" id="toc-sec-estimate-reg-std-err" class="nav-link" data-scroll-target="#sec-estimate-reg-std-err"><span class="header-section-number">5.8.2</span> Estimating <span class="math inline">\(\sigma_{\epsilon}\)</span></a></li>
  <li><a href="#sec-slr-inf-clt-hypothesis-test" id="toc-sec-slr-inf-clt-hypothesis-test" class="nav-link" data-scroll-target="#sec-slr-inf-clt-hypothesis-test"><span class="header-section-number">5.8.3</span> Hypothesis test for the slope</a></li>
  <li><a href="#confidence-interval" id="toc-confidence-interval" class="nav-link" data-scroll-target="#confidence-interval"><span class="header-section-number">5.8.4</span> Confidence interval</a></li>
  </ul></li>
  <li><a href="#inference-in-r" id="toc-inference-in-r" class="nav-link" data-scroll-target="#inference-in-r"><span class="header-section-number">5.9</span> Inference in R</a>
  <ul class="collapse">
  <li><a href="#sec-slr-bootstrap-r" id="toc-sec-slr-bootstrap-r" class="nav-link" data-scroll-target="#sec-slr-bootstrap-r"><span class="header-section-number">5.9.1</span> Bootstrap confidence intervals in R</a></li>
  <li><a href="#sec-slr-permutation-r" id="toc-sec-slr-permutation-r" class="nav-link" data-scroll-target="#sec-slr-permutation-r"><span class="header-section-number">5.9.2</span> Permutation tests in R</a></li>
  <li><a href="#sec-theory-inf-r" id="toc-sec-theory-inf-r" class="nav-link" data-scroll-target="#sec-theory-inf-r"><span class="header-section-number">5.9.3</span> Theory-based inference in R</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary"><span class="header-section-number">5.10</span> Summary</a></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/matackett/regression-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./04-slr.html">Part 2: Simple linear regression</a></li><li class="breadcrumb-item"><a href="./05-slr-inference.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for simple linear regression</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span id="sec-ch-slr-inf" class="quarto-section-identifier"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Inference for simple linear regression</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="learning-goals" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="learning-goals">Learning goals</h2>
<ul>
<li>Explain how statistical inference is used to draw conclusions about a population model coefficient</li>
<li>Construct confidence intervals using bootstrap simulation</li>
<li>Conduct hypothesis tests using permutation</li>
<li>Explain how the Central Limit Theorem is applied to inference for the model coefficient</li>
<li>Conduct statistical inference using mathematical models based on the Central Limit Theorem</li>
<li>Interpret results from statistical inference in the context of the data</li>
<li>Explain the connection between hypothesis tests and confidence intervals</li>
</ul>
</section>
<section id="sec-slr-inf-data" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="sec-slr-inf-data"><span class="header-section-number">5.1</span> Introduction: Access to playgrounds</h2>
<p>The <a href="https://www.tpl.org/parks-and-an-equitable-recovery-parkscore-report">Trust for Public Land</a> is a non-profit organization that advocates for equitable access to outdoor spaces in cities across the United States. In the 2021 report <em>Parks and an Equitable Recovery</em>, the organization stated that “parks are not just a nicety—they are a necessity” <span class="citation" data-cites="publicland">(<a href="references.html#ref-publicland" role="doc-biblioref">The Trust for Public Land 2021</a>)</span>. The report details the many health, social, and environmental benefits of having ample access to public outdoor space in cities, along with the various factors that impede the access to parks and other outdoor space for some residents.</p>
<p>One type of outdoor space the authors study in the report is playgrounds. The report describes playgrounds as outdoor spaces that “bring children and adults together” <span class="citation" data-cites="publicland">(<a href="references.html#ref-publicland" role="doc-biblioref">The Trust for Public Land 2021, 13</a>)</span> and a place that was important for distributing “fresh food and prepared meals to those in need, particularly school-aged children” <span class="citation" data-cites="publicland">(<a href="references.html#ref-publicland" role="doc-biblioref">The Trust for Public Land 2021, 9</a>)</span> during the global COVID-19 pandemic.</p>
<div class="objective">
<p>Given the impact of playgrounds for both children and adults in a community, we want to understand factors associated with variability in the access to playgrounds. In particular, we want to (1) investigate whether local government spending is useful in understanding variability in playground access, and if so, (2) quantify the true relationship between local government spending and playground access.</p>
</div>
<p>The data includes information on 97 of the most populated cities in the United States (US) in the year 2020. The data were originally collected by the Trust for Public Land and was a featured as part of the TidyTuesday weekly data visualization challenge in June 2021 <span class="citation" data-cites="tidytuesday">(<a href="references.html#ref-tidytuesday" role="doc-biblioref">Community 2024</a>)</span>. The data are in <code>parks.csv</code>. The analysis in this chapter focuses on two variables:</p>
<!--# instead of "spending", should I refer to this as how much a city invests in its residents?-->
<!--# rescale this to spending per 10000 residents...maybe in 100s or 1000s of dollars?-->
<ul>
<li><p><code>per_capita_expend</code>: Total amount the city government spent per resident in 2020 in US dollars (USD). This is a measure of how much a city invests in services and facilities for its residents. We refer to it as a city’s “per capita expenditure”.</p></li>
<li><p><code>playgrounds</code> : Number of playgrounds per 10,000 residents in 2020</p></li>
</ul>
<div class="yourturn">
<p>Which of the following do you think best describes the relationship between <code>per_capita_expend</code> and <code>playgrounds</code>?<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<ul>
<li>The relationship is positive.</li>
<li>The relationship is negative.</li>
<li>There is no relationship.</li>
</ul>
</div>
<section id="sec-parks-eda-model" class="level3" data-number="5.1.1">
<h3 data-number="5.1.1" class="anchored" data-anchor-id="sec-parks-eda-model"><span class="header-section-number">5.1.1</span> Exploratory data analysis</h3>
<p>The visualizations and summary statistics for univariate and bivariate exploratory data analysis are in <a href="#fig-parks-univariate-eda" class="quarto-xref">Figure&nbsp;<span>5.1</span></a> and <a href="#tbl-parks-univariate-eda" class="quarto-xref">Table&nbsp;<span>5.1</span></a>.</p>
<div id="fig-parks-univariate-eda" class="quarto-layout-panel">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parks-univariate-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="quarto-layout-row">
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-parks-univariate-eda" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-parks-univariate-eda-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-parks-univariate-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="05-slr-inference_files/figure-html/fig-parks-univariate-eda-1.png" class="lightbox" data-gallery="fig-parks-univariate-eda" title="Figure&nbsp;5.1&nbsp;(a): Playgrounds per 10,000 residents"><img src="05-slr-inference_files/figure-html/fig-parks-univariate-eda-1.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-parks-univariate-eda"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-parks-univariate-eda-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(a) Playgrounds per 10,000 residents
</figcaption>
</figure>
</div>
</div>
<div class="cell-output-display quarto-layout-cell-subref quarto-layout-cell" data-ref-parent="fig-parks-univariate-eda" style="flex-basis: 50.0%;justify-content: flex-start;">
<div id="fig-parks-univariate-eda-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-subfloat-fig figure">
<div aria-describedby="fig-parks-univariate-eda-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="05-slr-inference_files/figure-html/fig-parks-univariate-eda-2.png" class="lightbox" data-gallery="fig-parks-univariate-eda" title="Figure&nbsp;5.1&nbsp;(b): Per capita expenditure in USD"><img src="05-slr-inference_files/figure-html/fig-parks-univariate-eda-2.png" class="img-fluid figure-img" style="width:100.0%" data-ref-parent="fig-parks-univariate-eda"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-subfloat-caption quarto-subfloat-fig" id="fig-parks-univariate-eda-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
(b) Per capita expenditure in USD
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parks-univariate-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.1: Univariate exploratory data analysis of <code>playgrounds</code> and <code>per_capita_expend</code>
</figcaption>
</figure>
</div>
<div class="cell">
<div id="tbl-parks-univariate-eda" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-parks-univariate-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.1: Summary statistics of <code>playgrounds</code> and <code>per_capita_spend</code>
</figcaption>
<div aria-describedby="tbl-parks-univariate-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 26%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 5%">
<col style="width: 7%">
<col style="width: 17%">
<col style="width: 8%">
<col style="width: 5%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">SD</th>
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Median (Q2)</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Missing</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">playgrounds</td>
<td style="text-align: right;">2.8</td>
<td style="text-align: right;">1.1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">3.6</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">113.0</td>
<td style="text-align: right;">72.0</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">65.0</td>
<td style="text-align: right;">89.0</td>
<td style="text-align: right;">142.0</td>
<td style="text-align: right;">399</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The distribution of <code>playgrounds</code>, the number of playgrounds per 10,000 residents (the response variable), is unimodal and right-skewed. The center of the distribution is the median of about 2.6 playgrounds per 10,000 residents, and the the spread of the middle 50% of the distribution (the IQR) is 1.7. There appear to be two potential outlying cities with more than 6 playgrounds per 10,000 residents, indicating high playground access relative to the other cities in the data set.</p>
<p>The distribution of <code>per_capita_expend</code>, a city’s expenditure per resident (the predictor variable), is also unimodal and right-skewed. The center of the distribution is around 89 dollars per resident, and the middle 50% of the distribution has a spread of about 77 dollars per resident. Similar to the response variable, there are some potential outliers. There are 5 cities that invests more than 300 dollars per resident.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-parks-bivariate-eda" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parks-bivariate-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="05-slr-inference_files/figure-html/fig-parks-bivariate-eda-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" title="Figure&nbsp;5.2: Bivariate exploratory data analysis of playgrounds versus per_capita_spend"><img src="05-slr-inference_files/figure-html/fig-parks-bivariate-eda-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parks-bivariate-eda-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.2: Bivariate exploratory data analysis of <code>playgrounds</code> versus <code>per_capita_spend</code>
</figcaption>
</figure>
</div>
</div>
</div>
<p>From <a href="#fig-parks-bivariate-eda" class="quarto-xref">Figure&nbsp;<span>5.2</span></a> there appears to be a positive relationship between a city’s per capita expenditure and the number of playgrounds per 10,000 residents. The correlation is 0.206, indicating the relationship between playground access and city expenditure is not strong.This is partially influenced by the outlying observations in that have relatively low values of per capita expenditure but high numbers of playgrounds per 10,000 residents.</p>
<section id="linear-regression-model" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="linear-regression-model">Linear regression model</h4>
<p>To better explore this relationship, we fit a simple linear regression model of the form</p>
<p><span id="eq-parks-stat-model"><span class="math display">\[
\text{playgrounds} = \beta_0 + \beta_1~\text{per\_capita\_expend} + \epsilon, \hspace{5mm} \epsilon \sim N(0, \sigma^2_{\epsilon})
\tag{5.1}\]</span></span></p>
<p>The output of the fitted regression model is <a href="#tbl-parks-model" class="quarto-xref">Table&nbsp;<span>5.2</span></a>.</p>
<div class="cell">
<div id="tbl-parks-model" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-parks-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.2: Linear regression model <code>per_capita_expend</code> and <code>playgrounds</code>
</figcaption>
<div aria-describedby="tbl-parks-model-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
<th style="text-align: right;">std.error</th>
<th style="text-align: right;">statistic</th>
<th style="text-align: right;">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">2.4184</td>
<td style="text-align: right;">0.2144</td>
<td style="text-align: right;">11.28</td>
<td style="text-align: right;">0.0000</td>
</tr>
<tr class="even">
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">0.0033</td>
<td style="text-align: right;">0.0016</td>
<td style="text-align: right;">2.06</td>
<td style="text-align: right;">0.0424</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p><span id="eq-parks-model"><span class="math display">\[
\widehat{\text{playgrounds}} = 2.418 + 0.003 \times \text{per\_capita\_expend}
\tag{5.2}\]</span></span></p>
<div class="yourturn">
<ul>
<li>Interpret the slope in the context of the data.</li>
<li>Does the intercept have a meaningful interpretation? <a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
</ul>
</div>
<p>From the sample of 97 cities in 2020, the estimated slope of 0.003. This estimated slope is likely close to but not the exact value of the true population slope we would obtain using data from every city in the United States. Based on the equation alone, we are also not sure if this slope indicates an actual meaningful relationship between the two variables, or if the slope is due to random variability in the data. We will use statistical inference methods to help answer these questions and use the model to draw conclusions about the relationship between <code>per_capita_expend</code> and <code>playgrounds</code> beyond these 97 cities.</p>
</section>
</section>
</section>
<section id="sec-mlr-inf-objective" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="sec-mlr-inf-objective"><span class="header-section-number">5.2</span> Objectives of statistical inference</h2>
<!--# From EM: Better emphasize that inference is at the population level. Maybe really make that clear here and emphasize it again later on.-->
<p>Based on the regression output in <a href="#tbl-parks-model" class="quarto-xref">Table&nbsp;<span>5.2</span></a>, for each additional dollar in per capita expenditure, we expect there to be 0.003 more playgrounds per 10,000 residents, on average.</p>
<!--# Should I rescale this? This interpretation is not super meaningful-->
<p>The estimate 0.003 is the “best guess” of the relationship between per capita expenditure and the number of playgrounds per 10,000 residents; however, this is likely not the exact value of the relationship in the population of all US cities. We can use <strong>statistical inference</strong>, the process of drawing conclusions about the population based on the analysis of the sample data. More specifically, we will use statistical inference to draw conclusions about the population-level slope, <span class="math inline">\(\beta_1\)</span>.</p>
<p>There are two types of statistical inference procedures:</p>
<ul>
<li><strong>Hypothesis tests:</strong> Test a specific claim about the population-level slope</li>
<li><strong>Confidence intervals</strong>: A range of values that the population-level slope may reasonably take</li>
</ul>
<p>This chapter focuses on statistical inference for the slope <span class="math inline">\(\beta_1\)</span>, but the concepts introduced here can be applied to inference on the population-level intercept <span class="math inline">\(\beta_0\)</span> and other population-level parameters.</p>
<p>As we’ll see throughout the chapter, a key component of statistical inference is quantifying the <strong>sampling variability</strong>, sample-to-sample variability in the statistic that is the “best guest” estimate for the parameter. For example, when we conduct statistical inference on the slope of per capita expenditure <span class="math inline">\(\beta_1\)</span>, we need to quantify the sampling the variability of the statistic <span class="math inline">\(\hat{\beta}_1\)</span>, the estimated (sample) slope. This is the amount of variability in <span class="math inline">\(\hat{\beta}_1\)</span> that is expected if we repeated the following process many times: (1) collect a new sample that is the same size as our sample data ( 97 in this analysis), and (2) use the new sample to fit a model using <code>per_capita_expend</code> to predict <code>playgrounds</code> to obtain an estimate of the slope. The idea is that <span class="math inline">\(\hat{\beta}_1\)</span> would not be the same for each new sample, so we need a way to quantify the variability in these estimated slopes to understand this natural variation. The <span class="math inline">\(\hat{\beta}_1\)</span> values from the new samples make up the <strong>sampling distribution</strong>.</p>
<p>While the process described above would be an approach for constructing the sampling distribution, it is not feasible to collect a lot of new samples in practice. Instead, there are two approaches for obtaining the sampling distribution, in order to quantify the variability in the estimated slopes and conduct statistical inference.</p>
<ul>
<li><p><strong>Simulation-based methods</strong>: Quantify the sampling variability by generating a sampling distribution directly from the data</p></li>
<li><p><strong>Theory-based methods:</strong> Quantify the sampling variability using mathematical models based on the Central Limit Theorem</p></li>
</ul>
<p><a href="#sec-bootstrap-ci" class="quarto-xref"><span>Section 5.4</span></a> and <a href="#sec-slr-testing-sim" class="quarto-xref"><span>Section 5.6</span></a> introduce statistical inference using simulation-based methods, and <a href="#sec-slr-inf-clt" class="quarto-xref"><span>Section 5.8</span></a> introduces inference using theory-based methods. Before we get into those details, however, let’s introduce more of the foundational ideas underlying simple linear regression and how they relate to statistical inference.</p>
<!--# key terms box?-->
<!--# Statistical inference: Using sample data to draw conclusions about a population.-->
<!--# Population parameter: Quantitative measure of a feature of the population (for example, the slope for the population)-->
<!--# Sample statistic: Estimate of the population parameter using the sample data (also called the point estimate)-->
<!--# Sampling distribution: Distribution of the sample statistic across many samples.-->
<!--# Sampling variability: Variability in the sampling distribution. This can be measured using the standard deviation, variance, IQR, etc.-->
<!--# Consider a visualization to help explanation of the sampling distribution-->
</section>
<section id="sec-slr-foundation" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="sec-slr-foundation"><span class="header-section-number">5.3</span> Foundations of simple linear regression</h2>
<!--# does this section need to be here or could it be somewhere else?-->
<p>In <a href="04-slr.html#sec-slr-specify" class="quarto-xref"><span>Section 4.3.1</span></a>, we introduced the statistical model for simple linear regression <span id="eq-slr-model-ch5"><span class="math display">\[
Y = \beta_0 + \beta_1 X + \epsilon \hspace{8mm} \epsilon \sim N(0, \sigma^2_{\epsilon})
\tag{5.3}\]</span></span></p>
<p>such that <span class="math inline">\(Y\)</span> is the response variable, <span class="math inline">\(X\)</span> is the predictor variable, and <span class="math inline">\(\epsilon\)</span> is the error term. <a href="#eq-slr-model-ch5" class="quarto-xref">Equation&nbsp;<span>5.3</span></a> can be rewritten in terms of the distribution of the response variable <span class="math inline">\(Y\)</span> given the predictor <span class="math inline">\(X\)</span>. It is represented as <span class="math inline">\(Y|X\)</span> ( “<span class="math inline">\(Y\)</span> given <span class="math inline">\(X\)</span>”)</p>
<p><span id="eq-slr-dist"><span class="math display">\[Y|X \sim N(\beta_0 + \beta_1X , \sigma^2_\epsilon) \tag{5.4}\]</span></span></p>
<p><a href="#eq-slr-dist" class="quarto-xref">Equation&nbsp;<span>5.4</span></a> is the assumed distribution of the response variable conditional on the predictor variable under the simple linear regression model. Therefore, we conduct simple linear regression assuming <a href="#eq-slr-dist" class="quarto-xref">Equation&nbsp;<span>5.4</span></a> is true. <!--# @fig-slr-assumptions is a visual representation of this equation.--> Based on the equation <!--# and figure --> we specify the assumptions that are made when we do simple linear regression. More specifically, the following assumptions are made based on <a href="#eq-slr-dist" class="quarto-xref">Equation&nbsp;<span>5.4</span></a>:</p>
<!--# Insert replica of favorite picture #fig-slr-assumptions-->
<!--# reorder these assumptions to put normal as #3-->
<ol type="1">
<li><p>The distribution of the response <span class="math inline">\(Y\)</span> is normal for a given value of the predictor <span class="math inline">\(X\)</span>.</p></li>
<li><p>The expected value (mean) of <span class="math inline">\(Y|X\)</span> is <span class="math inline">\(\beta_0 + \beta_1 X\)</span>. There is a linear relationship between the response and predictor variable.</p></li>
<li><p>The variance <span class="math inline">\(Y|X\)</span> is <span class="math inline">\(\sigma^2_{\epsilon}\)</span>. This variance is equal for all values of <span class="math inline">\(X\)</span> and thus does not depend on <span class="math inline">\(X\)</span>.</p></li>
<li><p>The error terms for each observation, <span class="math inline">\(\epsilon\)</span> in <a href="#eq-slr-model-ch5" class="quarto-xref">Equation&nbsp;<span>5.3</span></a>, are independent. This also means the values of the response variable, and observations more generally, are independent.</p></li>
</ol>
<!--# Add an appendix that goes into some of those, for example #4-->
<p>Whenever we fit linear regression models and conduct inference on the slope, we do so under the assumption that some or all of these four statements hold. In <a href="06-slr-conditions.html" class="quarto-xref"><span>Chapter 6</span></a>, we will discuss how to check if these assumptions hold in a given analysis. As we might expect, these assumptions do not always perfectly hold in practice, so we will also discuss circumstances in which an assumption is necessary versus when an assumption can be relaxed. For the remainder of this chapter, however, we will proceed as if all four assumptions hold.</p>
<!--# ## Simulation-based inference {#sec-slr-sim-inf}-->
<!--# need a way to 

<!--# figure out how much I need to introduce Sim-based inference in general-->
<!--# Maybe call the sample data we have in hand the "working sample data"-->
<!--# Seems like sample is being used a lot and getting a bit muddied-->
<!--# Using simulation to get the variability in the estimated slope $\hat{\beta}_1$ -->
<!--# Sketch of what happens when we do simulation-based inference -->
</section>
<section id="sec-bootstrap-ci" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="sec-bootstrap-ci"><span class="header-section-number">5.4</span> Bootstrap confidence intervals</h2>
<p>We’ll begin by looking at simulation-based methods for statistical inference: bootstrap confidence intervals and permutation tests (<a href="#sec-slr-permutation-r" class="quarto-xref"><span>Section 5.9.2</span></a>). In these procedures, we use the sample data to construct a simulated sampling distribution to quantify the sample-to-sample variability in <span class="math inline">\(\hat{\beta}_1\)</span>. Let’s start with the simulation-based approach to construct confidence intervals.</p>
<p>A <strong>confidence interval</strong> is a range of values the population-level slope <span class="math inline">\(\beta_1\)</span> may reasonably take. Though we have <span class="math inline">\(\hat{\beta}_1\)</span>, the best guess for the population slope (called a <em>point estimate</em>) , we are more likely to capture the value of the true population slope by computing a range of plausible values than by solely relying on a single estimate. We get this range by constructing <span class="math inline">\(C\%\)</span> confidence intervals, where <span class="math inline">\(C\%\)</span> is how confident we are the interval contains <span class="math inline">\(\beta_1\)</span> based on the statistical methods.</p>
<p>In order to obtain this range of values we must understand the sampling variability of the statistic. Suppose we repeatedly take samples of size <span class="math inline">\(n\)</span> (the same size as the sample data) and fit regression models to compute <span class="math inline">\(\hat{\beta}_1\)</span>, the estimated slope. Recall that the sampling variability is the variability in these estimated slopes. In practice, it is generally not feasible to collect multiple samples from the population, so we use our sample data to simulate the process of obtaining new samples. We generate these new samples by <strong>bootstrapping</strong>, a simulation process in which we generate a sample of size <span class="math inline">\(n\)</span> by sampling with replacement from the current data. <!--# Add the origin of calling this bootstrap?--></p>
<p>We then fit the regression model and compute <span class="math inline">\(\hat{\beta}_1\)</span> for each bootstrap sample. These <span class="math inline">\(\hat{\beta}_1\)</span> estimated from the bootstrap samples make up the <strong>bootstrap distribution</strong>, i.e., the simulated sampling distribution. The variability in this distribution is the sampling variability we need to construct the confidence intervals.</p>
<div class="yourturn">
<p>Why do we sample <u>with replacement</u> when generating a bootstrap sample? How would a bootstrap sample compare to the original sample data if sampling is done <em>without</em> replacement?<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
</div>
<!--# do i need to add an example here?-->
<section id="sec-construct-bootstrap-ci" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="sec-construct-bootstrap-ci"><span class="header-section-number">5.4.1</span> Constructing a bootstrap confidence interval for <span class="math inline">\(\beta_1\)</span></h3>
<!--# does this need to be code forward? How do I show / teach the code for infer here, or is there a section for this?-->
<p>A bootstrap confidence interval for the population slope, <span class="math inline">\(\beta_1\)</span>, is constructed using the following steps:</p>
<ol type="1">
<li>Generate <span class="math inline">\(n_{iter}\)</span> bootstrap samples, where <span class="math inline">\(n_{iter}\)</span> is the number of iterations. We typically want to use at least 1000 iterations in order to construct a sampling distribution that is close to the theoretical distribution of <span class="math inline">\(\hat{\beta}_1\)</span> defined in <a href="#sec-slr-inf-clt" class="quarto-xref"><span>Section 5.8</span></a>. <!--# add a citation for this 1000 number--></li>
<li>Fit the linear regression model to each of the <span class="math inline">\(n_{iter}\)</span> bootstrap samples to obtain <span class="math inline">\(n_{iter}\)</span> values of <span class="math inline">\(\hat{\beta}_1\)</span>, the estimated slope. There will also be <span class="math inline">\(n_{iter}\)</span> values of the estimated intercept, <span class="math inline">\(\hat{\beta}_0\)</span>, but we will ignore those for now because we are not focusing on inference for the intercept.</li>
<li>Collect the <span class="math inline">\(n_{iter}\)</span> values of <span class="math inline">\(\hat{\beta}_1\)</span> from the previous step to obtain the <strong>bootstrapped sampling distribution</strong>. It is an approximation of the sampling distribution of <span class="math inline">\(\hat{\beta}_1\)</span>, and thus provides information about sample-to-sample variability of <span class="math inline">\(\hat{\beta}_1\)</span>.</li>
<li>Use the distribution from the previous step to calculate the <span class="math inline">\(C\%\)</span> confidence interval. The lower and upper bounds of the interval are the points in the distribution that mark the middle <span class="math inline">\(C\%\)</span> of the distribution.</li>
</ol>
<p>Using these four steps, let’s construct the 95% confidence for the population slope <span class="math inline">\(\beta_1\)</span> of the relationship between <code>per_capita_spend</code> and <code>playgrounds</code>.</p>
<ol type="1">
<li>Generate 1000 bootstrap samples (97 observations in each sample) by sampling with replacement from the current sample data of 97 observations. The first 10 observations from the first bootstrapped sample are shown in <a href="#tbl-parks-boot-samples" class="quarto-xref">Table&nbsp;<span>5.3</span></a>.</li>
</ol>
<div class="cell">
<div id="tbl-parks-boot-samples" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-parks-boot-samples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.3: First 10 rows of the first bootstrap sample. The replicate column identifies the bootstrap sample.
</figcaption>
<div aria-describedby="tbl-parks-boot-samples-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">replicate</th>
<th style="text-align: right;">playgrounds</th>
<th style="text-align: right;">per_capita_expend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">320</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">65</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">67</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">149</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">73</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">89</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.3</td>
<td style="text-align: right;">65</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<div class="yourturn">
<p>Why are there 97 observations in each bootstrap sample?<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
</div>
<ol start="2" type="1">
<li><p>Next, we fit a linear model of the form in <a href="#eq-parks-stat-model" class="quarto-xref">Equation&nbsp;<span>5.1</span></a> to each of the 1000 bootstrap samples. The estimated slopes and intercepts for the first three bootstrap samples are shown in <a href="#tbl-parks-boot-slopes" class="quarto-xref">Table&nbsp;<span>5.4</span></a>.</p>
<div class="cell">
<div id="tbl-parks-boot-slopes" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-parks-boot-slopes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.4: Estimated slope and intercept for the first three bootstrap samples.
</figcaption>
<div aria-describedby="tbl-parks-boot-slopes-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">replicate</th>
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">intercept</td>
<td style="text-align: right;">2.383</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">0.005</td>
</tr>
<tr class="odd">
<td style="text-align: right;">2</td>
<td style="text-align: left;">intercept</td>
<td style="text-align: right;">2.545</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">0.002</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">intercept</td>
<td style="text-align: right;">2.386</td>
</tr>
<tr class="even">
<td style="text-align: right;">3</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">0.005</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div></li>
<li><p>We are focused on inference for <span class="math inline">\(\beta_1\)</span>, the slope of <code>per_capita_expend</code>, so we collect estimated slopes of <code>per_capita_expend</code> to make the bootstrap distribution. This is the approximation of the sampling distribution of <span class="math inline">\(\hat{\beta}_1\)</span>. A histogram and summary statistics for this distribution are shown in <a href="#fig-parks-boot-dist" class="quarto-xref">Figure&nbsp;<span>5.3</span></a> and <a href="#tbl-parks-boot-dist" class="quarto-xref">Table&nbsp;<span>5.5</span></a>, respectively.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-parks-boot-dist" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parks-boot-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="05-slr-inference_files/figure-html/fig-parks-boot-dist-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4" title="Figure&nbsp;5.3: Bootstrap distribution of the slope of `per_capita_expend"><img src="05-slr-inference_files/figure-html/fig-parks-boot-dist-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parks-boot-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.3: Bootstrap distribution of the slope of `per_capita_expend
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-parks-boot-dist" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-parks-boot-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.5: Summary statistics for bootstrap distribution of the slope <code>per_capita_expend</code>
</figcaption>
<div aria-describedby="tbl-parks-boot-dist-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">Std.Dev.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.003</td>
<td style="text-align: right;">0.002</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.004</td>
<td style="text-align: right;">0.002</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div></li>
</ol>
<div class="yourturn">
<p>How many values of <span class="math inline">\(\hat{\beta}_1\)</span> make up the bootstrap sampling distribution shown in <a href="#fig-parks-boot-dist" class="quarto-xref">Figure&nbsp;<span>5.3</span></a> and summarized in <a href="#tbl-parks-boot-dist" class="quarto-xref">Table&nbsp;<span>5.5</span></a> ?<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a></p>
</div>
<ol start="4" type="1">
<li>As the final step, we use the bootstrap distribution to calculate the lower and upper bounds of the 95% confidence interval. These bounds are calculated as the points that mark off the middle 95% of the distribution. These are the points that at the <span class="math inline">\(2.5^{th}\)</span> and <span class="math inline">\(97.5^{th}\)</span> percentiles, as shown by the vertical lines in <a href="#fig-parks-boot-ci" class="quarto-xref">Figure&nbsp;<span>5.4</span></a>.</li>
</ol>
<div class="cell">
<div class="cell-output-display">
<div id="fig-parks-boot-ci" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-parks-boot-ci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="05-slr-inference_files/figure-html/fig-parks-boot-ci-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5" title="Figure&nbsp;5.4: 95% bootstrap confidence interval for the slope of per_capita_spend"><img src="05-slr-inference_files/figure-html/fig-parks-boot-ci-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-parks-boot-ci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.4: 95% bootstrap confidence interval for the slope of <code>per_capita_spend</code>
</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell">
<div id="tbl-parks-boot-ci" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-parks-boot-ci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.6: 95% confidence interval for the slope
</figcaption>
<div aria-describedby="tbl-parks-boot-ci-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Lower bound (2.5th percentile)</th>
<th style="text-align: right;">Upper bound (97.5th percentile)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">0.001</td>
<td style="text-align: right;">0.007</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>The 95% bootstrapped confidence interval for <span class="math inline">\(\beta_1\)</span>, the slope of <code>per_capita_expend</code> is 0.001 to 0.007.</p>
<div class="yourturn">
<p>The points at what percentiles in the bootstrap distribution mark the lower and upper bounds for a</p>
<ul>
<li>90% confidence interval?</li>
<li>98% confidence interval?<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></li>
</ul>
</div>
</section>
<section id="interpreting-the-interval" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="interpreting-the-interval"><span class="header-section-number">5.4.2</span> Interpreting the interval</h3>
<p>The general interpretation of the 95% confidence interval for <span class="math inline">\(\beta_1\)</span>, the slope of <code>per_capita_expend</code> is</p>
<blockquote class="blockquote">
<p><em>We are 95% confident that the interval 0.001 to 0.007 contains the population slope for per capita expenditure in the model of the relationship between a city’s per capita expenditure and number of playgrounds per 10,000 residents.</em></p>
</blockquote>
<p>Though this interpretation indicates the range of values that may reasonably contain the true population slope for <code>per_capita_expend</code>, it still requires the reader to further interpret what it means about the relationship between <code>per_capita_expend</code> and <code>playgrounds</code>. It is more informative to interpret the confidence interval in a way that also utilizes the interpretation of the slope from <a href="#sec-parks-eda-model" class="quarto-xref"><span>Section 5.1.1</span></a> , so the reader more clearly understands what the confidence interval is conveying. Thus, a more complete and informative interpretation of the confidence interval is as follows:</p>
<blockquote class="blockquote">
<p><em>We are 95% confident that for each additional dollar a city spends per resident, there are between 0.001 to 0.007 more playgrounds per 10,000 residents, on average.</em></p>
</blockquote>
<p>This interpretation not only indicates the range of values as before, but it also clearly describes what this range means in terms of the average change in playgrounds per 10,000 residents as a city’s per capita expenditure increases.</p>
</section>
<section id="what-does-confidence-mean" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="what-does-confidence-mean"><span class="header-section-number">5.4.3</span> What does “confidence” mean?</h3>
<p>The beginning of the interpretation for a confidence interval is “We are <span class="math inline">\(C\%\)</span> confident…”. What does “<span class="math inline">\(C\%\)</span> confident” mean? The notion of “confidence” refers to the statistical process used construct the confidence interval. This means if we replicate the process thousands of times - obtain a sample of 97 cities, construct a bootstrap distribution for <span class="math inline">\(\hat{\beta}_1\)</span>, and calculate the bounds that mark the middle <span class="math inline">\(C\%\)</span> of the distribution<!--# is thousands correct here? what do others say about this long-run confidence?-->, the intervals defined by the upper and lower bounds would contain the value of <span class="math inline">\(\beta_1\)</span>, the true population slope, <span class="math inline">\(C\%\)</span> of the time.</p>
<p>In reality we don’t know the value of the population slope (if we did, we wouldn’t need statistical inference!), so we can’t definitively conclude if the interval constructed in <a href="#sec-construct-bootstrap-ci" class="quarto-xref"><span>Section 5.4.1</span></a> is one of the <span class="math inline">\(C\%\)</span> that contains the population slope or not. Though we aren’t certain that our interval contains the population slope, we can conclude with some level of confidence, <span class="math inline">\(C\%\)</span> confidence to be exact, that we think it does based on the process.</p>
<!--# Add a warning box or something that this is not the same as the probability that the population parameter is in the interval?-->
<!--# Use the analogy of Like the probability of heads before a coin flip  vs once you fill the coin, it either landed on heads or not. -->
<!--# from EM: Consider using a picture to illustrate this point.-->
<p>Thus far, we have used a confidence interval to produce a plausible range of values for the population slope. We can also test specific claims about the population slope using another inferential procedure called hypothesis testing.</p>
<!--# need to add callout box here about balancing accuracy adn precision!!!--->
</section>
</section>
<section id="sec-hypothesis-test-overview" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="sec-hypothesis-test-overview"><span class="header-section-number">5.5</span> Hypothesis tests</h2>
<p><strong>Hypothesis tests</strong> are used to evaluate a claim about about a population parameter. The claim could be based on previous research, an idea a research or business team wants to explore, or a general statement about the parameter. We will again focus on the population slope <span class="math inline">\(\beta_1\)</span>. Before getting into the details of simulation-based hypothesis tests, we’ll describe the steps for a hypothesis test based on a commonly used analogy, the general procedure of a court trial in the United States (US) judicial system. <!--# is there a better example than judicial. The judicial system seems fraught now-a-days--></p>
<!--# Do I need this long metaphor?-->
<section id="define-the-hypotheses" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="define-the-hypotheses"><span class="header-section-number">5.5.1</span> Define the hypotheses</h3>
<p>The first step of any hypothesis test (or trial) is to define the hypotheses that will be evaluated. These hypotheses are called the null and alternative. The <strong>null hypothesis</strong> <span class="math inline">\((H_0)\)</span> is the baseline condition typically indicating no relationship between the response and predictor, and the <strong>alternative hypothesis</strong> <span class="math inline">\((H_a)\)</span> is defined by the claim being tested. Typically, the claim is that there is some relationship between the two variables.</p>
<p>In the US judicial system, a defendant is deemed innocent unless proven otherwise. Therefore, the null and alternative hypotheses are <span class="math inline">\(H_0\)</span>: the defendant is not guilty, and <span class="math inline">\(H_a\)</span>: the defendant is guilty. We say that a person is “innocent until proven guilty beyond a reasonable doubt.” Therefore, the trial proceeds assuming the null hypothesis of innocence is true and the objective is to evaluate the strength of evidence against this hypothesis. The same is true for hypothesis testing in statistics. The test is conducted under the assumption that the null hypothesis, <span class="math inline">\(H_0\)</span>, is true, and we use statistical methods to evaluate the strength of the evidence against <span class="math inline">\(H_0\)</span>.</p>
<!--# add a collect the evidence/analyze the data step?-->
</section>
<section id="evaluate-the-evidence" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="evaluate-the-evidence"><span class="header-section-number">5.5.2</span> Evaluate the evidence</h3>
<p>The primary component of trial (or hypothesis test) is a presenting and evaluating the evidence. In a trial, this is the point when the evidence is presented and it is evaluated under the assumption the null hypothesis (defendant is not guilty) is true. Thus, the lens in which the evidence is being evaluated is “given the defendant is not guilty, how likely is it that this evidence would exist?”</p>
<p>For example, suppose an individual is on trial for a robbery at a jewelry store. The null hypothesis is that they are not guilty and did not rob the jewelry store. The alternative hypothesis is they are guilty and did rob the jewelry store. If there is evidence that the person was in a different city during the time of the jewelry store robbery, the evidence would be more in support of the null hypothesis of innocence. It seems plausible the individual could have been in a different city at the time of the robbery if the null hypothesis is true. Alternatively, if some of the missing jewelry was found in the individual’s car, the evidence would seem to be strongly in support of the alternative hypothesis. If the null hypothesis is true, it does not seem likely that the individual would have the missing jewelry in their car.</p>
<p>In hypothesis testing, the “evidence” being assessed is the analysis of the sample data. Thus we are considering the question “given the null hypothesis is true, how likely is it to observe the results seen in the sample data?” We will introduce approaches to address this question using simulation-based methods in <a href="#sec-slr-testing-sim" class="quarto-xref"><span>Section 5.6</span></a> and theory-based methods in <a href="#sec-slr-inf-clt-hypothesis-test" class="quarto-xref"><span>Section 5.8.3</span></a>.</p>
</section>
<section id="make-a-conclusion" class="level3" data-number="5.5.3">
<h3 data-number="5.5.3" class="anchored" data-anchor-id="make-a-conclusion"><span class="header-section-number">5.5.3</span> Make a conclusion</h3>
<p>There are two typical conclusions in a trial in the US judicial system - the defendant is guilty or not guilty based on the evidence. The criteria to conclude the alternative that a defendant is guilty is that the strength of evidence must be “beyond reasonable doubt”. If there is sufficiently strong evidence against the null hypothesis of not guilty, then the conclusion is the alternative hypothesis that the defendant is guilty. Otherwise, the conclusion is that the defendant is not guilty, indicating the evidence against the null was not strong enough to otherwise refute it. Note that this is the not the same as “accepting” the null hypothesis but rather indicating that there wasn’t enough evidence to suggest otherwise. <!--# is there some citation that supports this reasoning?--> <!--# is it worth digging into this subtle point here?--></p>
<p>Similarly in hypothesis testing, we will use a predetermined threshold to assess if the evidence against the null hypothesis is strong enough to reject the null hypothesis and conclude the alternative, or if there is not enough evidence “beyond a reasonable doubt” to draw a conclusion other than the assumed null hypothesis.</p>
</section>
</section>
<section id="sec-slr-testing-sim" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="sec-slr-testing-sim"><span class="header-section-number">5.6</span> Permutation tests</h2>
<p>Now that we have explained the general process of hypothesis testing, let’s take a look at hypothesis testing using a simulation-based approach, called a <strong>permutation test<em>.</em></strong></p>
<p>The four steps of permutation test for a slope <span class="math inline">\(\beta_1\)</span> are</p>
<ol type="1">
<li>State the null and alternative hypotheses.</li>
<li>Generate the null distribution.</li>
<li>Calculate the p-value.</li>
<li>Draw a conclusion.</li>
</ol>
<p>These steps are described in detail in the context of the hypothesis test for the slope in <a href="#eq-parks-stat-model" class="quarto-xref">Equation&nbsp;<span>5.1</span></a>.</p>
<section id="sec-slr-inf-hypotheses" class="level3" data-number="5.6.1">
<h3 data-number="5.6.1" class="anchored" data-anchor-id="sec-slr-inf-hypotheses"><span class="header-section-number">5.6.1</span> State the hypotheses</h3>
<p>As defined in <a href="#sec-hypothesis-test-overview" class="quarto-xref"><span>Section 5.5</span></a> the <strong>null hypothesis</strong> (<span class="math inline">\(H_0\)</span>) is the baseline condition, and the <strong>alternative hypothesis</strong> (<span class="math inline">\(H_a\)</span>) is defined by the claim being tested. Recall from <a href="#sec-slr-inf-data" class="quarto-xref"><span>Section 5.1</span></a> that one objective for the analysis in this chapter is to investigate whether per capita expenditure is useful in understanding variability in playground access in US cities. In terms of the linear regression model, the claim being tested is whether there is a linear relationship between <code>per_capita_expend</code> and <code>playgrounds</code>. The null hypothesis is the baseline condition of there being no linear relationship between the two variables. We use this claim to define the alternative hypothesis.</p>
<ul>
<li><strong>Null hypothesis:</strong> There is no linear relationship between playgrounds per 10,000 residents and per capita expenditure. The slope of <code>per_capita_expend</code> is equal to 0. <span class="math inline">\((H_0: \beta_1 = 0)\)</span></li>
<li><strong>Alternative hypothesis:</strong> There is a linear relationship between playgrounds per 10,000 residents and per capita expenditure. The coefficient of <code>per_capita_expend</code> is not equal to 0. <span class="math inline">\((H_a: \beta_1 \neq 0)\)</span>
<ul>
<li>Note that we have not hypothesized whether the slope is positive or negative.</li>
</ul></li>
</ul>
<p>The hypotheses are defined specifically in terms of the <u><strong>linear</strong></u> relationship between the two variables, because we are ultimately drawing conclusions about the slope <span class="math inline">\(\beta_1\)</span>.</p>
<div class="math_rules">
<p><strong>Mathematical statement of hypotheses for</strong> <span class="math inline">\(\beta_1\)</span></p>
<p>Suppose there is a response variable <span class="math inline">\(Y\)</span> and a predictor variable <span class="math inline">\(X\)</span> such that</p>
<p><span class="math display">\[
Y = \beta_0 + \beta_1X + \epsilon, \hspace{5mm} \epsilon \sim N(0, \sigma^2_\epsilon)
\]</span></p>
<p>The hypotheses for testing whether there is a linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> in the population are</p>
<p><span id="eq-slr-hypotheses"><span class="math display">\[
\begin{aligned}
&amp;H_0: \beta_1 = 0\\
&amp;H_a: \beta_1 \neq 0
\end{aligned}
\tag{5.5}\]</span></span></p>
</div>
<section id="one-vs.-two-sided-hypotheses" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="one-vs.-two-sided-hypotheses">One vs.&nbsp;two-sided hypotheses</h4>
<p>The alternative hypothesis defined in <a href="#eq-slr-hypotheses" class="quarto-xref">Equation&nbsp;<span>5.5</span></a> is “not equal to 0”. This is the alternative hypothesis corresponding to a <em>two-sided</em> hypothesis test, because it includes the scenarios in which <span class="math inline">\(\beta_1\)</span> is less than or greater than 0. There are two other options for defining the alternative hypothesis, “<span class="math inline">\(\beta_1\)</span> is less than 0” (<span class="math inline">\(H_a: \beta_1 &lt; 0\)</span>) and “<span class="math inline">\(\beta_1\)</span> is greater than 0” (<span class="math inline">\(H_a: \beta_1 &gt; 0\)</span>). These are <em>one-sided hypothesis tests</em>, as they only consider the alternative scenario in which <span class="math inline">\(\beta_1\)</span> is either less than or greater than 0, respectively.</p>
<p>A one-sided hypothesis test imposes some information about the direction of the parameter, that is positive (<span class="math inline">\(&gt; 0\)</span>) or negative ( <span class="math inline">\(&lt; 0\)</span>). Given this additional information imposed by the direction of the alternative hypothesis, it requires less evidence to reject the null hypothesis in favor of the alternative. Therefore, it is best to use a one-sided hypothesis only if (1) there is some indication from previous knowledge or research that the relationship between the response variable and the predictor variable is in a particular direction, or (2) only one direction of the relationship between the response and predictor variables is relevant in practice. Outside of these two scenarios, it is not advisable to use the one-sided hypothesis, as there could appear to be a statistically significant relationship between the two variables merely by chance of how the hypotheses were constructed.</p>
<p>Because a two-sided hypothesis test makes no assumption about the direction of the relationship between the response variable and predictor variable. It is a good starting point for drawing conclusions about the relationship between the two variables. From the two-sided hypothesis, we will conclude whether there is or is not sufficient statistical evidence of a linear relationship between the response and predictor. With this conclusion, we cannot determine if the relationship between the variables is positive or negative without additional analysis. We use a confidence interval (<a href="#sec-bootstrap-ci" class="quarto-xref"><span>Section 5.4</span></a>) to make specific conclusions about the direction and magnitude of the relationship.</p>
</section>
</section>
<section id="sec-slr-inf-permutation" class="level3" data-number="5.6.2">
<h3 data-number="5.6.2" class="anchored" data-anchor-id="sec-slr-inf-permutation"><span class="header-section-number">5.6.2</span> Simulate the null distribution</h3>
<p>Recall that hypothesis tests are conducted assuming the null hypothesis <span class="math inline">\(H_0\)</span> is true. Based on the hypotheses defined in <a href="#sec-slr-inf-hypotheses" class="quarto-xref"><span>Section 5.6.1</span></a>, a hypothesis test for the slope is conducted under the assumption <span class="math inline">\(\beta_1 = 0\)</span> , that there is no linear relationship between the response and predictor variables.</p>
<p>To assess the evidence, we will use a simulation-based method to approximate the sampling distribution of the estimated slope <span class="math inline">\(\hat{\beta}_1\)</span> under the assumption that <span class="math inline">\(H_0: \beta_1 = 0\)</span> is true. This distribution, called the <strong>null distribution</strong><em>,</em> allows us to understand the sample-to-sample variability under the scenario in which the true population slope equals 0. The variability in the simulated null distribution will be the same (or very similar since we are working with simulated data) as the variability in the bootstrap distribution, but the difference between the two distributions is the location of the center. The center for the bootstrap distribution in <a href="#sec-bootstrap-ci" class="quarto-xref"><span>Section 5.4</span></a> is close to the value of <span class="math inline">\(\hat{\beta}_1\)</span> estimated from the data. The center of the null distribution, however, is the null hypothesized value of 0. Therefore, to construct the null distribution for hypothesis testing, we will use a different simulation method, called <em>permutation sampling</em>.</p>
<p>In <strong>permutation sampling</strong> the values of the predictor variable are randomly shuffled and paired with values of the response, thus generating a new sample of the same size as the original data. The process of randomly pairing the values of the response and the predictor variables simulates the null hypothesized condition that there is no linear relationship between the two variables.</p>
<p>The steps for simulating the null distribution using permutation sampling are the following:</p>
<ol type="1">
<li>Generate <span class="math inline">\(n_{iter}\)</span> permutation samples, where <span class="math inline">\(n_{iter}\)</span> is the number of iterations. We ideally use at least 1,000 iterations in order to construct a distribution that is close to the theoretical null distribution defined in <a href="#sec-slr-inf-clt" class="quarto-xref"><span>Section 5.8</span></a>.</li>
<li>Fit the linear regression model to each of the <span class="math inline">\(n_{iter}\)</span> permutation samples to obtain <span class="math inline">\(n_{iter}\)</span> values of <span class="math inline">\(\hat{\beta}_1\)</span>, the estimated slope. There will also be <span class="math inline">\(n_{iter}\)</span> values of <span class="math inline">\(\hat{\beta}_0\)</span> the estimated intercepts; we will ignore those for now because we are focused on inference for the slope.</li>
<li>Collect the <span class="math inline">\(n_{iter}\)</span> values of <span class="math inline">\(\hat{\beta}_1\)</span> from the previous step to make the <strong>simulated null distribution</strong>. This is an approximation of the distribution of <span class="math inline">\(\hat{\beta}_1\)</span> values if we were to repeatedly take samples the same size as the original data and fit the linear regression model to each sample, under the assumption that the null hypothesis is true.</li>
</ol>
<p>Let’s simulate the null distribution to test the hypotheses in <a href="#eq-slr-hypotheses" class="quarto-xref">Equation&nbsp;<span>5.5</span></a> for the parks data.</p>
<ol type="1">
<li>First we generate 1,000 permutation samples, such that in each sample, we permute the values of <code>per_capita_expend</code>, randomly pairing each to a value of <code>playgrounds</code>. This is to simulate the scenario in which there is no linear relationship between <code>per_capita_expend</code> and <code>playgrounds</code>. The first 10 rows of the first permutation sample are in <a href="#tbl-slr-permute-samp" class="quarto-xref">Table&nbsp;<span>5.7</span></a>.</li>
</ol>
<div class="cell">
<div id="tbl-slr-permute-samp" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-slr-permute-samp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.7: First 10 rows of the first permutation sample. The replicate column identifies the permutation sample.
</figcaption>
<div aria-describedby="tbl-slr-permute-samp-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">replicate</th>
<th style="text-align: right;">playgrounds</th>
<th style="text-align: right;">per_capita_expend</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.1</td>
<td style="text-align: right;">319</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">307</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">219</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">301</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.6</td>
<td style="text-align: right;">190</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.2</td>
<td style="text-align: right;">250</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.3</td>
<td style="text-align: right;">215</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">399</td>
</tr>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">162</td>
</tr>
<tr class="even">
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.9</td>
<td style="text-align: right;">179</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<ol start="2" type="1">
<li>Next, we fit a linear regression model to each of the 1000 permutation samples. This gives us 1000 estimates of the slope and intercept. The slopes estimated from the first 10 permutation samples are shown in <a href="#tbl-slr-permute-data" class="quarto-xref">Table&nbsp;<span>5.8</span></a>.</li>
</ol>
<div class="cell">
<div id="tbl-slr-permute-data" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-slr-permute-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.8: Estimated slopes from first 10 permutation samples.
</figcaption>
<div aria-describedby="tbl-slr-permute-data-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">replicate</th>
<th style="text-align: left;">term</th>
<th style="text-align: right;">estimate</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">1</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">0.000</td>
</tr>
<tr class="even">
<td style="text-align: right;">2</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="odd">
<td style="text-align: right;">3</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">0.001</td>
</tr>
<tr class="even">
<td style="text-align: right;">4</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">-0.002</td>
</tr>
<tr class="odd">
<td style="text-align: right;">5</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">-0.002</td>
</tr>
<tr class="even">
<td style="text-align: right;">6</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">0.004</td>
</tr>
<tr class="odd">
<td style="text-align: right;">7</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">-0.002</td>
</tr>
<tr class="even">
<td style="text-align: right;">8</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">-0.002</td>
</tr>
<tr class="odd">
<td style="text-align: right;">9</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">-0.001</td>
</tr>
<tr class="even">
<td style="text-align: right;">10</td>
<td style="text-align: left;">per_capita_expend</td>
<td style="text-align: right;">0.001</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<ol start="3" type="1">
<li><p>Next, we collect the estimated slopes from the previous step to construct the simulated null distribution. We will use this distribution to assess the strength of the evidence from the original sample data against the null hypothesis.</p>
<div class="cell">
<div class="cell-output-display">
<div id="fig-null-dist-spend" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-null-dist-spend-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="05-slr-inference_files/figure-html/fig-null-dist-spend-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6" title="Figure&nbsp;5.5: Simulated null distribution to test the slope of per_capita_expend"><img src="05-slr-inference_files/figure-html/fig-null-dist-spend-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-null-dist-spend-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.5: Simulated null distribution to test the slope of <code>per_capita_expend</code>
</figcaption>
</figure>
</div>
</div>
</div></li>
</ol>
<div class="cell">
<div id="tbl-null-dist-spend" class="cell quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-null-dist-spend-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.9: Summary statistics of the simulated null distribution to test the slope of <code>per_capita_expend</code>
</figcaption>
<div aria-describedby="tbl-null-dist-spend-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<div class="cell-output-display">
<table class="do-not-create-environment cell caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">Min</th>
<th style="text-align: right;">Q1</th>
<th style="text-align: right;">Median</th>
<th style="text-align: right;">Q3</th>
<th style="text-align: right;">Max</th>
<th style="text-align: right;">Mean</th>
<th style="text-align: right;">Std.Dev.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">-0.005</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">-0.001</td>
<td style="text-align: right;">0.006</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.002</td>
</tr>
</tbody>
</table>
</div>
</div>
</figure>
</div>
</div>
<p>Note that the distribution visualized in <a href="#fig-null-dist-spend" class="quarto-xref">Figure&nbsp;<span>5.5</span></a> and summarized in <a href="#tbl-null-dist-spend" class="quarto-xref">Table&nbsp;<span>5.9</span></a> is approximately unimodal, symmetric, and looks similar to the normal distribution. As the number of iterations (permutation samples) increases, the simulated null distribution will be closer and closer to a normal distribution. Additionally, the center of the distribution is approximately 0, the null hypothesized value. The standard deviation of this distribution 0.002 is an estimate of the <strong>standard error</strong> of <span class="math inline">\(\hat{\beta}_1\)</span>, the sample-to-sample variability in the estimates of <span class="math inline">\(\hat{\beta}_1\)</span> when taking random samples of size 97, the same size as the original data.</p>
<div class="yourturn">
<p>How does the estimated variability in the simulated null distribution in <a href="#tbl-null-dist-spend" class="quarto-xref">Table&nbsp;<span>5.9</span></a> compare to the variability in the bootstrapped distribution in <a href="#tbl-parks-boot-dist" class="quarto-xref">Table&nbsp;<span>5.5</span></a>? Is this what you expected? Why or why not?<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
</div>
<!--# Make sure I'm using a picture in this section. Are there opportunities to use more?-->
<!--# From EM: Ask where the center of the distribution is and whether it makes sense: RESOLVED-->
</section>
<section id="sec-calc-pvalue" class="level3" data-number="5.6.3">
<h3 data-number="5.6.3" class="anchored" data-anchor-id="sec-calc-pvalue"><span class="header-section-number">5.6.3</span> Calculate p-value</h3>
<p>The null distribution helps us understand the values <span class="math inline">\(\hat{\beta}_1\)</span>, the slope of <code>per_capita_expend</code>, is expected to take if we repeatedly take random samples and fit a linear regression model, assuming the null hypothesis <span class="math inline">\(\beta_1 = 0\)</span> is true. To evaluate the strength of evidence against the null hypothesis, we will compare the estimated slope in <a href="#tbl-parks-model" class="quarto-xref">Table&nbsp;<span>5.2</span></a>, <span class="math inline">\(\hat{\beta}_1 =\)</span> 0.003 (the evidence) to what we would expect <span class="math inline">\(\hat{\beta}_1\)</span> to be based on the null distribution.</p>
<p>This comparison is quantified using a p-value. The <strong>p-value</strong> is the probability of observing estimated slopes at least as extreme as the value estimated from the sample data, given the null hypothesis is true. In the context of the parks data, the p-value is the probability of observing values of the slope that are at least as extreme as <span class="math inline">\(\hat{\beta}_1 =\)</span> 0.003 in the null distribution.</p>
<p>In the context of statistical inference, the phrase “more extreme” means the area between the estimated value ( <span class="math inline">\(\hat{\beta}_1\)</span> in our case), and the outer tail(s) of the simulated null distribution. The alternative hypothesis determines which tail(s) to include when calculating the p-value.</p>
<ul>
<li><p>If <span class="math inline">\(H_a: \beta_1 &gt; 0\)</span>, the p-value is the probability of obtaining a value in the null distribution that is greater than or equal to <span class="math inline">\(\hat{\beta}_1\)</span>.</p></li>
<li><p>If <span class="math inline">\(H_a: \beta_1 &lt; 0\)</span>, the p-value is the probability of obtaining a value in the null distribution that is less than or equal to <span class="math inline">\(\hat{\beta}_1\)</span>.</p></li>
<li><p>If <span class="math inline">\(H_a: \beta_1 \neq 0\)</span>, the p-value is the probability of obtaining a value in the null distribution whose absolute value is greater than or equal to <span class="math inline">\(\hat{\beta}_1\)</span> . This includes values that are greater than or equal to <span class="math inline">\(|\hat{\beta}_1|\)</span> or less than or equal to <span class="math inline">\(-|\hat{\beta}_1|\)</span>.</p></li>
</ul>
<!--# Include a figure to illustrate this-->
<p>Recall from <a href="#sec-slr-inf-hypotheses" class="quarto-xref"><span>Section 5.6.1</span></a> that we are testing a two-sided alternative hypothesis. Therefore, we will calculate the p-value corresponding to the alternative hypothesis <span class="math inline">\(H_a: \beta_1 \neq 0\)</span>. As illustrated in <a href="#fig-slr-inf-pvalue" class="quarto-xref">Figure&nbsp;<span>5.6</span></a>, this p-value is the probability of observing the slope that is 0.003 or more extreme, given the null hypothesis is true. In this case, it is the probability of observing a value in the null distribution that is greater than or equal to |0.003| or a value that is less than or equal to -|0.003|.</p>
<!--# Need to make code below reproducible, remove hard coding of slope-->
<p>The p-value for this hypothesis test is 0.046 and is shown by the dark shaded area in <a href="#fig-slr-inf-pvalue" class="quarto-xref">Figure&nbsp;<span>5.6</span></a>.</p>
<!--# check that this is color-blind accessible-->
<div class="cell">
<div class="cell-output-display">
<div id="fig-slr-inf-pvalue" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-slr-inf-pvalue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="05-slr-inference_files/figure-html/fig-slr-inf-pvalue-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7" title="Figure&nbsp;5.6: Simulated null distribution with p-value represented by the shaded area. The shaded area are values less than -0.003 and greater than 0.003."><img src="05-slr-inference_files/figure-html/fig-slr-inf-pvalue-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-slr-inf-pvalue-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.6: Simulated null distribution with p-value represented by the shaded area. The shaded area are values less than -0.003 and greater than 0.003.
</figcaption>
</figure>
</div>
</div>
</div>
<div class="yourturn">
<p>Use the definition of the p-value at the beginning of this section to interpret the p-value of 0.046 in the context of the data.<a href="#fn8" class="footnote-ref" id="fnref8" role="doc-noteref"><sup>8</sup></a></p>
</div>
<!--# add a practice?-->
</section>
<section id="sec-slr-inf-conclusion" class="level3" data-number="5.6.4">
<h3 data-number="5.6.4" class="anchored" data-anchor-id="sec-slr-inf-conclusion"><span class="header-section-number">5.6.4</span> Draw conclusion</h3>
<p>We ultimately want to evaluate the strength of evidence against the null hypothesis. The p-value is a measure of the strength of that evidence and is used to draw one of the following conclusions:</p>
<ul>
<li>If the p-value is “sufficiently small”, there is strong evidence against the null hypothesis. We <strong>reject the null hypothesis,</strong> <span class="math inline">\(H_0\)</span>, and conclude the alternative <span class="math inline">\(H_a\)</span>.</li>
<li>If the p-value is not “sufficiently small”, there is not strong enough evidence against the null hypothesis. We <strong>fail to reject the null hypothesis</strong>, <span class="math inline">\(H_0\)</span>, and stay with the null hypothesis.</li>
</ul>
<!--# add questions about whether conclusions are generalizable?-->
<p>We use a predetermined decision-making threshold called an <span class="math inline">\(\boldsymbol{\alpha}\)</span><strong>-level</strong> to determine if a p-value is sufficiently small enough to reject the null hypothesis.</p>
<ul>
<li><p>If <span class="math inline">\(\text{p-value} &lt; \alpha\)</span>, then reject <span class="math inline">\(H_0\)</span></p></li>
<li><p>If <span class="math inline">\(\text{p-value} \geq \alpha\)</span>, then fail to reject <span class="math inline">\(H_0\)</span>.</p></li>
</ul>
<p>A commonly used threshold is <span class="math inline">\(\alpha = 0.05\)</span>. If stronger evidence is required to reject the null hypothesis,<!--# Maybe explain why this might be the case--> then a lower threshold can be used to make a conclusion. If such strong evidence is not required (this may be the case in analyses with very small sample sizes), then a threshold can be used. It is general convention to use a threshold 0.1 or less, so any p-value 0.1 is considered large enough to fail to reject the null hypothesis.</p>
<p>Back to the parks analysis. We will use the common threshold of <span class="math inline">\(\alpha = 0.05\)</span>.</p>
<blockquote class="blockquote">
<p><em>The p-value calculated in the previous section is 0.046. Therefore, we reject the null hypothesis</em> <span class="math inline">\(H_0\)</span><em>. The data provide sufficient evidence of a linear relationship between the amount a city spends per resident and the number of playgrounds per 10,000 residents.</em></p>
</blockquote>
</section>
<section id="type-i-and-type-ii-error" class="level3" data-number="5.6.5">
<h3 data-number="5.6.5" class="anchored" data-anchor-id="type-i-and-type-ii-error"><span class="header-section-number">5.6.5</span> Type I and Type II error</h3>
<p>Regardless of the conclusion that is drawn (reject or fail to reject the null hypothesis), we have not determined that the null or alternative hypothesis are definitive truth. We have just concluded that the evidence (the data) has provided more evidence in favor of one conclusion versus the other. As with any statistical procedure, there is the possibility of making an error, more specifically a Type I or Type II error. Because we don’t know the value of the population slope, we will not know for certain whether we have made an error; however, understanding the potential errors that can be made can help inform the decision-making threshold <span class="math inline">\(\alpha\)</span> and make a more informed assessment about the implication of these results in practice.</p>
<p><a href="#tbl-errors" class="quarto-xref">Table&nbsp;<span>5.10</span></a> shows how Type I and Type II errors correspond to the (unknown) truth and the conclusion drawn from the hypothesis test.</p>
<!--# figure out how to better format this table, so decision and truth are in the middle-->
<div id="tbl-errors" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-tbl figure">
<figcaption class="quarto-float-caption-top quarto-float-caption quarto-float-tbl" id="tbl-errors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Table&nbsp;5.10: Type I and Type II error
</figcaption>
<div aria-describedby="tbl-errors-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<table class="caption-top table">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th></th>
<th><strong>Truth</strong></th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td></td>
<td></td>
<td><span class="math inline">\(H_0\)</span> <strong>true</strong></td>
<td><span class="math inline">\(H_a\)</span> <strong>true</strong></td>
</tr>
<tr class="even">
<td><strong>Hypothesis test decision</strong></td>
<td><strong>Fail to reject</strong> <span class="math inline">\(H_0\)</span></td>
<td>Correct decision</td>
<td>Type II error</td>
</tr>
<tr class="odd">
<td></td>
<td><strong>Reject</strong> <span class="math inline">\(H_0\)</span></td>
<td>Type I error</td>
<td>Correct decision</td>
</tr>
</tbody>
</table>
</div>
</figure>
</div>
<p>A <strong>Type I error</strong> has occurred if the null hypothesis is actually true, but the p-value is small enough to reject the null hypothesis. The probability of making this type of error is the decision-making threshold <span class="math inline">\(\alpha\)</span>. This is because <span class="math inline">\(P(\text{reject }H_0 | H_0 \text{ true}) = \alpha\)</span>, meaning the probability of rejecting the null hypothesis given the null is true is <span class="math inline">\(\alpha\)</span>.</p>
<p>A <strong>Type II error</strong> has occurred if the alternative hypothesis is actually true, but we fail to reject the null hypothesis, because the p-value is large. Computing the probability of making this type of error is less straightforward. It is calculated as <span class="math inline">\(1 - Power\)</span> , where the <span class="math inline">\(Power = P(\text{reject }H_0 | H_a \text{ true})\)</span>. <!--# insert some discussion of the power, or is this a rabbit hole?--></p>
<p>In the context of the parks data, a Type I error is concluding that there is a linear relationship between per capita expenditure and playgrounds per 10,000 residents in the model, when there actually isn’t one in the population. A Type II error is concluding there is no linear relationship between per capita expenditure and playgrounds per 10,000 residents when in fact there is.</p>
<div class="yourturn">
<p>Given the conclusion in <a href="#sec-slr-inf-conclusion" class="quarto-xref"><span>Section 5.6.4</span></a>, is it possible we’ve made a Type I or Type II error?<a href="#fn9" class="footnote-ref" id="fnref9" role="doc-noteref"><sup>9</sup></a></p>
</div>
</section>
</section>
<section id="sec-slr-inf-relationship-ci-test" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="sec-slr-inf-relationship-ci-test"><span class="header-section-number">5.7</span> Relationship between confidence intervals and hypothesis tests</h2>
<p>At this point, we might wonder whether there is any connection between the confidence intervals and hypothesis tests. Spoiler alert: there is!</p>
<p>Testing a claim with the two-sided alternative <span class="math inline">\(H_a: \beta_1 \neq 0\)</span> and decision-making threshold <span class="math inline">\(\alpha\)</span> is equivalent to using the <span class="math inline">\(C\%\)</span> confidence interval to evaluate the claim, where <span class="math inline">\(C = (1 - \alpha)\times100\)</span>. This means we can also use confidence intervals to evaluate two-sided hypotheses. When using a confidence interval to draw conclusions about a claim, we use the following guide:</p>
<ul>
<li><p>If the null hypothesized value ( <span class="math inline">\(0\)</span> based on the tests defined in <a href="#sec-slr-inf-hypotheses" class="quarto-xref"><span>Section 5.6.1</span></a> ) is within the range of the confidence interval, <em>fail to reject</em> <span class="math inline">\(H_0\)</span> at the <span class="math inline">\(\alpha\)</span>-level.</p></li>
<li><p>If the null hypothesized value is not within the range of the confidence interval, <em>reject</em> <span class="math inline">\(H_0\)</span> at the <span class="math inline">\(\alpha\)</span>-level.</p></li>
</ul>
<p>This illustrates the power of confidence intervals; they can not only be used to draw a conclusion about a claim (reject or fail to reject <span class="math inline">\(H_0\)</span>), but they also give the range values that the population slope may take. Thus, it is good practice to always report the confidence interval, because the confidence interval provides more detail about a population slope <span class="math inline">\(\beta_1\)</span> beyond the reject/fail to reject conclusion of the hypothesis test.</p>
<div class="analysis_in_practice">
<p>When we reject a null hypothesis, we conclude that there is a statistically significant linear relationship <!--# do i want to use other term, i.e., statistically discernible--> between the response and predictor variables. Concluding there is <em>statistically significant</em> relationship between the response and predictor, however, does not necessarily mean that the relationship is <em>practically significant</em>. The practical significance, how meaningful the results are in the real world, is determined by the magnitude of the estimated slope of the predictor on the response and what an effect of that magnitude means in the context of the data and analysis question.</p>
</div>
<!--# do i want to talk about effect size?-->
</section>
<section id="sec-slr-inf-clt" class="level2" data-number="5.8">
<h2 data-number="5.8" class="anchored" data-anchor-id="sec-slr-inf-clt"><span class="header-section-number">5.8</span> Theory-based inference</h2>
<!--# maybe i rename this as inference using theoretical modes and just remove CLT-->
<!--# figure out how to use pictures to illustrate concepts here-->
<p>Thus far we have approached inference using simulation-based methods (bootstrapping and permutation) to generate sampling distributions and null distributions. When certain conditions are met, however, we can use theoretical results about the sampling distribution to understand the variability in <span class="math inline">\(\hat{\beta}_1\)</span>. In this section, we present that theory, then use it to conduct statistical inference for the population slope. Notice as we go through this section is that the inferential procedures and conclusions are very similar as before. The primary difference is in how we understand the sampling variability in <span class="math inline">\(\hat{\beta}_1\)</span> and obtain the null distribution.</p>
<section id="sec-slr-clt" class="level3" data-number="5.8.1">
<h3 data-number="5.8.1" class="anchored" data-anchor-id="sec-slr-clt"><span class="header-section-number">5.8.1</span> Central Limit Theorem</h3>
<!--# maybe add something in the appendix that the CLT is not needed if we have normal errors-->
<p>The <strong>Central Limit Theorem (CLT)</strong> is a foundational theorem in statistics about the distribution of a statistic and the associated mathematical properties of that distribution. <!--# find a source for a good statement of CLT-->For the purposes of this text, we will focus on what the Central Limit Theorem says the distribution of an estimated slope <span class="math inline">\(\hat{\beta}_1\)</span>, but note that this theorem applies to statistics other than the slope. We will also focus on the results of the theorem and less so on derivations or advanced mathematical details of the Central Limit Theorem.<!--# Texts such as [insert references] or the appendix may be of interest to those seeking more detail about the theorem.--></p>
<p>By the Central Limit Theorem, we know under certain conditions (more on these conditions in the <a href="06-slr-conditions.html" class="quarto-xref"><span>Chapter 6</span></a>) <span id="eq-slope-dist-clt"><span class="math display">\[\hat{\beta}_1 \sim N(\beta_1, SE_{\hat{\beta}_1}) \tag{5.6}\]</span></span></p>
<p><a href="#eq-slope-dist-clt" class="quarto-xref">Equation&nbsp;<span>5.6</span></a> means that by the Central Limit Theorem, we know that the sampling distribution of <span class="math inline">\(\hat{\beta}_1\)</span> is (1) normal, (2) with a expected value at the true slope <span class="math inline">\(\beta_1\)</span>, and (3) a standard error of <span class="math inline">\(SE_{\hat{\beta}_1}\)</span><a href="#fn10" class="footnote-ref" id="fnref10" role="doc-noteref"><sup>10</sup></a>. The center of this distribution <span class="math inline">\(\beta_1\)</span> is unknown; the purpose of statistical inference is to draw conclusions about <span class="math inline">\(\beta_1\)</span>. The standard error of this distribution <span class="math inline">\(SE_{\hat{\beta}_1}\)</span> is</p>
<p><span id="eq-slr-se"><span class="math display">\[
SE_{\hat{\beta}_1} = \hat{\sigma}_{\epsilon}\sqrt{\frac{1}{(n-1)s_X^2}}
\tag{5.7}\]</span></span></p>
<p>where <span class="math inline">\(n\)</span> is the number of observations, <span class="math inline">\(s_X^2\)</span> is the variance of the predictor variable <span class="math inline">\(X\)</span>, and <span class="math inline">\(\hat{\sigma}_{\epsilon}\)</span> is the <strong>regression standard error</strong>, the variability of the observations around the regression line. The regression error is introduced in more detail in <a href="#sec-estimate-reg-std-err" class="quarto-xref"><span>Section 5.8.2</span></a>. The details of how this formula is derived is beyond the scope of this text, but let’s take a moment to think about what we know about the sampling variability of <span class="math inline">\(\hat{\beta}_1\)</span> from <a href="#eq-slr-se" class="quarto-xref">Equation&nbsp;<span>5.7</span></a>.</p>
<p>The regression standard error <span class="math inline">\(\hat{\sigma}_\epsilon\)</span> is in the numerator, indicating one would expect more variability in <span class="math inline">\(\hat{\beta}_1\)</span> when there is more variability in the data about the regression line. The variability in the predictor variable <span class="math inline">\(s_X^2\)</span> is in the denominator, indicating we expect more variability in <span class="math inline">\(\hat{\beta}_1\)</span> when there is less variability in the values of the predictor. Therefore, <span class="math inline">\(SE_{\hat{\beta}_1}\)</span> is the balance between the variability about the regression line and the variability in the predictor variable itself.</p>
<p>As you will see in the following sections, we will use this estimate of the sampling variability in the estimated slope to draw conclusions about the true relationship between the response and predictor variables based on hypothesis testing and confidence intervals.</p>
</section>
<section id="sec-estimate-reg-std-err" class="level3" data-number="5.8.2">
<h3 data-number="5.8.2" class="anchored" data-anchor-id="sec-estimate-reg-std-err"><span class="header-section-number">5.8.2</span> Estimating <span class="math inline">\(\sigma_{\epsilon}\)</span></h3>
<p>As discussed in <a href="04-slr.html#sec-slr-specify" class="quarto-xref"><span>Section 4.3.1</span></a>, there are three parameters that need to be estimated for simple linear regression <span class="math inline">\(\beta_0\)</span>, <span class="math inline">\(\beta_1\)</span>, and <span class="math inline">\(\sigma_{\epsilon}\)</span>. <a href="04-slr.html#sec-slr-estimation" class="quarto-xref"><span>Section 4.4</span></a> introduced least squares regression, a method for deriving <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span> the estimates for intercept and slope, respectively. Now, we turn to the estimation of <span class="math inline">\(\sigma_\epsilon\)</span>, also known as the <strong>regression standard error<em>.</em></strong></p>
<!--# maybe add a little aside here about standard deviation versus standard error-->
<p>By obtaining the estimates <span class="math inline">\(\hat{\beta}_0\)</span> and <span class="math inline">\(\hat{\beta}_1\)</span>, we have the equation of the regression line and therefore can estimate the expected value <span class="math inline">\(Y\)</span> given a value of the predictor <span class="math inline">\(X\)</span>. We can then use the residuals (<span class="math inline">\(e_i = y_i - \hat{y}_i\)</span>) to estimate the variability of the distribution of the response variable about the regression line (see <a href="#sec-slr-foundation" class="quarto-xref"><span>Section 5.3</span></a>). The regression standard error is the estimate of this variability as it is the estimated standard deviation of the distribution of the errors (<a href="#eq-slr-model-ch5" class="quarto-xref">Equation&nbsp;<span>5.3</span></a>). The equation for the regression standard error is shown in <a href="#eq-slr-reg-se" class="quarto-xref">Equation&nbsp;<span>5.8</span></a> <a href="#fn11" class="footnote-ref" id="fnref11" role="doc-noteref"><sup>11</sup></a>.</p>
<p><span id="eq-slr-reg-se"><span class="math display">\[
\hat{\sigma}_{\epsilon} = \sqrt{\frac{\sum_{i = 1}^ne_i^2}{n - 2}} = \sqrt{\frac{\sum_{i = 1}^n(y_i - \hat{y}_i)^2}{n - 2}}
\tag{5.8}\]</span></span></p>
<div class="math_rules">
<p>You may have noticed that the denominator in <a href="#eq-slr-reg-se" class="quarto-xref">Equation&nbsp;<span>5.8</span></a> is <span class="math inline">\(n - 2\)</span> not <span class="math inline">\(n\)</span> or <span class="math inline">\(n-1\)</span>. The value <span class="math inline">\(n - 2\)</span> is called the <strong>degrees of freedom (df)</strong>. The degrees of freedom are how many observations are available to understand variability about the regression line. We need at a minimum two observations to estimate the equation for the simple linear regression line, i.e., it takes at a minimum two points to make a line. The remaining <span class="math inline">\(n-2\)</span> observations help us understand variability about the line. We will talk more about how we use degrees of freedom as we define the distribution used to compute confidence intervals and conduct hypothesis tests. <!--# consider an illlustration here--></p>
</div>
<p>Recall that the standard deviation is the average distance between each observation and the mean of the distribution. Similarly, the regression standard error can be thought of as the average distance the observed value the response is from the regression line. The regression standard error <span class="math inline">\(\hat{\sigma}_{\epsilon}\)</span> is used to quantify the sampling variability in the estimated slope <span class="math inline">\(\hat{\beta}_1\)</span> (<a href="#eq-slr-se" class="quarto-xref">Equation&nbsp;<span>5.7</span></a>), so we will use this value as we conduct inference on the slope.</p>
</section>
<section id="sec-slr-inf-clt-hypothesis-test" class="level3" data-number="5.8.3">
<h3 data-number="5.8.3" class="anchored" data-anchor-id="sec-slr-inf-clt-hypothesis-test"><span class="header-section-number">5.8.3</span> Hypothesis test for the slope</h3>
<p>The overall goals of hypothesis tests for a population slope are the same when using theory-based methods as previously described in <a href="#sec-hypothesis-test-overview" class="quarto-xref"><span>Section 5.5</span></a>. We define a null and alternative hypothesis, conduct testing assuming the null hypothesis is true, and draw a conclusion based on an evaluation of the strength of evidence against the null hypothesis. The main difference from the simulation-based approach in <a href="#sec-slr-testing-sim" class="quarto-xref"><span>Section 5.6</span></a> is in how we quantify the variability in <span class="math inline">\(\hat{\beta}_1\)</span> and thus obtain the null distribution. In <a href="#sec-slr-inf-permutation" class="quarto-xref"><span>Section 5.6.2</span></a> we used permutation sampling to generate the null distribution. We’ll see that by the Central Limit Theorem we have results that specify exactly how the null distribution is defined.</p>
<p>The steps for conducting a hypothesis test based on the Central Limit Theorem are the following:</p>
<ol type="1">
<li>State the null and alternative hypotheses.</li>
<li>Calculate a test statistic.</li>
<li>Calculate a p-value.</li>
<li>Draw a conclusion.</li>
</ol>
<p>As in <a href="#sec-slr-testing-sim" class="quarto-xref"><span>Section 5.6</span></a> the goal is to use hypothesis testing to determine whether there is evidence of a statistically significant linear relationship between a response and predictor variable, corresponding to the two-sided alternative hypothesis of “not equal to 0”. Therefore, the null and alternative hypotheses are the same as defined in <a href="#eq-slr-hypotheses" class="quarto-xref">Equation&nbsp;<span>5.5</span></a> <span class="math display">\[
\begin{aligned}
H_0: \beta_1 = 0 \\
H_a: \beta_1 \neq 0 \\
\end{aligned}
\]</span></p>
<p>The next step is to calculate a test statistic. Similar to a <span class="math inline">\(z\)</span>-score in the Normal distribution, the test statistic tells us how far the observed slope is from the hypothesized center of the distribution. The general form of a test statistic is</p>
<p><span class="math display">\[
T = \frac{\text{estimate } - \text{ hypothesized}}{\text{standard error}}
\]</span></p>
<p>More specifically, in the hypothesis test for <span class="math inline">\(\beta_1\)</span>, the test statistic is</p>
<p><span id="eq-test-stat"><span class="math display">\[
T = \frac{\hat{\beta}_1 - 0}{SE_{\hat{\beta}_1}}
\tag{5.9}\]</span></span></p>
<p>To calculate the test statistic, the estimated slope is shifted by the mean, and then rescaled by the standard error. Let’s consider what we learn from the test statistic. Recall that by the Central Limit Theorem, the distribution of <span class="math inline">\(\hat{\beta}_1\)</span> is <span class="math inline">\(N(\beta_1, SE_{\hat{\beta}_1})\)</span>. Because we conduct hypothesis testing under the assumption the null hypothesis is true, we are assuming that the mean of this distribution of <span class="math inline">\(\beta_1= 0\)</span>.</p>
<p>Since the hypothesized mean is <span class="math inline">\(\beta_1 = 0\)</span>, we shift by 0 and rescale by <span class="math inline">\(SE_{\hat{\beta}_1}\)</span>, defined in <a href="#eq-slr-se" class="quarto-xref">Equation&nbsp;<span>5.7</span></a>. Thus, the test statistic is the number of standard errors the estimated slope is from the hypothesized mean of the sampling distribution. The magnitude of the test statistic <span class="math inline">\(|T|\)</span> provides a measure of how far the observed slope is from the center of the distribution, and the sign of <span class="math inline">\(T\)</span> indicates whether the observed slope is above (positive sign) or below (negative sign) the hypothesized mean of 0.</p>
<div class="yourturn">
<p>Consider the magnitude of the test statistic, <span class="math inline">\(|T|\)</span>. Do you think test statistics with small magnitude provide evidence in support or against the null hypothesis? What about test statistics with large magnitude?<a href="#fn12" class="footnote-ref" id="fnref12" role="doc-noteref"><sup>12</sup></a></p>
</div>
<p>Next, we use the test statistic to calculate a p-value and we will ultimately use the p-value to draw a conclusion about the strength of the evidence against the null hypothesis, as before. The test statistic, <span class="math inline">\(T\)</span>, follows a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n -2\)</span> degrees of freedom, denoted as <span class="math inline">\(T \sim t_{n-2}\)</span> . Similar to the simulated null distribution in <a href="#sec-slr-inf-permutation" class="quarto-xref"><span>Section 5.6.2</span></a>, we use this <span class="math inline">\(t_{n-2}\)</span> distribution to evaluate how far the estimated slope is from what we would expect given the null hypothesis is true.</p>
<p>Though the sampling distribution of <span class="math inline">\(\hat{\beta}_1\)</span> is normal by the Central Limit Theorem (<a href="#eq-slope-dist-clt" class="quarto-xref">Equation&nbsp;<span>5.6</span></a>), the test statistic follows a <span class="math inline">\(t\)</span> distribution. The <span class="math inline">\(t\)</span> distribution is used, because the value <span class="math inline">\(SE_{\hat{\beta}_1}\)</span> in the test statistic is calculated using the regression standard error, <span class="math inline">\(\hat{\sigma}_\epsilon\)</span> (see <a href="#eq-slr-se" class="quarto-xref">Equation&nbsp;<span>5.7</span></a>) We know the estimates <span class="math inline">\(\hat{\sigma}_\epsilon\)</span> and <span class="math inline">\(SE_{\hat{\beta}_1 }\)</span> are likely not equal to the true population values, so we need a distribution that allows for a bit more variability when calculating the p-value. The <span class="math inline">\(t\)</span> distribution better accounts for this extra variability compared to the standard normal distribution.</p>
<div class="math_rules">
<p><a href="#fig-normal-t-curves" class="quarto-xref">Figure&nbsp;<span>5.7</span></a> shows the standard normal distribution <span class="math inline">\(N(0,1)\)</span> and the <span class="math inline">\(t\)</span> distribution for different degrees of freedom. The <span class="math inline">\(t\)</span> distribution is very similar to the standard normal distribution: they are both centered at 0 and have a shape that is unimodal and symmetric. In other words, they both look like “bell curves” centered at 0. The difference is that the <span class="math inline">\(t\)</span> distribution allows for more variability than what is expected in the standard normal distribution. This is also referred to as having “heavier tails”. The <span class="math inline">\(t\)</span> distribution has more area under the curve in the tails (or more extreme values) of the distribution, meaning that more extreme values are more likely under the <span class="math inline">\(t\)</span> distribution than under the <span class="math inline">\(N(0,1)\)</span> distribution. This is most clearly seen by th comparing the height of tails for <span class="math inline">\(t_2\)</span> and <span class="math inline">\(N(0,1)\)</span>. As the degrees of freedom increase, the <span class="math inline">\(t\)</span> distribution becomes closer to the the standard normal distribution.<br>
</p>
<!--# consider making this graph a bit easier to read-->
<div class="cell">
<div class="cell-output-display">
<div id="fig-normal-t-curves" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-normal-t-curves-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<a href="05-slr-inference_files/figure-html/fig-normal-t-curves-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8" title="Figure&nbsp;5.7: Standard normal vs.&nbsp;t distributions"><img src="05-slr-inference_files/figure-html/fig-normal-t-curves-1.png" class="img-fluid figure-img" style="width:100.0%"></a>
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-normal-t-curves-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;5.7: Standard normal vs.&nbsp;t distributions
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<p>As described in <a href="#sec-calc-pvalue" class="quarto-xref"><span>Section 5.6.3</span></a>, because the alternative hypothesis is “not equal to”, the p-value is calculated on both the high and low extremes of the distribution as shown in <a href="#eq-pvalue-two-sided" class="quarto-xref">Equation&nbsp;<span>5.10</span></a>.</p>
<p><span id="eq-pvalue-two-sided"><span class="math display">\[
\begin{aligned}
&amp;\text{p-value} = Pr(|t| &gt; |T|) = Pr(t &lt; -|T| \text{ or } t &gt; |T|) \\[5pt]
&amp;\text{where } t \sim t_{n-2}
\end{aligned}
\tag{5.10}\]</span></span></p>
<p>We compare the p-value to a decision-making threshold <span class="math inline">\(\alpha\)</span> to draw final conclusions. If <span class="math inline">\(\text{p-value} &lt; \alpha\)</span> , we reject the null hypothesis and conclude the alternative. Otherwise, we fail to reject the null hypothesis. See <a href="#sec-slr-inf-conclusion" class="quarto-xref"><span>Section 5.6.4</span></a> for more detail about using the <span class="math inline">\(\alpha\)</span>-level and p-value to draw conclusions.</p>
<p>Now let’s apply this process to test whether there is evidence of a linear relationship between per capita expenditure and the number of playgrounds per 10,000 residents. As before, the null and and alternative hypotheses are</p>
<p><span class="math display">\[
\begin{aligned}
&amp;H_0: \beta_{1} = 0 \\
&amp;H_a: \beta_{1} \neq 0
\end{aligned}
\]</span></p>
<p>where <span class="math inline">\(\beta_1\)</span> is the true slope between <code>per_capita_expend</code> and <code>playgrounds</code>. The observed slope from <a href="#tbl-parks-model" class="quarto-xref">Table&nbsp;<span>5.2</span></a>, we know the observed slope <span class="math inline">\(\hat{\beta}_{1}\)</span> is 0.003 and the estimated standard error <span class="math inline">\(SE_{\hat{\beta}_{1}}\)</span> is 0.002. The test statistic is</p>
<p><span class="math display">\[
T = \frac{0.0033 - 0}{0.0016} = 2.063
\]</span></p>
<p>This test statistic means that assuming the true slope of <code>per_capita_expend</code> in this model is 0 and thus the mean of the distribution of <span class="math inline">\(\hat{\beta}_{1}\)</span> is 0, the observed slope of 0.003 is 2.063 standard errors above this hypothesized mean. It’s difficult to determine whether or not this is really “far enough” away from the center of the distribution, but we can calculate a p-value to determine the probability of observing a slope at least this far given the null hypothesis is true.</p>
<p>Given there are <span class="math inline">\(n\)</span> = 97 observations, the test statistic follows a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(97 - 2 =\)</span> 95 degrees of freedom. The p-value, is <span class="math inline">\(Pr(t &lt; - |2.063| \text{ or } t &gt; |2.063|) =\)</span> 0.042.</p>
<p>Using a decision-making threshold <span class="math inline">\(\alpha = 0.05\)</span>, the p-value <span class="math inline">\(0.042\)</span> is sufficiently small, so we reject the null hypothesis. The data provide sufficient evidence that the coefficient of <code>per_capita_expend</code> is not 0 in this model and that there is a statistically significant linear relationship between a city’s per capita expenditure and playgrounds per 10,000 residents in US cities.</p>
<p>Note that this conclusion is the same as in <a href="#sec-slr-inf-conclusion" class="quarto-xref"><span>Section 5.6.4</span></a> using a simulation-based approach (even with small differences in the p-value). This is what we would expect, given these are the two different approaches for conducting the same inferential process. We are also conducting the tests under the same assumptions that the null hypothesis is true. The difference is in the methods available to quantify <span class="math inline">\(SE_{\hat{\beta}_1}\)</span>, simulation-based versus theory-based.</p>
</section>
<section id="confidence-interval" class="level3" data-number="5.8.4">
<h3 data-number="5.8.4" class="anchored" data-anchor-id="confidence-interval"><span class="header-section-number">5.8.4</span> Confidence interval</h3>
<p>As with simulation-based inference, a confidence interval calculated based on the results from the Central Limit Theorem is an estimated range of the values that <span class="math inline">\(\beta_1\)</span> can reasonably take. The purpose, interpretation, and conclusions drawn from confidence intervals are the same as described before in <a href="#sec-bootstrap-ci" class="quarto-xref"><span>Section 5.4</span></a>. What differs, however, is how the interval is calculated. In simulation-based inference, we used bootstrapping to construct a sampling distribution to understand sample-to-sample variability in <span class="math inline">\(\beta_1\)</span>. By the Central Limit Theorem, we know exactly how to quantify the sample-to-sample variability in <span class="math inline">\(\hat{\beta}_1\)</span> using theoretical results.</p>
<p>The equation for a <span class="math inline">\(C\%\)</span> confidence interval for <span class="math inline">\(\beta_1\)</span> is</p>
<p><span id="eq-conf-int-beta"><span class="math display">\[
\hat{\beta}_1 \pm t^* \times SE_{\hat{\beta}_1}
\tag{5.11}\]</span></span></p>
<p>where <span class="math inline">\(t^* \sim t_{n - 2}\)</span>.</p>
<p>In <a href="#sec-slr-clt" class="quarto-xref"><span>Section 5.8.1</span></a>, we discussed <span class="math inline">\(\hat{\beta}_1\)</span> and its standard error <span class="math inline">\(SE_{\hat{\beta}_1}\)</span>. Now we’ll focus on <span class="math inline">\(t^*\)</span>, known as the critical value.</p>
<p>The <strong>critical value</strong> is the point on the <span class="math inline">\(t_{n-2}\)</span> distribution such that the probability of being between <span class="math inline">\(-t^*\)</span> and <span class="math inline">\(t^*\)</span> is <span class="math inline">\(C\%\)</span>. Thinking about this visually, this is the point such that the <span class="math inline">\(C\%\)</span> of the area under the curve is between <span class="math inline">\(-t^*\)</span> and <span class="math inline">\(t^*\)</span>. Note that we are still using a <span class="math inline">\(t\)</span> distribution with <span class="math inline">\(n - 2\)</span> degrees of freedom, the same distribution used to calculate the p-value in the hypothesis tests. The critical value can be calculated from modern statistical software or using online apps (more on this in <a href="#sec-theory-inf-r" class="quarto-xref"><span>Section 5.9.3</span></a>).</p>
<!--# add illustration of the critical value-->
<p>Let’s calculate the 95% confidence interval for the slope of <code>per_capita_spend</code>. There are 97 observations, so we use the <span class="math inline">\(t\)</span> distribution with 95 degrees of freedom. The critical value on the <span class="math inline">\(t_{95}\)</span> distribution is 1.985. Plugging these values into <a href="#eq-conf-int-beta" class="quarto-xref">Equation&nbsp;<span>5.11</span></a>, the 95% confidence interval is</p>
<p><span id="eq-parks-ci"><span class="math display">\[
\begin{aligned}
0.0033 \pm 1.985 \times 0.0016 \\
0.0033 \pm 0.0032 \\
[0.0001, 0.0065]
\end{aligned}
\tag{5.12}\]</span></span></p>
<p>The interpretation is the same as before: We are 95% confident that the interval 0.0001 to 0.0065 contains the true slope for <code>per_capita_expend</code>. This means we are 95% confident that for each additional dollar increase in per capita expenditure, there are 0.0001 to 0.0065 more playgrounds per 10,000 residents, on average.</p>
</section>
</section>
<section id="inference-in-r" class="level2" data-number="5.9">
<h2 data-number="5.9" class="anchored" data-anchor-id="inference-in-r"><span class="header-section-number">5.9</span> Inference in R</h2>
<section id="sec-slr-bootstrap-r" class="level3" data-number="5.9.1">
<h3 data-number="5.9.1" class="anchored" data-anchor-id="sec-slr-bootstrap-r"><span class="header-section-number">5.9.1</span> Bootstrap confidence intervals in R</h3>
<p>The bootstrap distribution and confidence interval are computed using the <strong>infer</strong> package <span class="citation" data-cites="infer-2">(<a href="references.html#ref-infer-2" role="doc-biblioref">Couch et al. 2021</a>)</span>. Because bootstrapping is a random sampling process, the code begins with <code>set.seed()</code> to ensure the results are reproducible. Any integer value can go inside the <code>set.seed</code> function.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-1-1" class="code-annotation-target"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a>niter <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-1-5" class="code-annotation-target"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a>boot_dist <span class="ot">&lt;-</span> parks <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-1-6" class="code-annotation-target"><a href="#annotated-cell-1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(playgrounds <span class="sc">~</span> per_capita_expend) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-1-7" class="code-annotation-target"><a href="#annotated-cell-1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> niter, <span class="at">type =</span> <span class="st">"bootstrap"</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-1-8" class="code-annotation-target"><a href="#annotated-cell-1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="1" data-code-annotation="1">Set a seed to make the results reproducible.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="3" data-code-annotation="2">Define the number of bootstrap samples (iterations). Bootstrapping can be computing intensive when using large data sets and a large number of iterations. We recommend using a small number of iterations ( 10 - 100) when testing code, then increasing the iterations once the code is finalized.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="5" data-code-annotation="3">Specify the data set and save the bootstrap distribution in the object <code>boot_dist</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="6" data-code-annotation="4">Specify the response and predictor variable.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="7" data-code-annotation="5">Specify the type of simulation (“bootstrap”) and the number of iterations.</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="8" data-code-annotation="6">For each bootstrap sample, fit the linear regression model.</span>
</dd>
</dl>
</div>
</div>
<p>We can use <code>ggplot</code> to make a histogram of the bootstrap distribution.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>boot_dist <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"per_capita_expend"</span>) <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate)) <span class="sc">+</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="05-slr-inference_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="05-slr-inference_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Finally, we can compute the lower and upper bounds for the confidence interval using the <code>quantile</code> function. Note that the code includes <code>ungroup()</code> , so that the data are not grouped by <code>replicate</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>boot_dist <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">|&gt;</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"per_capita_expend"</span>) <span class="sc">|&gt;</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">lb =</span> <span class="fu">quantile</span>(estimate, <span class="fl">0.025</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">ub =</span> <span class="fu">quantile</span>(estimate, <span class="fl">0.975</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
        lb      ub
     &lt;dbl&gt;   &lt;dbl&gt;
1 0.000735 0.00711</code></pre>
</div>
</div>
</section>
<section id="sec-slr-permutation-r" class="level3" data-number="5.9.2">
<h3 data-number="5.9.2" class="anchored" data-anchor-id="sec-slr-permutation-r"><span class="header-section-number">5.9.2</span> Permutation tests in R</h3>
<p>The null distribution and p-value for the permutation test are computed using the <strong>infer</strong> package <span class="citation" data-cites="infer-2">(<a href="references.html#ref-infer-2" role="doc-biblioref">Couch et al. 2021</a>)</span>. Much of the code to generate the null distribution is similar to the code for the bootstrap distribution. Because permutation sampling is a random process, the code starts with <code>set.seed()</code> to ensure the results are reproducible.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1" onclick="event.preventDefault();">1</a><span id="annotated-cell-4-1" class="code-annotation-target"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="2" onclick="event.preventDefault();">2</a><span id="annotated-cell-4-3" class="code-annotation-target"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a>niter <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="annotated-cell-4-4"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="3" onclick="event.preventDefault();">3</a><span id="annotated-cell-4-5" class="code-annotation-target"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>null_dist <span class="ot">&lt;-</span> parks <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="4" onclick="event.preventDefault();">4</a><span id="annotated-cell-4-6" class="code-annotation-target"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(playgrounds <span class="sc">~</span> per_capita_expend) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="5" onclick="event.preventDefault();">5</a><span id="annotated-cell-4-7" class="code-annotation-target"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a>   <span class="fu">hypothesize</span>(<span class="at">null =</span> <span class="st">"independence"</span>) <span class="sc">|&gt;</span></span>
<a class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="6" onclick="event.preventDefault();">6</a><span id="annotated-cell-4-8" class="code-annotation-target"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">generate</span>(<span class="at">reps =</span> niter, <span class="at">type =</span> <span class="st">"permute"</span>) <span class="sc">|&gt;</span></span>
<span id="annotated-cell-4-9"><a href="#annotated-cell-4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>()</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-annotation">
<dl class="code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="1" data-code-annotation="1">Set a seed to make the results reproducible.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="3" data-code-annotation="2">Define the number of bootstrap samples (iterations). Permutation sampling can be computing intensive when using large data sets and a large number of iterations. We recommend using a small number of iterations ( 10 - 100) when testing code, then increasing the iterations once the code is finalized.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="5" data-code-annotation="3">Specify the data set and save the null distribution in the object <code>null_dist</code>.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="6" data-code-annotation="4">Specify the response and predictor variable.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="7" data-code-annotation="5">Specify the null hypothesis of “independence”, corresponding to no linear relationship between the response and predictor variables.</span>
</dd>
<dt data-target-cell="annotated-cell-4" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="8,9" data-code-annotation="6">Specify the type of simulation (“permute”) and the number of iterations.</span>
</dd>
</dl>
</div>
</div>
<p>We can use <code>ggplot</code> to make a histogram of the null distribution.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>null_dist <span class="sc">|&gt;</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"per_capita_expend"</span>) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> estimate)) <span class="sc">+</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="05-slr-inference_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="05-slr-inference_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" style="width:100.0%"></a></p>
</figure>
</div>
</div>
</div>
<p>Finally, we compute the the p-value using the <code>get_p_value()</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get estimated slope </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>estimated_slope <span class="ot">&lt;-</span> parks <span class="sc">|&gt;</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">specify</span>(playgrounds <span class="sc">~</span> per_capita_expend)  <span class="sc">|&gt;</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fit</span>()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># compute p-value </span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="fu">get_p_value</span>(null_dist, estimated_slope, <span class="at">direction =</span> <span class="st">"both"</span>) <span class="sc">|&gt;</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term <span class="sc">==</span> <span class="st">"per_capita_expend"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  term              p_value
  &lt;chr&gt;               &lt;dbl&gt;
1 per_capita_expend   0.054</code></pre>
</div>
</div>
<!--# Callout box about gettig pvalue exactly equal to 0. May be confusing here, because we didnt get a pvalue of 0. When using permutation tests, the software may output a p-value of 0, as in this example. Note that the true theoretical p-value is <u>not</u> exactly 0; it is just so small that we did not observe a slope at least as extreme as the slope estimated from the sample data in the r niter permutation samples used to generate the null distribution. We will calculate the exact p-value in @sec-slr-inf-clt-hypothesis-test when we conduct hypothesis testing using theory-based inference methods.-->
</section>
<section id="sec-theory-inf-r" class="level3" data-number="5.9.3">
<h3 data-number="5.9.3" class="anchored" data-anchor-id="sec-theory-inf-r"><span class="header-section-number">5.9.3</span> Theory-based inference in R</h3>
<p>The output from <code>lm()</code> contains the statistics discussed in this section to conduct theory-based inference. The p-value in the output corresponds to the two-sided alternative hypothesis <span class="math inline">\(H_a: \beta_1 \neq 0\)</span>.</p>
<p>The confidence interval does not display by default, but can be added using the <code>conf.int</code> argument in the <code>tidy</code> function. The default confidence level is 95%; it can be adjusted using the <code>conf.level</code> argument in <code>tidy()</code>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>parks_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(playgrounds <span class="sc">~</span> per_capita_expend, <span class="at">data =</span> parks)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tidy</span>(parks_fit, <span class="at">conf.int =</span> <span class="cn">TRUE</span>, <span class="at">conf.level=</span> <span class="fl">0.95</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 7
  term              estimate std.error statistic  p.value conf.low conf.high
  &lt;chr&gt;                &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)        2.42      0.214       11.3  3.11e-19 1.99       2.84   
2 per_capita_expend  0.00330   0.00160      2.06 4.24e- 2 0.000115   0.00648</code></pre>
</div>
</div>
<p>In practice, we use the output from <code>tidy()</code> to get the confidence interval. To compute the confidence interval directly from the formula in <a href="#eq-conf-int-beta" class="quarto-xref">Equation&nbsp;<span>5.11</span></a>, we get <span class="math inline">\(\hat{\beta}_1\)</span> from the <code>estimate</code> column of the <code>tidy()</code> output and <span class="math inline">\(SE_{\hat{\beta}_1}\)</span> from the <code>std.error</code> column. The critical value is computed using the <code>qt</code> function. the first argument is the cumulative probability (the percentile associated with the upper bound of the interval), and the degrees of freedom go in the second argument. For example, the critical value for the 95% confidence interval for the parks data used in <a href="#eq-parks-ci" class="quarto-xref">Equation&nbsp;<span>5.12</span></a> is</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.99</code></pre>
</div>
</div>
</section>
</section>
<section id="summary" class="level2" data-number="5.10">
<h2 data-number="5.10" class="anchored" data-anchor-id="summary"><span class="header-section-number">5.10</span> Summary</h2>
<p>In this chapter we introduced two approaches for conducting statistical inference to draw conclusions about a population slope, simulation-based methods and theory-based methods. The standard error, test statistic, p-value and confidence interval we calculated using the mathematical models from the Central Limit Theorem align with what it seen from the output produced by statistical software in <a href="#tbl-parks-model" class="quarto-xref">Table&nbsp;<span>5.2</span></a>. Modern statistical software will produce these values for you, so in practice you will not typically derive these values “manually” as we did in this chapter. As the data scientist your role will be to interpret the output and use it to draw conclusions. It’s still valuable, however, to have an understanding of where these values come from in order to interpret and apply them accurately. As more software has embedded artificial intelligence features, understanding how the values are computed also helps us check if the software’s output makes sense given the data, analysis objective, and methods.</p>
<p>Which of these two methods is preferred to use in practice? In the next chapter, we will discuss the model assumptions from <a href="#sec-slr-foundation" class="quarto-xref"><span>Section 5.3</span></a> and the conditions we use to evaluate whether the assumptions hold for our data. We will use these conditions in conjunction with other statistical and practical considerations to determine when we might prefer simulation-based methods or theory-based methods for inference.</p>
<!--# Exercises-->
<!--# One about width of CI based on level of confidence-->
<!--# which alpha level requires more evidence-->
<!--# practical vs. statistical significance-->


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-tidytuesday" class="csl-entry" role="listitem">
Community, Data Science Learning. 2024. <span>“Tidy Tuesday: A Weekly Social Data Project.”</span> <a href="https://tidytues.day">https://tidytues.day</a>.
</div>
<div id="ref-infer-2" class="csl-entry" role="listitem">
Couch, Simon P., Andrew P. Bray, Chester Ismay, Evgeni Chasnovski, Benjamin S. Baumer, and Mine Çetinkaya-Rundel. 2021. <span>“<span></span>Infer<span></span>: An <span></span>r<span></span> Package for Tidyverse-Friendly Statistical Inference”</span> 6: 3661. <a href="https://doi.org/10.21105/joss.03661">https://doi.org/10.21105/joss.03661</a>.
</div>
<div id="ref-publicland" class="csl-entry" role="listitem">
The Trust for Public Land. 2021. <span>“Parks and an Equitable Recovery.”</span> Online.
</div>
</div>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Example: I think the relationship is positive. I predict that if the city spends more per resident, some of the funding is used for facilities like playgrounds.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Slope: For each additional dollar a city spends per resident, is expected to be 0.003 more playgrounds per 10,000 residents, on average.<br>
Intercept: We would not expect a city to invest $0 on services and facilities for its residents, so the interpretation of the intercept is not meaningful in practice.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>We sample with replacement so that we get a new sample each time we bootstrap. If we sampled without replacement, we would always end up with a bootstrap sample is exactly the same as the original sample.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Each bootstrap sample is the same size as our current sample data. In this case, the sample data we’re analyzing has 97 observations.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>There are 1000 values, the number of iterations, in the bootstrapped sampling distribution.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>The points at the <span class="math inline">\(5^{th}\)</span> and <span class="math inline">\(95^{th}\)</span> percentiles make the bounds for the 95% confidence interval. The points at the <span class="math inline">\(1^{st}\)</span> and <span class="math inline">\(99^{th}\)</span> percentiles mark the lower and upper bounds for a 98% confidence interval.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>The variability is approximately equal in both distributions. This is expected, because the distributions will have the same variability but different centers.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn8"><p>Given there is no linear relationship between spending per resident and playgrounds per 10,000 residents ( <span class="math inline">\(H_0\)</span> is true), the probability of observing a slope of 0.003 or more extreme in a random sample of 97 cities is 0.046.<a href="#fnref8" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn9"><p>It is possible we have made a Type I error, because we concluded to reject the null hypothesis.<a href="#fnref9" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn10"><p><em>Standard error</em> is the term used for the standard deviation of a sampling distribution.<a href="#fnref10" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn11"><p>Note its similarities to the general equation for sample standard deviation, <span class="math inline">\(s = \sqrt{\frac{\sum_{i=1}^n(y_i - \bar{y})^2}{n-1}}\)</span><a href="#fnref11" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn12"><p>Test statistics with small magnitude provide evidence in support of the null hypothesis, as they are close to the hypothesized value. Conversely test statistics with large magnitude provide evidence against the null hypothesis, as they are very far away from the hypothesized value.<a href="#fnref12" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/introregressio\.netlify\.app");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./04-slr.html" class="pagination-link" aria-label="Simple linear regression">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Simple linear regression</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./06-slr-conditions.html" class="pagination-link" aria-label="Model conditions and diagnostics">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Model conditions and diagnostics</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer"><div class="nav-footer-center"><div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/matackett/regression-book/issues/new" class="toc-action"><i class="bi bi-github"></i>Report an issue</a></li></ul></div></div></div></footer><script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>